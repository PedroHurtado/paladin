{"version":3,"sources":["body.js"],"names":["window","document","IntersectionObserverEntry","prototype","Object","defineProperty","get","intersectionRatio","registry","entry","time","target","rootBounds","boundingClientRect","intersectionRect","getEmptyRect","isIntersecting","targetRect","targetArea","width","height","intersectionArea","IntersectionObserver","callback","opt_options","options","Error","root","nodeType","_checkForIntersections","throttle","bind","THROTTLE_TIMEOUT","_callback","_observationTargets","_queuedEntries","_rootMarginValues","_parseRootMargin","rootMargin","thresholds","_initThresholds","threshold","map","margin","value","unit","join","POLL_INTERVAL","USE_MUTATION_OBSERVER","observe","isTargetAlreadyObserved","some","item","element","_registerInstance","push","_monitorIntersections","unobserve","filter","length","_unmonitorIntersections","_unregisterInstance","disconnect","takeRecords","records","slice","opt_threshold","Array","isArray","sort","t","i","a","isNaN","opt_rootMargin","marginString","margins","split","parts","exec","parseFloat","_monitoringIntersections","_monitoringInterval","setInterval","addEvent","_domObserver","MutationObserver","attributes","childList","characterData","subtree","clearInterval","removeEvent","rootIsInDom","_rootIsInDom","rootRect","_getRootRect","forEach","getBoundingClientRect","rootContainsTarget","_rootContainsTarget","oldEntry","_computeTargetAndRootIntersection","newEntry","now","_hasCrossedThreshold","getComputedStyle","display","parent","getParentNode","atRoot","parentRect","parentComputedStyle","body","documentElement","overflow","computeRectIntersection","html","top","left","right","clientWidth","bottom","clientHeight","_expandRectByRootMargin","rect","newRect","oldRatio","newRatio","containsDeep","indexOf","index","splice","performance","fn","timeout","timer","setTimeout","node","event","opt_useCapture","addEventListener","attachEvent","removeEventListener","detatchEvent","rect1","rect2","Math","max","min","el","err","child","parentNode","host","app","angular","module","config","$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider","ZendeskWidgetProvider","$mdThemingProvider","enums","paladinTheme","extendPalette","rentOrderStatusTheme","definePalette","theme","primaryPalette","accentPalette","init","accountUrl","beforePageLoad","zE","hide","html5Mode","defaults","headers","common","state","url","templateUrl","controller","isPublic","abstract","params","languageCode","localStorage","getItem","localStorageKeys","preferredLanguage","data","isCollapsingHeader","resolve","validReferralCode","$stateParams","appStateManager","referralsService","validateReferralCode","referralNameCode","reloadOnSearch","isCustomSEO","category","squash","subCategory","city","search","sortBy","pageIndex","isTryAndBuy","isResetSearch","productNameAndId","undefined","productId","prereqData","console","log","userId","Borrower_Id","currentLang","getCurrentLang","bookingId","startDate","endDate","purchase","template","chatId","isHeaderHidden","rule","$injector","$location","path","langCode","lang","globals","SUPPORTED_LANGS","find","code","toLowerCase","setItem","location","reload","replace","otherwise","includes","run","ngMeta","$window","$rootScope","facebook","$trace","$transitions","$state","navigationService","dataService","chatService","facebook_user","facebookApiLoaded","$emit","busEvents","facebookApiLoad","isLoaded","fbAsyncInit","FB","appId","channelUrl","status","cookie","xfbml","version","Event","subscribe","res","api","fields","$apply","stateData","isProd","enable","onStart","trans","$on","arguments","onBefore","nextState","to","getUserId","forceLogin","router","stateService","onSuccess","isMenuOpen","currentState","current","name","updateGeneralSEO","factory","facebookService","GetFacebook","_self","user","directive","restrict","link","scope","iElement","iAttrs","languageCodeFacebook","d","js","id","ref","getElementsByTagName","createElement","async","src","getElementById","replaceChild","head","appendChild","insertBefore","XFBML","parse","$route","original","lastRoute","un","apply","glObj","ENV","IS_PROMO","START_DATE","END_DATE","COUPON_VALUE","COUPON_CODE","defaultLocation","tryAndBuyWordPressPath","RENT_NOW_URL","RENT_URL","ROOT_PATH","BASE_URL","PROFILE_IMAGE_URL","PRODUCT_IMAGE_URL","CATEGORY_IMAGE_URL","LOG_LEVEL","STRIPE_SK","API_URL","TOKEN_URL","STRIPE_URL","PROMO_SIGNUP_TIMER","constant","onAppOnlineState","$routeChangeError","userLogin","userSignup","userLogout","preferredLanguageChange","updatedUser","tokenRefresh","triggerEmailValidation","locationUpdate","categoriesUpdate","googlePlacesAutocompletePlaceChanged","reloadDetailedBooking","footerExtraHeight","scrollMainScrollerToTop","rentalRequestPickerUpdateDates","busNavigation","homePage","productDetailed","browseCategory","browseKeyword","browseSort","switchBrowseMode","userProfile","userListings","newProduct","rentals","transactionDetailed","idVerification","userReview","paymentDetailed","chat","busChatEvents","updateUnreadCount","newMessage","detailedChatSelected","startNewMessagesPoller","selectPendingChat","ngMetaValues","currentUrl","categoriesBannersPaths","all","en","it","promo","addProduct","allP2P","jwtToken","refreshToken","locationLatLong","pendingPrivateState","allCategories","secret","inAppSideNavsIds","mainMobileNav","chatSideNav","categoriesIds","tryAndBuy","outdoor","homeAppliance","hiTech","smartMobility","productsSortOptions","geoLocation","popularity","bestProduct","review","lowPrice","highPrice","recent","productsSortByTextCode","SortByPopularity","SortByRecent","SortByGeoLocation","SortByBestProduct","SortByLowPrice","SortByHighPrice","userProductsFilter","borrowedProducts","lentProduct","allProducts","myProductsToBorrow","productRentalStatus","available","requested","notVerified","verified","denied","canceled","accepted","started","ended","criticalCancel","moderateCancel","canceledByLender","timeoutByBorrower","verifying","booked","productRentalStatusNames","cancelled","trackingStep","pending","success","failure","bookingReviewStatus","noReview","reviewByBorrower","reviewByLender","reviewByBoth","idVerificationMethod","passport","driverLicense","acuantImageSource","mobileCropped","scanShellTwain","SnapShell","Other","acuantRegions","USA","Canada","SouthAmerica","Europe","Australia","Asia","GeneralDocs","Africa","input","inputPieces","capitalizeString","trim","toString","inputString","substring","toUpperCase","maxChars","String","service","apiService","$base64","toastService","self","CHAT_HASH","userDialogs","kApplicationID","kAuthKey","kAuthSecret","kAccountKey","onMessage","message","msg","isMe","chatUser","_id","extension","attachments","img","QB","content","privateUrl","uid","onDisconnectedListener","warn","onReconnectListener","debug","mode","chatProtocol","active","onMessageListener","getAppSession","Promise","reject","chatAppSession","createSession","result","token","getUserParams","password","decode","User_Email","User_FacebookId","User_UserName","login","loginToChat","then","session","signupToChat","catch","syncQbUserId","users","create","connectToChat","userToken","connect","err2","pendingChatToJoin","syncDialogList","dialog","list","items","getUnreadMessage","editProfile","User_QBId","User_Id","error","disconnectChat","createOrStartChat","lenderId","borrowerId","lenderQBId","borrowerQBId","productName","chatRoomId","chats","startBookingChat","Data","type","occupants_ids","dialogId","setUserTyping","isTyping","uploadMedia","inputElement","getDialogsList","getChatList","getChatsList","lists","Chat_Borrow","concat","Chat_Lent","thumbnail","Lender_UserId","Borrower_ProfileImage","Lender_ProfileImage","recipient","Borrower_FullName","Lender_FullName","initialBadge","Chat_QBRoomId","lastUpdatedDate","Date","ChatLastUpdated","isLent","b","getChatDetailed","chatQbId","getChatByQBId","getChatHistory","skip","chat_dialog_id","limit","sort_desc","msgs","sender_id","dateSent","date_sent","reverse","joinChat","chatDialog","helpers","getRoomJidFromDialogId","muc","presence","leaveChat","leave","sendMessage","text","files","inputFile","file","size","createAndUpload","fileUID","ProductId","save_to_history","dialogID","isBot","markable","send","notifyUser","isNewChat","notification_type","dialogIds","keys","key","getUnreadMessagesForDialogId","results","count","unreadCount","chat_dialog_ids","getTotalUnreadCount","clearUnreadBadgesForDialog","numberOfUnreadMessages","total","detailedDict","activateChatWhenReady","$mdDialogProvider","addPreset","bindToController","controllerAs","clickOutsideToClose","escapeToClose","panelClass","$mdDialog","$mdDateRangePicker","moment","ptUtils","showAlert","title","okBtn","confirm2","confirmPreset","locals","isConfirm","show","showConfirm","yesButton","noButton","showLoginSignupPopup","isSignUp","loginSignup","selectedTab","showForgotPassword","forgotPassword","showIdVerificationFailureHandler","idVerificationHandler","idVerificationFailureHandler","showEmailVerification","emailVerification","showShareReferralLink","referralLink","shareReferralLink","showDateRangePicker","productBookingDetails","product","dateRanges","getBookedDateRanges","onePanel","autoConfirm","model","localizationMap","getTranslationDictForDatePicker","maxRange","MaxRentalPeriod","isDisabledDate","$date","momentDate","isBetween","isSame","isBefore","showChangePassword","changePass","changePassword","wot","showTransactionStatusChange","booking","apiMethod","statusChange","transactionStatusChange","showInputField","initialValue","inputRegexValidation","validationErrorMessage","inputField","showLoader","loader","hideLoader","showBookingTrackerInfoMobilePopup","bookingTracker","bookingTrackerInfoMobile","$q","$http","ptLog","timeoutCounter","maxTimeouts","raiseTimeout","isAppOnline","loweTimeout","getHttpConfig","headerKey","getDefaultParams","LanguageCode","maxRetries","getRequest","getData","curRetryCounter","deferred","defer","response","Status","apiMethods","waitingBackoffTime_ms","promise","postRequest","post","putRequest","put","categories","getCategories","pages","getHomePageData","Categories","getProductDetailData","Product_Id","products","getSearchedProducts","keyword","isShop","categoryId","subCategoryId","minPriceRange","maxPriceRange","lat","lng","range","page","productPerPage","isWeb","productIDs","KeywordProduct","encodeURIComponent","Category_Id","SubCategory_Id","IsShop","MinPriceRange","MaxPriceRange","Latitude","Longitude","Product_City","Range","IsWeb","PageIndex","getPopularTryAndBuy","getSuggestions","Keyword","getDetailedProduct","obj","getUserProducts","productsFilter","getProductBookingDetails","Product_ItemCategory_Id","Product_Title","Product_Description","Product_Price_Perday","Product_IsShop","Product_ShopURL","Price1Day","Price15Day","Product_TryAndBuy","MinRentalPeriod","Product_Longitude","Product_Latitude","ProductImage_Image1","Product_LenduserId","reviews","submitTransactionReview","signUp","email","username","referralCode","User_Address","User_Password","User_UDIDType","ReferralCode","signupFacebook","facebookName","address","facebookUserId","dataObj","User_DisplayPicturePath","User_DisplayPicture","User_FullName","signUpReferred","User_Mobile","Authorization","encode","newPassword","oldPassword","User_NewPassword","User_OldPassword","getUserProfile","getUserCredit","method","transformRequest","str","p","grant_type","refresh_token","profile","updateNotificaton","emailNotif","chatNotif","Notification_Chat","Notification_Push","Notification_Email","Notification_UserId","deleteAccount","bookings","getUserBookings","getBookingDetailed","BookingId","acceptBookingRequest","Lender_Id","rejectBookingRequest","cancelBookingRequest","reason","Reason","startRental","endRental","bookProduct","stripeEmail","noOfDays","coupon","stripeCustomerId","isSaveCard","idVerified","isPickUp","deliveryLat","deliveryLng","deliveryAddress","deliveryName","deliveryPhone","deliveryBell","Stripe_Email","Borrower_UserId","StartDate","EndDate","NoOfDays","CouponNumber","CustomerAccountId","SaveCard","IdVerfied","Booking_PickupProduct","Delivery_Latitude","Delivery_Longitude","Delivery_Address","Complete_Borrower_Name","Phone_Number","House_Name","payments","createUserStripeAccount","country","Booking_Id","User_Country","verifyCoupon","Coupon","createStripeCustomer","cardToken","Email","TokenId","buyProduct","purchaseAmount","Stripe_Amount","verification","uploadPassport","passportImage","selfie","PassPort","User_Selfie","sendToManualVerification","NICFront","NICDLFront","NICBack","NICDLBack","uploadNICDL","Chat_Id","ChatDone","translationID","uses","$translateProvider","useStaticFilesLoader","prefix","suffix","useMissingTranslationHandler","useSanitizeValueStrategy","Filters","getHeaders","categoriesMap","payload","formatLanguageCode","getCategoryById","getSubcategoryById","j","Category_SubCatrgories","getCategoryByName","IsTryAndBuy","Category_Name","getSubcategoryByName","SubCategory_Name","findByName","keywords","getCategoriesUrl","categoryName","subcategoryName","glCity","Products","getAll","filters","searchProductParam","getTotalPageCount","encryptProductURL","getDetail","decryptProductURL","json","_this","paramStr","k","val","selectedCategoryId","selectedSubCategoryId","minPrice","maxPrice","finalStr","searchStr","sortByCode","maxDistance","endsWith","startReviewFlow","isLender","go","leaveProductReviewPage","toState","history","back","simpleToast","$translate","instant","getBookingToReview","pagerService","GetPager","totalPages","currentPage","pageSize","totalItems","startPage","endPage","startIndex","endIndex","_","appState","hash","categoriesDict","popupService","$timeout","geoLocationService","$interval","TAG","didInit","registerBus","getMe","oAuthToken","setTokens","setUserId","use","refresh","newPath","pathname","clear","geoLocationUpdate","getLocation","updateGeoLocationStorage","JSON","stringify","geoLocationUpdateInterval","finally","getGeoLocationForApp","geometry","latLong","getLatLong","latLngStr","access_token","token_type","messagesPollerInterval","messagesPoller","isStart","getUnreadMessages","cancel","dialogsDict","nummberOfUnreadMessages","catDict","activatePendingPrivateState","transition","nexState","targetState","stateObjToSave","identifier","setPendingPrivateState","setTag","absUrl","encodedState","removeItem","$mdToast","ZendeskWidget","commonMenus","aboutMenu","itemId","accountLoggedOut","shouldHide","BL","accountLoggedIn","linksMenu","activate","menuClickHandlerMethod","menuItem","open","shouldShowMenuItem","dummyNavNotImplementedToast","simple","textContent","hideDelay","geocoder","google","maps","Geocoder","getGeoLocationPostion","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","geoCodeLocation","defaultLoc","getDefaultLocationAddressForLang","locData","geocode","getUserCountryFromUserAddress","address_components","comp","types","getUserAddressFromCoordinates","streetAddress","formatted_address","delay","isRight","getProductNameAndId","subCategoryName","convertInputElementToBas64","convertFile","imgFile","reader","FileReader","onloadend","img64","original64","serverParsed64","readAsDataURL","$sce","stringToDate","dateString","format","dateDelimiter","timeDelimiter","dateTimeSplitter","isHasTime","dateTimeSplits","datePartFormat","dateItems","yearI","monthI","dayI","hourI","minuteI","timeItems","timePartFormat","parseInt","getDisplayDataForTransactionStatus","statusId","color","getPriceForRentalPeriod","rentalPeriodInDays","Price3Day","Price5Day","Price7Day","Price10Day","Product_CategoryId","daysFactor","getPriceForRentalPeriodLegacy","periodFixedPrice","getPriceCalculatedDescriptionForRentalPeriod","days","priceDivisions","division","divisionPrice","priceDescription","div","calculatePricingListForProduct","startRentDate","endRentDate","isDelivery","userCredit","isBuy","getRentalPeriodInDays","prices","DeliveryAndPickupDetail","Delivery_Fee","PickUp_Address","price","description","tooltip","totalPrice","CouponValue","CouponIsPercentage","CouponIsFixed","discount","isCoupon","User_Credit","credit","isCredit","Product_PurchasePrice","Product_Process_Fee","calculatePriceingListForBooking","FullEndDate","FullStartDate","Discount","RentAmount","Fix_Amount_Coupon","AmountCharge","isMoment","diff","getProductFirstAvailableDatesToRent","firstAvailableDates","add","isBookingDateBookedForDateRange","ProductBookingDetail","regexPatterns","numbersOnly","minMaxLength","RegExp","sorters","bookingLastModifiedEpoch","Last_Modified","dataUrlToBlob","dataUrl","binary","atob","array","charCodeAt","Blob","Uint8Array","isMobile","Android","userAgent","match","BlackBerry","iOS","Opera","Windows","any","isCrawler","test","playErrorSound","context","AudioContext","o","createOscillator","g","createGain","destination","start","gain","exponentialRampToValueAtTime","currentTime","isProductTryAndBuy","getProductDetailUrl","getAddressToDisplayForBooking","isProductTryAndBuyBool","Lender_User_Address","PickUp_Latitude","PickUp_Longitude","extractAndGeoLocateAddressFromObjectForFieldNames","object","addressFieldName","latFieldName","lngFieldName","Number","geoLocatedAddress","parseBookingStepTutorialHTMLTemplateForTranslationId","translationId","translatedText","textComponents","HTML_TEXT","trustAsHtml","getTranslationIdForBookingStatus","bookingStatus","gtmService","productReviewService","acceptRental","resolve2","reject2","trackEvent","showInvalidOperationError","rejectRental","e","cancelRental","daysLeftBeforeBookingStarts","User_StripeAccount","isMissingAddress","endRentalForStripeAccountOnly","short_name","JSON_to_URLEncoded","idx","createToken","number","exp_month","exp_year","cvc","card","getCustomer","customerId","getCustomerSources","ACUANT_URL","LISENCE","imageData","dataType","postDuplex","identity","processPassportImage","imageToProcess","imageSource","usePreprocessing","processNICDLDuplexImage","frontImage","backImage","selectedRegion","imgsToProcess","FormData","append","processDriversLicense","processFacialMatch","idFaceImage","facialMatchData","action","label","dataLayer","userName","pop","info","getReferralData","FilterComponent","$scope","translate","rootScope","categoryImageBaseUrl","sce","slider","showCategoriesDiv","priceSliderOption","orientation","step","distanceSliderOption","priceRange","customCategoriesTnB","customCategoriesP2P","$watch","refreshProducts","getCurrentLanguageCode","refreshCategories","selCategoryId","selSubcategoryId","selectCategory","selectSubCategory","selectCategories","refreshProductList","selectedCategoryDesc","Category_Description","selectedCategoryName","selectedCategoryImagePath","Category_ImagePath","selectedCategoryBannerImage","Category_BannerPath","selectedSubCategoryDesc","SubCategory_Description","selectedSubCategoryName","selectedSubCategoryImagePath","SubCategory_ImagePath","selectedSubCategoryBannerImage","SubCategory_BannerPath","subcategory","currentSearchStr","searchKey","$broadcast","component","bindings","menusService","$mdMedia","elem","attr","extraStyle","menuLists","supportedLanguages","selectedLanguage","menuClick","getMenuItemLink","filterMenuItems","onSelectLanguage","setExtraHeight","extraHeight","deregs","mgSm","$cookies","base64","baseUrl","profileImageBaseUrl","mdDialog","http","btnStatus","signupMessage","signupStatus","signupFacebookStatus","signupacebookMessage","loginFacebookStatus","loginFacebookMessage","loginStatus","loginMessage","cookies","userStatus","registerBusEvents","profileDefaultImage","proposedLanguage","changeLanguage","getObject","currentUser","broadcastChange","answer","btnForgotPasswordStatus","forgotpasswordStatus","forgotPasswordMessage","Message","ev","targetEvent","signupFacebookMessage","cookieExp","setDate","getDate","expires_in","putObject","expires","registerFacebook","remove","$mdMenu","$mdSidenav","$mdComponentRegistry","isScrollOffsetZero","searchText","searchItems","unreadBadge","profileMenu","loggedOutMenu","commonMenu","loggedInMenu","alert","loginSignUpPopupClick","querySearch","textQuery","query","Rank","Infinity","headerMenuClick","close","initiateSearch","searchBarOnKeyPress","$event","which","preventDefault","toggleSideNav","isOpen","toggle","updateCreditButton","currentCredit","currentCreditText","creditMenuClick","hideSearch","lastState","newState","scrollTop","$evalAsync","unbind","distanceDropDown","distanceRange","selectedRange","myModelVal","args","changeDistanceFilter","loading","selectedItem","stopPropagation","keyCode","applySearch","distance","suggestion","loadResults","innerWidth","productsList","isLoading","pager","$anchorScroll","productImageBaseUrl","anchorScroll","yOffset","onFilterChange","setTitle","getPageTitle","getMetaTags","placeName","tag","ceil","getDistanceFromLatLonInKm","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","sin","cos","c","atan2","sqrt","deg","PI","pageNumber","refreshPageList","oldAnchor","isParentCategorySelected","scrollToAnchor","updateMetaTags","defaultCategoryName","getCurrentCategory","isNotAllCategory","desc","removeSubCategory","h1","selectedCategoryStr","h2","picSize","userImage","picSizeParsed","sizeStyle","imgServerPath","temp","transclude","loaderSize","stepsList","imgUrl","tutorialTitle","tutorialDescription","attt","customTitle","categoryDescription","descriptionLink","isPopularItems","isRecentItems","productIds","currentProductId","scrollArrows","isRightVisible","isLeftVisible","validateScrollingArrows","fetchProducts","requestParams","User_AllProducts","onSwipe","isLeft","$target","objToScroll","parentElement","minScrollOffset","visibleWidth","maxScrollOffset","scrollWidth","currentOffset","scrollLeft","itemWidth","itemsInPage","newScrollTo","initialTimes","times","offset","lastOffset","scrollTo","onArrowClick","firstItem","querySelector","instantiateScroller","scroller","round","seeAll","getHrefLink","href","buildSourceSet","imagePath","isProfile","sourceSet","lazyLoading","getImagePath","imageType","loadImg","changes","change","srcset","observer","update","profileImage","onItemClick","getProductUrl","onItemSwipe","rating","readOnly","onRating","attrs","onRatingSet","stars","goToProfile","onRequestRent","onDatesUpdated","calculatePrice","isShowErrorOnFaiure","statusError","calculateTransactionPrice","bookingPickerId","onDatesSelected","componentId","onBuyBtnClicked","onRequestRentBtnClicked","$$postDigest","click","resultCallback","defaultValue","dateRange","updateDateRanges","isDateAvailable","advancedModel","selectedTemplate","pickerModel","dateStart","dateEnd","pickerTranslations","selectDate","onDesktopSelect","$dates","isMinified","att","userProducts","fetchUserListings","listItemClick","setDataForStatusId","mainColor","statusLabel","getTutorialHTMLTemplate","getStaticBookingStepsP2P","date","isCurrent","rentalStatus","getStaticBookingStepsTnB","trackId","cases","setStaticStepAtIndexAsCurrent","staticSteps","atIndex","getCurrentStep","steps","updateSteps","statuses","BookingStatus","Status_TrackId","currentStatus","CreatedDate","CreatedTime","copy","youWontBeChargedText","transactionService","btns","getTextAndCTAforTransactionStatus","isEnabled","isDestructive","Booking_ReviewStatus","Lender_StripeAccount","isUserLender","ctaClicked","startChat","Borrower_QBId","Lender_QBId","onCouponValidation","isAddingCoupon","addCoupon","validateCoupon","canLoadMore","isLoadingMore","unreadDict","selectedChatId","loadChatsList","isReplace","onChatListItemClicked","chatItem","loadMore","messages","compose","isUploadingMedia","userImages","me","canLoadMoreMsgs","setSelectedChat","force","getDetailedChat","goToProduct","goToRental","BookingList","loadMoreMessages","isGettingMoreMsgs","toggleNav","keyPress","shiftKey","onUploaded","myImage","recipientImage","elm","raw","offsetHeight","scrollHeight","whenScrolled","clearTimeout","isTitleHidden","isDescriptionHidden","displayedUser","profilePic","isMyProduct","isCanStartChat","titleText","Borrower_Name","Borrower_Image","Borrower_ReviewScore","Borrower_ReviewCount","Lender_User_DisplayPicturePath","User_ReviewAsLender","User_ReviewCountAsLender","deAuthedLoginDiv","style","cursor","onclick","isReloadPage","classList","isAdded","validateAuth","removeChild","disabled","focus","$","containerId","copyTextToClipboard","selection","createTextRange","moveToElementText","select","execCommand","showSimple","getSelection","createRange","selectNode","addRange","closeDialog","registerFacebookStatus","isFacebookApiLoaded","referralData","promoMessage","ambassadorUserName","couponValue","register","loginObj","FbSignup","showTabDialogForgotPassword","popupTitle","isProcessing","isSuccess","retry","retryClb","sendToManualClb","welcome_message_dialog","verifyUser","changePassModel","newPasswordConfirmation","validator","isValid","runApiMethod","isInvalid","loadingText","$mdColors","currentStatusId","popupDescription","setTrackerDescriptionStyle","bookingTrackerWrapperDiv","className","titleSpan","applyThemeColors","ol","listItems","querySelectorAll","verificationMessage","cat","categoryParam","subCategoryParam","initialSortBy","setLocale","initCategories","set","findLatLong","updateHreflangTags","updateHreflang","defaultCategoryDesc","gl","glString","prepareUrl","prepareQuery","metaTag","registerUpdateUrlListener","Map","promoTimeout","hasClass","geocodeNow","saveLocationToScope","place","getCity","long_name","tempCategory","radius","events","elementId","$watchGroup","update_path","require","googleplaceAutocompletePlace","googleplaceAutocomplete","postLink","placeholder","componentRestrictions","autocomplete","places","Autocomplete","addListener","getPlace","$setViewValue","nodeValue","clearInstanceListeners","isPromo","lendTutorial","borrowTutorial","promoFixCoupon1","couponCode","promoFixCoupon2","productTeasers","takingAboutUsImages","getCategoryName","CategoryId","CategoryName","getProductList","TryAndBuyProducts","P2PProducts","ProductList","showToast","NgMap","ratingRounded","product_id","searchedLocation","allCategory","productDetail","userImageBaseUrl","rentNowUrl","productAddress","sample","updateBreadcrumb","Product_SubCategoryId","fetchProductAddress","_scope","productLocation","setProductAddress","loc","refreshProductDetail","updateH1","updateH2","scrollToH1","toFixed","goToAllCategory","goToCategory","goToSubCategory","$$search","rentNow","rentNowDesktop","rentPickersIds","mobile","desktop","isLoggedInUser","fetchDetailedProduct","fetchBookingDetails","getCategory","subCat","requestRentalDates","compToUpdate","onStartEndDateSelected","previous","rejection","mgMd","isMyProfile","isEditing","isUpdating","editableProfile","tempBas64Image","fetchUserProfile","fullName","userFirstName","userLastName","submitProfileEdit","objToSend","uploadImage","canvasResize","quality","isPreprocessing","cardType","maxW","maxH","isiOS","logout","copyReferralLink","containerid","User_Latitude","User_Longitude","User_LocationId","uploadHandler","emptyProductImage","subCategories","userAddress","isUseUserAddress","newProductModel","onUploadClicked","tmpUlpoadedImg","valid","errMsg","onCategorySelected","selectedCategory","Product_LocationId","formValuesInit","tnBCategories","values","addNewItem","isGtMd","vm","submitReview","transactionId","Review_Precnt","Review_ProductId","Review_UserId","ReviewDetail_Comment","Review_BookingId","closeProductReview","mockDummyData","tabs","fetchUserBookings","User_Booking_Borrower","lastModified","User_Booking_Lender","bookingListItemClick","fetchDetailedBooking","fetchProduct","fetchProductBookingDetails","stripeService","creditcards","isHaveSavedCC","isNewCardLayoutOpen","rentStartDate","rentEndDate","userSavedCard","ccModel","expiration","isTermsAndConditionsAccepted","isSaveCardForFutureTransactions","forms","ccIcon","calculatePrices","UserCustomerDetail","User_CustomerId","fetchStripeUserCard","toggleNewCardLayout","gotoTermsAndConditions","win","sourceItem","couponValidated","deleteCoupon","isDeliveryStatusChange","bookingValidator","ccForm","$invalid","$valid","$dirty","productLat","productLng","bookNow","User_IsVerfied","customerData","createNewCardToken","cardData","chargeCard","chargeCardRes","User_VerifyingStatus","tokenRes","funding","tokenId","stripeCustomer","rentalDays","productLocationId","unsavedChanges","returnValue","acuantService","selectedUploadMethod","uploadMethods","uploadData","idVerificationMethodPassportTmpl","imgData","isProcessingImg","idVerificationMethodDriverLicenceTmpl","idVerificationMethodIdTmpl","selectUploadMethod","clickToUpload","setFreshForm","verifyId","imgBlob","acuantPassUploadRes","WebResponseCode","WebResponseDescription","FaceImage","base64FaceImage","goog","crypt","encodeByteArray","faceImgBlob","facialMatchRes","ResponseCodeAuthorization","ResponseMessageAuthorization","uploadVerifiedImageToPaladinServers","acuantDuplexUpload","ResponseCodeAutoDetectState","ResponseCodeAutoDetectStateDesc","ResponseCodeProcState","ResponseCodeProcessStateDesc","finishVerificationManual","passUploadRes","finishVerification","NICDLUploadRes","skipVerification","photoIndex","findIndex","isChatCollapsed","preSelectedchat","isGtSM"],"mappings":"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","file":"body.js","sourcesContent":["/**\n * Copyright 2016 Google Inc. All Rights Reserved.\n *\n * Licensed under the W3C SOFTWARE AND DOCUMENT NOTICE AND LICENSE.\n *\n *  https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document\n *\n */\n\n(function(window, document) {\n'use strict';\n\n\n// Exits early if all IntersectionObserver and IntersectionObserverEntry\n// features are natively supported.\nif ('IntersectionObserver' in window &&\n    'IntersectionObserverEntry' in window &&\n    'intersectionRatio' in window.IntersectionObserverEntry.prototype) {\n\n  // Minimal polyfill for Edge 15's lack of `isIntersecting`\n  // See: https://github.com/w3c/IntersectionObserver/issues/211\n  if (!('isIntersecting' in window.IntersectionObserverEntry.prototype)) {\n    Object.defineProperty(window.IntersectionObserverEntry.prototype,\n      'isIntersecting', {\n      get: function () {\n        return this.intersectionRatio > 0;\n      }\n    });\n  }\n  return;\n}\n\n\n/**\n * An IntersectionObserver registry. This registry exists to hold a strong\n * reference to IntersectionObserver instances currently observering a target\n * element. Without this registry, instances without another reference may be\n * garbage collected.\n */\nvar registry = [];\n\n\n/**\n * Creates the global IntersectionObserverEntry constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-entry\n * @param {Object} entry A dictionary of instance properties.\n * @constructor\n */\nfunction IntersectionObserverEntry(entry) {\n  this.time = entry.time;\n  this.target = entry.target;\n  this.rootBounds = entry.rootBounds;\n  this.boundingClientRect = entry.boundingClientRect;\n  this.intersectionRect = entry.intersectionRect || getEmptyRect();\n  this.isIntersecting = !!entry.intersectionRect;\n\n  // Calculates the intersection ratio.\n  var targetRect = this.boundingClientRect;\n  var targetArea = targetRect.width * targetRect.height;\n  var intersectionRect = this.intersectionRect;\n  var intersectionArea = intersectionRect.width * intersectionRect.height;\n\n  // Sets intersection ratio.\n  if (targetArea) {\n    this.intersectionRatio = intersectionArea / targetArea;\n  } else {\n    // If area is zero and is intersecting, sets to 1, otherwise to 0\n    this.intersectionRatio = this.isIntersecting ? 1 : 0;\n  }\n}\n\n\n/**\n * Creates the global IntersectionObserver constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-interface\n * @param {Function} callback The function to be invoked after intersection\n *     changes have queued. The function is not invoked if the queue has\n *     been emptied by calling the `takeRecords` method.\n * @param {Object=} opt_options Optional configuration options.\n * @constructor\n */\nfunction IntersectionObserver(callback, opt_options) {\n\n  var options = opt_options || {};\n\n  if (typeof callback != 'function') {\n    throw new Error('callback must be a function');\n  }\n\n  if (options.root && options.root.nodeType != 1) {\n    throw new Error('root must be an Element');\n  }\n\n  // Binds and throttles `this._checkForIntersections`.\n  this._checkForIntersections = throttle(\n      this._checkForIntersections.bind(this), this.THROTTLE_TIMEOUT);\n\n  // Private properties.\n  this._callback = callback;\n  this._observationTargets = [];\n  this._queuedEntries = [];\n  this._rootMarginValues = this._parseRootMargin(options.rootMargin);\n\n  // Public properties.\n  this.thresholds = this._initThresholds(options.threshold);\n  this.root = options.root || null;\n  this.rootMargin = this._rootMarginValues.map(function(margin) {\n    return margin.value + margin.unit;\n  }).join(' ');\n}\n\n\n/**\n * The minimum interval within which the document will be checked for\n * intersection changes.\n */\nIntersectionObserver.prototype.THROTTLE_TIMEOUT = 100;\n\n\n/**\n * The frequency in which the polyfill polls for intersection changes.\n * this can be updated on a per instance basis and must be set prior to\n * calling `observe` on the first target.\n */\nIntersectionObserver.prototype.POLL_INTERVAL = null;\n\n/**\n * Use a mutation observer on the root element\n * to detect intersection changes.\n */\nIntersectionObserver.prototype.USE_MUTATION_OBSERVER = true;\n\n\n/**\n * Starts observing a target element for intersection changes based on\n * the thresholds values.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.observe = function(target) {\n  var isTargetAlreadyObserved = this._observationTargets.some(function(item) {\n    return item.element == target;\n  });\n\n  if (isTargetAlreadyObserved) {\n    return;\n  }\n\n  if (!(target && target.nodeType == 1)) {\n    throw new Error('target must be an Element');\n  }\n\n  this._registerInstance();\n  this._observationTargets.push({element: target, entry: null});\n  this._monitorIntersections();\n  this._checkForIntersections();\n};\n\n\n/**\n * Stops observing a target element for intersection changes.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.unobserve = function(target) {\n  this._observationTargets =\n      this._observationTargets.filter(function(item) {\n\n    return item.element != target;\n  });\n  if (!this._observationTargets.length) {\n    this._unmonitorIntersections();\n    this._unregisterInstance();\n  }\n};\n\n\n/**\n * Stops observing all target elements for intersection changes.\n */\nIntersectionObserver.prototype.disconnect = function() {\n  this._observationTargets = [];\n  this._unmonitorIntersections();\n  this._unregisterInstance();\n};\n\n\n/**\n * Returns any queue entries that have not yet been reported to the\n * callback and clears the queue. This can be used in conjunction with the\n * callback to obtain the absolute most up-to-date intersection information.\n * @return {Array} The currently queued entries.\n */\nIntersectionObserver.prototype.takeRecords = function() {\n  var records = this._queuedEntries.slice();\n  this._queuedEntries = [];\n  return records;\n};\n\n\n/**\n * Accepts the threshold value from the user configuration object and\n * returns a sorted array of unique threshold values. If a value is not\n * between 0 and 1 and error is thrown.\n * @private\n * @param {Array|number=} opt_threshold An optional threshold value or\n *     a list of threshold values, defaulting to [0].\n * @return {Array} A sorted list of unique and valid threshold values.\n */\nIntersectionObserver.prototype._initThresholds = function(opt_threshold) {\n  var threshold = opt_threshold || [0];\n  if (!Array.isArray(threshold)) threshold = [threshold];\n\n  return threshold.sort().filter(function(t, i, a) {\n    if (typeof t != 'number' || isNaN(t) || t < 0 || t > 1) {\n      throw new Error('threshold must be a number between 0 and 1 inclusively');\n    }\n    return t !== a[i - 1];\n  });\n};\n\n\n/**\n * Accepts the rootMargin value from the user configuration object\n * and returns an array of the four margin values as an object containing\n * the value and unit properties. If any of the values are not properly\n * formatted or use a unit other than px or %, and error is thrown.\n * @private\n * @param {string=} opt_rootMargin An optional rootMargin value,\n *     defaulting to '0px'.\n * @return {Array<Object>} An array of margin objects with the keys\n *     value and unit.\n */\nIntersectionObserver.prototype._parseRootMargin = function(opt_rootMargin) {\n  var marginString = opt_rootMargin || '0px';\n  var margins = marginString.split(/\\s+/).map(function(margin) {\n    var parts = /^(-?\\d*\\.?\\d+)(px|%)$/.exec(margin);\n    if (!parts) {\n      throw new Error('rootMargin must be specified in pixels or percent');\n    }\n    return {value: parseFloat(parts[1]), unit: parts[2]};\n  });\n\n  // Handles shorthand.\n  margins[1] = margins[1] || margins[0];\n  margins[2] = margins[2] || margins[0];\n  margins[3] = margins[3] || margins[1];\n\n  return margins;\n};\n\n\n/**\n * Starts polling for intersection changes if the polling is not already\n * happening, and if the page's visibilty state is visible.\n * @private\n */\nIntersectionObserver.prototype._monitorIntersections = function() {\n  if (!this._monitoringIntersections) {\n    this._monitoringIntersections = true;\n\n    // If a poll interval is set, use polling instead of listening to\n    // resize and scroll events or DOM mutations.\n    if (this.POLL_INTERVAL) {\n      this._monitoringInterval = setInterval(\n          this._checkForIntersections, this.POLL_INTERVAL);\n    }\n    else {\n      addEvent(window, 'resize', this._checkForIntersections, true);\n      addEvent(document, 'scroll', this._checkForIntersections, true);\n\n      if (this.USE_MUTATION_OBSERVER && 'MutationObserver' in window) {\n        this._domObserver = new MutationObserver(this._checkForIntersections);\n        this._domObserver.observe(document, {\n          attributes: true,\n          childList: true,\n          characterData: true,\n          subtree: true\n        });\n      }\n    }\n  }\n};\n\n\n/**\n * Stops polling for intersection changes.\n * @private\n */\nIntersectionObserver.prototype._unmonitorIntersections = function() {\n  if (this._monitoringIntersections) {\n    this._monitoringIntersections = false;\n\n    clearInterval(this._monitoringInterval);\n    this._monitoringInterval = null;\n\n    removeEvent(window, 'resize', this._checkForIntersections, true);\n    removeEvent(document, 'scroll', this._checkForIntersections, true);\n\n    if (this._domObserver) {\n      this._domObserver.disconnect();\n      this._domObserver = null;\n    }\n  }\n};\n\n\n/**\n * Scans each observation target for intersection changes and adds them\n * to the internal entries queue. If new entries are found, it\n * schedules the callback to be invoked.\n * @private\n */\nIntersectionObserver.prototype._checkForIntersections = function() {\n  var rootIsInDom = this._rootIsInDom();\n  var rootRect = rootIsInDom ? this._getRootRect() : getEmptyRect();\n\n  this._observationTargets.forEach(function(item) {\n    var target = item.element;\n    var targetRect = getBoundingClientRect(target);\n    var rootContainsTarget = this._rootContainsTarget(target);\n    var oldEntry = item.entry;\n    var intersectionRect = rootIsInDom && rootContainsTarget &&\n        this._computeTargetAndRootIntersection(target, rootRect);\n\n    var newEntry = item.entry = new IntersectionObserverEntry({\n      time: now(),\n      target: target,\n      boundingClientRect: targetRect,\n      rootBounds: rootRect,\n      intersectionRect: intersectionRect\n    });\n\n    if (!oldEntry) {\n      this._queuedEntries.push(newEntry);\n    } else if (rootIsInDom && rootContainsTarget) {\n      // If the new entry intersection ratio has crossed any of the\n      // thresholds, add a new entry.\n      if (this._hasCrossedThreshold(oldEntry, newEntry)) {\n        this._queuedEntries.push(newEntry);\n      }\n    } else {\n      // If the root is not in the DOM or target is not contained within\n      // root but the previous entry for this target had an intersection,\n      // add a new record indicating removal.\n      if (oldEntry && oldEntry.isIntersecting) {\n        this._queuedEntries.push(newEntry);\n      }\n    }\n  }, this);\n\n  if (this._queuedEntries.length) {\n    this._callback(this.takeRecords(), this);\n  }\n};\n\n\n/**\n * Accepts a target and root rect computes the intersection between then\n * following the algorithm in the spec.\n * TODO(philipwalton): at this time clip-path is not considered.\n * https://w3c.github.io/IntersectionObserver/#calculate-intersection-rect-algo\n * @param {Element} target The target DOM element\n * @param {Object} rootRect The bounding rect of the root after being\n *     expanded by the rootMargin value.\n * @return {?Object} The final intersection rect object or undefined if no\n *     intersection is found.\n * @private\n */\nIntersectionObserver.prototype._computeTargetAndRootIntersection =\n    function(target, rootRect) {\n\n  // If the element isn't displayed, an intersection can't happen.\n  if (window.getComputedStyle(target).display == 'none') return;\n\n  var targetRect = getBoundingClientRect(target);\n  var intersectionRect = targetRect;\n  var parent = getParentNode(target);\n  var atRoot = false;\n\n  while (!atRoot) {\n    var parentRect = null;\n    var parentComputedStyle = parent.nodeType == 1 ?\n        window.getComputedStyle(parent) : {};\n\n    // If the parent isn't displayed, an intersection can't happen.\n    if (parentComputedStyle.display == 'none') return;\n\n    if (parent == this.root || parent == document) {\n      atRoot = true;\n      parentRect = rootRect;\n    } else {\n      // If the element has a non-visible overflow, and it's not the <body>\n      // or <html> element, update the intersection rect.\n      // Note: <body> and <html> cannot be clipped to a rect that's not also\n      // the document rect, so no need to compute a new intersection.\n      if (parent != document.body &&\n          parent != document.documentElement &&\n          parentComputedStyle.overflow != 'visible') {\n        parentRect = getBoundingClientRect(parent);\n      }\n    }\n\n    // If either of the above conditionals set a new parentRect,\n    // calculate new intersection data.\n    if (parentRect) {\n      intersectionRect = computeRectIntersection(parentRect, intersectionRect);\n\n      if (!intersectionRect) break;\n    }\n    parent = getParentNode(parent);\n  }\n  return intersectionRect;\n};\n\n\n/**\n * Returns the root rect after being expanded by the rootMargin value.\n * @return {Object} The expanded root rect.\n * @private\n */\nIntersectionObserver.prototype._getRootRect = function() {\n  var rootRect;\n  if (this.root) {\n    rootRect = getBoundingClientRect(this.root);\n  } else {\n    // Use <html>/<body> instead of window since scroll bars affect size.\n    var html = document.documentElement;\n    var body = document.body;\n    rootRect = {\n      top: 0,\n      left: 0,\n      right: html.clientWidth || body.clientWidth,\n      width: html.clientWidth || body.clientWidth,\n      bottom: html.clientHeight || body.clientHeight,\n      height: html.clientHeight || body.clientHeight\n    };\n  }\n  return this._expandRectByRootMargin(rootRect);\n};\n\n\n/**\n * Accepts a rect and expands it by the rootMargin value.\n * @param {Object} rect The rect object to expand.\n * @return {Object} The expanded rect.\n * @private\n */\nIntersectionObserver.prototype._expandRectByRootMargin = function(rect) {\n  var margins = this._rootMarginValues.map(function(margin, i) {\n    return margin.unit == 'px' ? margin.value :\n        margin.value * (i % 2 ? rect.width : rect.height) / 100;\n  });\n  var newRect = {\n    top: rect.top - margins[0],\n    right: rect.right + margins[1],\n    bottom: rect.bottom + margins[2],\n    left: rect.left - margins[3]\n  };\n  newRect.width = newRect.right - newRect.left;\n  newRect.height = newRect.bottom - newRect.top;\n\n  return newRect;\n};\n\n\n/**\n * Accepts an old and new entry and returns true if at least one of the\n * threshold values has been crossed.\n * @param {?IntersectionObserverEntry} oldEntry The previous entry for a\n *    particular target element or null if no previous entry exists.\n * @param {IntersectionObserverEntry} newEntry The current entry for a\n *    particular target element.\n * @return {boolean} Returns true if a any threshold has been crossed.\n * @private\n */\nIntersectionObserver.prototype._hasCrossedThreshold =\n    function(oldEntry, newEntry) {\n\n  // To make comparing easier, an entry that has a ratio of 0\n  // but does not actually intersect is given a value of -1\n  var oldRatio = oldEntry && oldEntry.isIntersecting ?\n      oldEntry.intersectionRatio || 0 : -1;\n  var newRatio = newEntry.isIntersecting ?\n      newEntry.intersectionRatio || 0 : -1;\n\n  // Ignore unchanged ratios\n  if (oldRatio === newRatio) return;\n\n  for (var i = 0; i < this.thresholds.length; i++) {\n    var threshold = this.thresholds[i];\n\n    // Return true if an entry matches a threshold or if the new ratio\n    // and the old ratio are on the opposite sides of a threshold.\n    if (threshold == oldRatio || threshold == newRatio ||\n        threshold < oldRatio !== threshold < newRatio) {\n      return true;\n    }\n  }\n};\n\n\n/**\n * Returns whether or not the root element is an element and is in the DOM.\n * @return {boolean} True if the root element is an element and is in the DOM.\n * @private\n */\nIntersectionObserver.prototype._rootIsInDom = function() {\n  return !this.root || containsDeep(document, this.root);\n};\n\n\n/**\n * Returns whether or not the target element is a child of root.\n * @param {Element} target The target element to check.\n * @return {boolean} True if the target element is a child of root.\n * @private\n */\nIntersectionObserver.prototype._rootContainsTarget = function(target) {\n  return containsDeep(this.root || document, target);\n};\n\n\n/**\n * Adds the instance to the global IntersectionObserver registry if it isn't\n * already present.\n * @private\n */\nIntersectionObserver.prototype._registerInstance = function() {\n  if (registry.indexOf(this) < 0) {\n    registry.push(this);\n  }\n};\n\n\n/**\n * Removes the instance from the global IntersectionObserver registry.\n * @private\n */\nIntersectionObserver.prototype._unregisterInstance = function() {\n  var index = registry.indexOf(this);\n  if (index != -1) registry.splice(index, 1);\n};\n\n\n/**\n * Returns the result of the performance.now() method or null in browsers\n * that don't support the API.\n * @return {number} The elapsed time since the page was requested.\n */\nfunction now() {\n  return window.performance && performance.now && performance.now();\n}\n\n\n/**\n * Throttles a function and delays its executiong, so it's only called at most\n * once within a given time period.\n * @param {Function} fn The function to throttle.\n * @param {number} timeout The amount of time that must pass before the\n *     function can be called again.\n * @return {Function} The throttled function.\n */\nfunction throttle(fn, timeout) {\n  var timer = null;\n  return function () {\n    if (!timer) {\n      timer = setTimeout(function() {\n        fn();\n        timer = null;\n      }, timeout);\n    }\n  };\n}\n\n\n/**\n * Adds an event handler to a DOM node ensuring cross-browser compatibility.\n * @param {Node} node The DOM node to add the event handler to.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to add.\n * @param {boolean} opt_useCapture Optionally adds the even to the capture\n *     phase. Note: this only works in modern browsers.\n */\nfunction addEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.addEventListener == 'function') {\n    node.addEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.attachEvent == 'function') {\n    node.attachEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Removes a previously added event handler from a DOM node.\n * @param {Node} node The DOM node to remove the event handler from.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to remove.\n * @param {boolean} opt_useCapture If the event handler was added with this\n *     flag set to true, it should be set to true here in order to remove it.\n */\nfunction removeEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.removeEventListener == 'function') {\n    node.removeEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.detatchEvent == 'function') {\n    node.detatchEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Returns the intersection between two rect objects.\n * @param {Object} rect1 The first rect.\n * @param {Object} rect2 The second rect.\n * @return {?Object} The intersection rect or undefined if no intersection\n *     is found.\n */\nfunction computeRectIntersection(rect1, rect2) {\n  var top = Math.max(rect1.top, rect2.top);\n  var bottom = Math.min(rect1.bottom, rect2.bottom);\n  var left = Math.max(rect1.left, rect2.left);\n  var right = Math.min(rect1.right, rect2.right);\n  var width = right - left;\n  var height = bottom - top;\n\n  return (width >= 0 && height >= 0) && {\n    top: top,\n    bottom: bottom,\n    left: left,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\n\n/**\n * Shims the native getBoundingClientRect for compatibility with older IE.\n * @param {Element} el The element whose bounding rect to get.\n * @return {Object} The (possibly shimmed) rect of the element.\n */\nfunction getBoundingClientRect(el) {\n  var rect;\n\n  try {\n    rect = el.getBoundingClientRect();\n  } catch (err) {\n    // Ignore Windows 7 IE11 \"Unspecified error\"\n    // https://github.com/w3c/IntersectionObserver/pull/205\n  }\n\n  if (!rect) return getEmptyRect();\n\n  // Older IE\n  if (!(rect.width && rect.height)) {\n    rect = {\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      left: rect.left,\n      width: rect.right - rect.left,\n      height: rect.bottom - rect.top\n    };\n  }\n  return rect;\n}\n\n\n/**\n * Returns an empty rect object. An empty rect is returned when an element\n * is not in the DOM.\n * @return {Object} The empty rect.\n */\nfunction getEmptyRect() {\n  return {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    width: 0,\n    height: 0\n  };\n}\n\n/**\n * Checks to see if a parent element contains a child elemnt (including inside\n * shadow DOM).\n * @param {Node} parent The parent element.\n * @param {Node} child The child element.\n * @return {boolean} True if the parent node contains the child node.\n */\nfunction containsDeep(parent, child) {\n  var node = child;\n  while (node) {\n    if (node == parent) return true;\n\n    node = getParentNode(node);\n  }\n  return false;\n}\n\n\n/**\n * Gets the parent node of an element or its host element if the parent node\n * is a shadow root.\n * @param {Node} node The node whose parent to get.\n * @return {Node|null} The parent node or null if no parent exists.\n */\nfunction getParentNode(node) {\n  var parent = node.parentNode;\n\n  if (parent && parent.nodeType == 11 && parent.host) {\n    // If the parent is a shadow root, return the host element.\n    return parent.host;\n  }\n  return parent;\n}\n\n\n// Exposes the constructors globally.\nwindow.IntersectionObserver = IntersectionObserver;\nwindow.IntersectionObserverEntry = IntersectionObserverEntry;\n\n}(window, document));\n\nconst app = angular.module('paladinApp', [\n    'ui.router',\n    'ngMeta',\n    'zendeskWidget',\n    'pascalprecht.translate',\n    'paladinPopups',\n    'angularReverseGeocode',\n    'ngLocationUpdate',\n    'ngMaterial',\n    'ngMessages',\n    'material.svgAssetsCache',\n    'ngCookies',\n    'uiGmapgoogle-maps',\n    'ngMap',\n    'base64',\n    'ngRoute',\n    'angularMoment',\n    'ngMaterialDateRangePicker',\n    'credit-cards',\n    'jkAngularRatingStars'\n]);\napp\n    .config([\n        '$stateProvider',\n        '$urlRouterProvider',\n        '$httpProvider',\n        '$locationProvider',\n        'ZendeskWidgetProvider',\n        '$mdThemingProvider',\n        'enums',\n        function (\n            $stateProvider,\n            $urlRouterProvider,\n            $httpProvider,\n            $locationProvider,\n            ZendeskWidgetProvider,\n            $mdThemingProvider,\n            enums\n        ) {\n\n            const paladinTheme = $mdThemingProvider.extendPalette('green', {\n                '500': '#69C187',\n                '200': '#01b3eb',\n                'A200': 'rgba(255,255,255,0.05)',\n                'A300': '#484848',\n                'A400': 'rgba(72,72,72,0.5)',\n                'A500': '#ffffff',\n                'A600': '#f6f6f6',\n                'A700': '#000'\n            });\n            const rentOrderStatusTheme = $mdThemingProvider.definePalette('rentOrderStatusTheme', {\n                '50': '#69C187', //available,\n                '100': '#fb814a', // requested\n                '200': '#ee4e4a', // timeout / canceled (pre accept) / canceled by lender / canceled by borrower / declined\n                '300': '#4ec07e', // accepted\n                '400': '#0d87f6', // started\n                '500': '#8d72f4', // ended\n                '600': '#fff', // not in use (must have for palette definition)\n                '700': '#fff', // not in use (must have for palette definition)\n                '800': '#fff', // not in use (must have for palette definition)\n                '900': '#fff', // not in use (must have for palette definition)\n                'A100': '#fff', // not in use (must have for palette definition)\n                'A200': '#fff', // not in use (must have for palette definition)\n                'A400': '#fff', // not in use (must have for palette definition)\n                'A700': '#000000', // not in use (must have for palette definition)\n            });\n            $mdThemingProvider.definePalette('paladinTheme', paladinTheme);\n\n            $mdThemingProvider.theme('default')\n                .primaryPalette('paladinTheme')\n                .accentPalette('paladinTheme');\n\n            $mdThemingProvider.theme('rentOrderStatus')\n                .primaryPalette('rentOrderStatusTheme')\n                .accentPalette('rentOrderStatusTheme');\n\n            ZendeskWidgetProvider.init({\n                accountUrl: 'paladintrue.zendesk.com',\n                beforePageLoad: function (zE) {\n                    zE.hide();\n                }\n                // See below for more settings\n            });\n            //in URL patterns this ocde will disable # and ! before path name\n            $locationProvider.html5Mode(true);\n            /*\n            $locationProvider.html5Mode({\n              enabled: true,\n              requireBase: false\n            });\n            */\n            delete $httpProvider.defaults.headers.common['X-Requested-With'];\n\n\n            $stateProvider\n                .state('app', {\n                    url: '/:languageCode',\n                    templateUrl: './views/routes/app.html',\n                    controller: 'appController',\n                    isPublic: true,\n                    abstract: true,\n                    params: {\n                        languageCode: localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it',\n                    }\n                })\n                .state('app.home', {\n                    url: '/',\n                    templateUrl: './views/routes/homeV2.html',\n                    controller: 'homeV2Controller',\n                    isPublic: true,\n                    data: {\n                        isCollapsingHeader: true,\n                    },\n                    resolve: {\n                        validReferralCode: () => {\n                            return false;\n                        }\n                    }\n                })\n                .state('app.emailVerification', {\n                    url: '/email-validation',\n                    templateUrl: './views/routes/homeV2.html',\n                    controller: 'homeV2Controller',\n                    isPublic: true,\n                    data: {\n                        isCollapsingHeader: true,\n                    }\n                })\n                .state('app.referredRegistration', {\n                    url: '/r/:referralNameCode',\n                    templateUrl: './views/routes/homeV2.html',\n                    controller: 'homeV2Controller',\n                    isPublic: true,\n                    resolve: {\n                        validReferralCode: [\n                            '$stateParams',\n                            'appStateManager',\n                            'referralsService',\n                            function ($stateParams, appStateManager, referralsService) {\n                                // console.log('###### ', $stateParams.referralNameCode, ' .. ', appStateManager, ' .. ' , referralsService)\n                                return referralsService.validateReferralCode($stateParams.referralNameCode);\n                            }]\n                    }\n                })\n                .state('app.browse', {\n                    url: '/categorie/:category/:subCategory/:city?search&sortBy&pageIndex',\n                    templateUrl:'./views/routes/home.html',\n                    controller:'homeController',\n                    reloadOnSearch: false,\n                    isPublic: true,\n                    isCustomSEO: true,\n                    params: {\n                        category: { squash: true, value: null },\n                        subCategory: { squash: true, value: null },\n                        city: { squash: true, value: null },\n                        search: { squash: true, value: null },\n                        sortBy: { squash: true, value: null },\n                        pageIndex: { squash: true, value: null },\n                        isTryAndBuy: true,\n                        isResetSearch: false,\n                    }\n                })\n                .state('app.browsePrivate', {\n                    url: '/categorie/privato/:category/:subCategory/:city?search&sortBy&pageIndex',\n                    templateUrl:'./views/routes/home.html',\n                    controller:'homeController',\n                    reloadOnSearch: false,\n                    isPublic: true,\n                    isCustomSEO: true,\n                    params: {\n                        category: { squash: true, value: null },\n                        subCategory: { squash: true, value: null },\n                        city: { squash: true, value: null },\n                        search: { squash: true, value: null },\n                        sortBy: { squash: true, value: null },\n                        pageIndex: { squash: true, value: null },\n                        isTryAndBuy: false,\n                        isResetSearch: false,\n                    }\n                })\n                .state('app.products', {\n                    url: '/product',\n                    abstract: true,\n                })\n                // .state('app.blog', {\n                //     url: '/blog',\n                // })\n                .state('app.products.selectedProduct', {\n                    url: '/:productNameAndId',\n                    templateUrl: './views/routes/productDetailed.html',\n                    controller: 'productDetailedController',\n                    isPublic: true,\n                    params: {\n                        productNameAndId: undefined,\n                        productId: 0\n                    }\n                })\n                .state('app.products.newProduct', {\n                    url: '/new',\n                    templateUrl: './views/routes/newProduct.html',\n                    controller: 'newProductController'\n                })\n                .state('app.products.productReview', {\n                    url: '/review/:bookingId',\n                    templateUrl: './views/routes/productReview.html',\n                    controller: 'productReviewController',\n                    isPublic: true,\n                    resolve: {\n                        prereqData: [\n                            '$stateParams',\n                            'appStateManager',\n                            function($stateParams, appStateManager){\n                                // collect and validate transaction details\n                                console.log('$state productReview params', $stateParams)\n\n                                return {\n                                    userId: $stateParams.Borrower_Id,\n                                    productId: null,\n                                    currentLang: appStateManager.getCurrentLang(),\n                                }\n                            }\n                        ]\n                    }\n                })\n\n                // .state('app.products.selectedProduct', {\n                //         url: '/:productId',\n                //         templateUrl:'./views/routes/productPreview.html',\n                //         controller:'PreviewController'\n                //     });\n                .state('app.profiles', {\n                    url: '/profiles',\n                    abstract: true,\n                })\n                .state('app.profiles.myProfile', {\n                    url: '/myProfile',\n                    templateUrl: './views/routes/userProfile.html',\n                    controller: 'userProfileController',\n                    params: {\n                        userId: null,\n                    }\n                })\n                .state('app.profiles.publicProfile', {\n                    url: '/:userId',\n                    templateUrl: './views/routes/userProfile.html',\n                    controller: 'userProfileController',\n                    isPublic: true,\n                    params: {\n                        userId: null,\n                    }\n                })\n                .state('app.myListings', {\n                    url: '/myListings',\n                    templateUrl: './views/routes/myListings.html',\n                    controller: 'myListingsController',\n                    isPublic: true,\n                })\n                .state('app.bookings', {\n                    url: '/my-rentals',\n                    abstract: true,\n                })\n                .state('app.bookings.userBookings', {\n                    url: '',\n                    templateUrl: './views/routes/userBookings.html',\n                    controller: 'userBookingsController',\n                })\n                .state('app.bookings.bookingDetailed', {\n                    url: '/:bookingId',\n                    templateUrl: './views/routes/bookingDetailed.html',\n                    controller: 'bookingDetailedController',\n                    params: {\n                        bookingId: null,\n                    }\n                })\n\n                .state('app.bookings.paymentDetailed', {\n                    url: '/payment',\n                    templateUrl: './views/routes/paymentDetailed.html',\n                    controller: 'paymentDetailedController',\n                    params: {\n                        productId: { squash: true, value: null },\n                        startDate: { squash: true, value: null },\n                        endDate: { squash: true, value: null },\n                        purchase: { squash: true, value: null},\n                        bookingId: { squash: true, value: null },\n                    }\n                })\n                .state('verification', {\n                    url: '/:languageCode/verification',\n                    params: {\n                        languageCode: localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it',\n                    },\n                    template: '<div ui-view flex=\"100\" layout=\"row\" layout-align=\"start center\" layout-fill></div>'\n                })\n                .state('verification.user', {\n                    url: '/verifyMe/:bookingId',\n                    templateUrl: './views/routes/userVerification.html',\n                    controller: 'userVerificationController',\n                    params: {\n                        bookingId: null,\n                    }\n                })\n                .state('app.chat', {\n                    url: '/messaging/:chatId',\n                    params: {\n                        languageCode: localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it',\n                        chatId: null,\n                    },\n                    templateUrl: './views/routes/chat.html',\n                    controller: 'chatController',\n                    data: {\n                        isHeaderHidden: true,\n                    }\n                })\n           ;\n\n            // Force urls with lang code\n            $urlRouterProvider.rule(function ($injector, $location) {\n                //what this function returns will be set as the $location.url\n                let path = $location.path(),\n                    langCode = path.split('/')[1], // 0 is \"\" cuz path begins with /\n                    lang = window.globals.SUPPORTED_LANGS.find((lang) => lang.code === langCode.toLowerCase());\n                if (!lang) {\n                    // Return url appended by lang code\n                    return `/${localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it'}${path}`;\n                } else {\n                    if (lang.code != localStorage.getItem(enums.localStorageKeys.preferredLanguage)) {\n                        // $rootScope.$emit(enums.busEvents.preferredLanguageChange,{currentLang: lang});\n                        // return\n                        localStorage.setItem(enums.localStorageKeys.preferredLanguage, lang.code);\n                        location.reload();\n                        return path.replace(langCode, lang.code)\n                    }\n                }\n            });\n            // Default route case doesn't exit\n            $urlRouterProvider.otherwise(function ($injector, $location) {\n                if ($location.path().includes('/blog'))\n                    return;\n                let path = $location.path(),\n                    langCode = path.split('/')[1], // 0 is \"\" cuz path begins with /\n                    lang = window.globals.SUPPORTED_LANGS.find((lang) => lang.code === langCode.toLowerCase());\n                return `/${localStorage.getItem(enums.localStorageKeys.preferredLanguage) || lang || 'it'}/`\n            });\n\n        }])\n    .run([\n        'ngMeta',\n        '$window',\n        '$rootScope',\n        '$location',\n        'facebook',\n        'enums',\n        '$trace',\n        '$transitions',\n        '$state',\n        'navigationService',\n        'dataService',\n        'chatService',\n        'appStateManager',\n        function (ngMeta,\n                  $window,\n                  $rootScope,\n                  $location,\n                  facebook,\n                  enums,\n                  $trace,\n                  $transitions,\n                  $state,\n                  navigationService,\n                  dataService,\n                  chatService,\n                  appStateManager) {\n            ngMeta.init();\n            dataService.init();\n            chatService.init();\n\n            $rootScope.facebook_user = {};\n            $rootScope.facebookApiLoaded = false;\n            $rootScope.$emit(enums.busEvents.facebookApiLoad, {isLoaded: false});\n            $window.fbAsyncInit = function () {\n                FB.init({\n                    appId: '1156274361103964',\n                    channelUrl: 'app/channel.html',\n                    status: true,\n                    cookie: true,\n                    xfbml: true,\n                    version: 'v2.12'\n                });\n\n                FB.Event.subscribe('auth.authResponseChange', function (res) {\n                    if (res.status === 'connected') {\n                        FB.api('/me', {\n                            fields: ['first_name', 'last_name', 'email', 'id', 'address', 'location', 'name']\n                        }, function (res) {\n                            $rootScope.$emit(enums.busEvents.facebookApiLoad, {isLoaded: true});\n                            $rootScope.$apply(function () {\n                                $rootScope.facebook_user = res;\n                                $rootScope.facebookApiLoaded = true;\n\n                            });\n                        });\n                    }\n                });\n            };\n\n            $rootScope.stateData = {\n                isCollapsingHeader: true,\n                isHeaderHidden: false,\n            };\n\n            if (!window.globals.isProd()) {\n                $trace.enable('TRANSITION');\n                $transitions.onStart({}, function (trans) {\n                    console.log('$transitions.onStart', trans);\n                });\n                $rootScope.$on('$stateChangeStart', function () {\n                    console.log('$stateChangeStart', arguments)\n                });\n            }\n\n            // Redirect for non public routes\n            $transitions.onBefore({}, function (trans) {\n                const nextState = trans.to();\n                if (!nextState.isPublic && !appStateManager.getUserId()) {\n                    dataService.forceLogin(trans);\n                    return trans.router.stateService.target('app.home')\n                }\n            });\n\n            $transitions.onSuccess({}, function (trans) {\n                const nextState = trans.to();\n                $rootScope.isMenuOpen = {value: false};\n                $rootScope.currentState = {value: $state.current.name};\n\n                if ($state.current.data) {\n                    $rootScope.stateData.isCollapsingHeader = $state.current.data.isCollapsingHeader || false;\n                    $rootScope.stateData.isHeaderHidden = $state.current.data.isHeaderHidden || false;\n                }\n\n                // Update update SEO if controller doesn't override it\n                if (!nextState.isCustomSEO)\n                    dataService.updateGeneralSEO();\n            });\n\n        }]);\n\nangular.module('paladinApp').factory('facebook', function () {\n    var facebookService = {};\n\n    facebookService.GetFacebook = function () {\n        var _self = this;\n\n        FB.Event.subscribe('auth.statuschange', function (res) {\n            if (res.status === 'connected') {\n                FB.api('/me', function (res) {\n                    $rootScope.$apply(function () {\n                        $rootScope.user = _self.user = res;\n                        console.log(res);\n                    });\n                });\n            }\n        });\n        return 'success';\n    };\n    return 'done';\n});\n\nangular.module('paladinApp').directive(\"fbButton\", function () {\n    return {\n        restrict: 'A',\n        link: function (scope, iElement, iAttrs) {\n\n            var languageCodeFacebook = 'en_EN';\n            if (scope.currentLang == 'it') {\n                languageCodeFacebook = 'it_IT';\n            } else if (scope.currentLang == 'de') {\n                languageCodeFacebook = 'de_DE';\n            }\n            (function (d) {\n                var js,\n                    id = 'facebook-jssdk',\n                    ref = d.getElementsByTagName('script')[0];\n\n                js = d.createElement('script');\n                js.id = id;\n                js.async = true;\n                js.src = \"//connect.facebook.net/\" + languageCodeFacebook + \"/sdk.js\";\n\n                if (d.getElementById(id)) {\n                    ref.parentNode.replaceChild(js, d.getElementById(id));\n                    var head = document.getElementsByTagName('head')[0];\n                    head.appendChild(js);\n                    //  ref.parentNode.insertBefore(js, ref);\n                } else {\n                    ref.parentNode.insertBefore(js, ref);\n\n                }\n                if (typeof FB != \"undefined\") {\n                    if (FB) {\n                        FB.XFBML.parse(iElement[0].parent);\n                    }\n                }\n            }(document));\n        }\n    }\n});\n\nangular.module('paladinApp').run(['$route', '$rootScope', '$location', function ($route, $rootScope, $location) {\n    var original = $location.path;\n    $location.path = function (path, reload) {\n        if (reload === false) {\n            var lastRoute = $route.current;\n            var un = $rootScope.$on('$locationChangeSuccess', function () {\n                $route.current = lastRoute;\n                un();\n            });\n        }\n        return original.apply($location, [path]);\n    };\n}]);\n\n\n\n(function (window) {\n    let glObj = {};\n\n    //glObj.ENV = 'prod';\n    glObj.ENV = 'test';\n    //promotion\n    glObj.IS_PROMO = true;\n    glObj.START_DATE = \"7\";\n    glObj.END_DATE = \"8 Novembre\";\n    glObj.COUPON_VALUE = \"25\";\n    glObj.COUPON_CODE = \"SWEETHOME25\";\n\n    glObj.isProd = () => glObj.ENV === 'prod';\n\n    glObj.SUPPORTED_LANGS = [\n        {code:'en',name:'English', defaultLocation: 'milan italy',tryAndBuyWordPressPath: 'try-our-brands'},\n        {code:'it',name:'Italiano', defaultLocation: 'milan italy',tryAndBuyWordPressPath: 'prova-i-nostri-brand'},\n        // {code:'de',name:'Deutsch', defaultLocation: 'berlin germany',tryAndBuyWordPressPath: 'marken-anprobieren'}\n    ];\n\n\n\n\n    glObj.RENT_NOW_URL = 'https://qx87h.app.goo.gl/?link=https://paladintrue.com/{0}/?product-detail?{1}&apn=com.a2l.paladin&isi=1129780407&ibi=com.a2l.paladin&efr=1';\n    glObj.RENT_URL = 'https://qx87h.app.goo.gl/?link=https://paladintrue.com/it&apn=com.a2l.paladin&isi=1129780407&ibi=com.a2l.paladin';\n\n    if (glObj.ENV === 'prod') {\n        glObj.ROOT_PATH = 'https://rent.paladintrue.com/'\n        glObj.BASE_URL = 'https://live.v1.paladintrue.com/';\n        glObj.PROFILE_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/livepaladinimages/ProfileImage/'; // no suffix slash\n        glObj.PRODUCT_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/livepaladinimages/ProductImage/'; // no suffix slash\n        glObj.CATEGORY_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/livepaladinimages/CategoryImage/'; // no suffix slash\n        glObj.LOG_LEVEL = 'none';\n        glObj.STRIPE_SK = 'sk_live_n1ODuFHO82iZulfbRIBQ0WUa';\n\n    } else {\n        glObj.ROOT_PATH = 'https://webtest.paladintrue.com/'\n        glObj.BASE_URL = 'https://staging.paladintrue.com/';\n        glObj.PROFILE_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/staggingimages/ProfileImage/'; // no suffix slash\n        glObj.PRODUCT_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/staggingimages/ProductImage/'; // no suffix slash\n        glObj.CATEGORY_IMAGE_URL = 'https://s3.eu-central-1.amazonaws.com/staggingimages/CategoryImage/'; // no suffix slash\n        glObj.LOG_LEVEL = 'verbose';\n        glObj.STRIPE_SK = 'sk_test_Qxfl7rPTVALyVnrMRUkb2l3F';\n    }\n\n    glObj.API_URL = glObj.BASE_URL+'api/Paladin/'; // no suffix slash\n    glObj.TOKEN_URL = glObj.BASE_URL+'Token'; // no suffix slash\n    glObj.STRIPE_URL = 'https://api.stripe.com/v1';\n    glObj.PROMO_SIGNUP_TIMER = 10000;\n    window.globals = glObj;\n})(window);\n\nangular.module('paladinApp')\n    .constant('enums', {\n        busEvents: {\n            onAppOnlineState: 'PT_BE_onAppOnlineState',\n            $routeChangeError:'$routeChangeError',\n            userLogin: 'PT_BE_userLogin',\n            userSignup: 'PT_BE_userSignup',\n            userLogout: 'PT_BE_userLogout',\n            preferredLanguageChange: 'PT_BE_preferredLanguageChange',\n            updatedUser: 'PT_BE_updatedUser',\n            facebookApiLoad: 'PT_BE_facebookApiLoad',\n            tokenRefresh:'PT_BE_tokenRefresh',\n            triggerEmailValidation: 'PT_BE_triggerEmailValidation',\n            locationUpdate: 'PT_BE_locationUpdate',\n            categoriesUpdate: 'PT_BE_categoriesUpdate',\n            googlePlacesAutocompletePlaceChanged: 'PT_BE_googlePlacesAutocompletePlaceChanged',\n            reloadDetailedBooking: 'PT_BE_reloadDetailedBooking',\n            footerExtraHeight: 'PT_BE_footerExtraHeight',\n            scrollMainScrollerToTop: 'PT_BE_scrollMainScrollerToTop',\n            rentalRequestPickerUpdateDates: 'PT_BE_rentalRequestPicker',\n        },\n        busNavigation: {\n            homePage:'PT_BN_homePage',\n            productDetailed: 'PT_BN_productDetailed',\n            browseCategory: 'PT_BN_browseCategory',\n            browseKeyword: 'PT_BN_browseKeyword',\n            browseSort: 'PT_BN_browseSort',\n            switchBrowseMode: 'PT_BN_browseModeSwitch',\n            userProfile: 'PT_BN_userProfile',\n            userListings: 'PT_BN_userListings',\n            newProduct: 'PT_BN_newProduct',\n            rentals: 'PT_BN_rentals',\n            transactionDetailed: 'PT_BN_transactionDetailed',\n            idVerification: 'PT_BN_idVerification',\n            userReview: 'PT_BN_userReview',\n            paymentDetailed: 'PT_BN_paymentDetailed',\n            chat: 'PT_BN_chat',\n        },\n        busChatEvents: {\n            updateUnreadCount: 'PT_BCE_updateUnreadCount',\n            newMessage: 'PT_BCE_newMessage',\n            detailedChatSelected: 'PT_BCE_detailedChatSelected',\n            startNewMessagesPoller: 'PT_BCE_startNewMessagesPoller',\n            selectPendingChat: 'PT_BCE_selectPendingChat',\n        },\n        ngMetaValues: {\n            currentUrl: (langCode) => `currentUrl_${langCode}`, // APPEND LANG\n        },\n        categoriesBannersPaths: {\n            all: {\n                en: '/assets/banner-try-and-buy-en.jpg',\n                it: '/assets/banner-try-and-buy-it.jpg'\n            },\n            promo: '/assets/promo-banner.jpg',\n            addProduct: '/assets/all-categories-banner-3.png',\n            allP2P: '/assets/all-categories-banner-3.png',\n\n        },\n        localStorageKeys: {\n            jwtToken: 'PT_LSK_jwt_token',\n            refreshToken: 'PT_LSK_refreshToken',\n            preferredLanguage: 'PT_LSK_preferredLanguage',\n            userId: 'PT_persistAuth',\n            locationLatLong: 'PT_LSK_locationLatLong',\n            pendingPrivateState: 'PT_LSK_pendingPrivateState',\n        },\n        allCategories: {\n            'en':'All Categories',\n            'it':'Tutte le Categorie',\n            'de':'Alle Kategorien'\n        },\n        secret: 'd05ac55661e27663c025aca7047c825908ae1562',\n        inAppSideNavsIds: {\n          mainMobileNav: 'main-mobile-side-nav',\n          chatSideNav: 'chat-list-side-nav'\n        },\n        categoriesIds: {\n            tryAndBuy: window.globals.isProd() ? 11 : 15,\n            outdoor: window.globals.isProd() ? 20 : 12,\n            homeAppliance: window.globals.isProd() ? 18 : 8,\n            hiTech: window.globals.isProd() ? 17 : 2,\n            smartMobility: window.globals.isProd() ? 19 : 4,\n        },\n        productsSortOptions: {\n            geoLocation:'SortByGeoLocation',\n            popularity: 'SortByPopularity',\n            bestProduct: 'SortByBestProduct',\n            review: 'SortByReview',\n            lowPrice: 'SortByLowPrice',\n            highPrice: 'SortByHighPrice',\n            recent: 'SortByRecent',\n        },\n        productsSortByTextCode: {\n            SortByPopularity: 'POPULARITY',\n            SortByRecent: 'MREC',\n            SortByGeoLocation: 'NEAREST',\n            SortByBestProduct: 'RELEVANCE',\n            SortByLowPrice: 'LP',\n            SortByHighPrice: 'HP'\n        },\n        userProductsFilter: {\n            borrowedProducts: 'BorrowedProduct',\n            lentProduct: 'LentProduct',\n            allProducts:'AllProduct',\n            myProductsToBorrow: 'MyProductsToBorrow',\n        },\n        productRentalStatus: {\n            available: -1,\n            requested: 1,\n            notVerified: 2,\n            verified: 3,\n            timeout: 4,\n            denied: 5,\n            canceled: 6,\n            accepted: 7,\n            started: 8,\n            ended: 9,\n            criticalCancel: 10,\n            moderateCancel: 11,\n            canceledByLender: 12,\n            timeoutByBorrower: 13,\n            verifying: 14,\n            booked: 15,\n\n        },\n        productRentalStatusNames: {\n            requested: 'requested',\n            notVerified: 'notverified',\n            verified: 'verified',\n            timeout: 'timeout',\n            denied: 'denied',\n            cancelled: 'cancelled',\n            criticalCancel: 'cancellation-Critical',\n            moderateCancel: 'cancellation-Moderate',\n            accepted: 'accepted',\n            started: 'started',\n            ended: 'ended',\n            canceledByLender: 'cancelled-By-Lender',\n            timeoutByBorrower: 'card_not_verified_timeout'\n        },\n        trackingStep: {\n            pending: 0,\n            success: 1,\n            failure: 2,\n        },\n        bookingReviewStatus: {\n            noReview: 0, // booking_ReviewStatus 0 // no-review\n            reviewByBorrower: 1, // booking_ReviewStatus 1 // review by lender\n            reviewByLender: 2,\n            reviewByBoth: 3, // booking_ReviewStatus 2 // review by borrower\n        },\n        idVerificationMethod: {\n            passport: 'passport',\n            driverLicense: 'driverLicense',\n            id: 'id',\n        },\n        acuantImageSource: {\n            mobileCropped: 101,\n            scanShellTwain: 102,\n            SnapShell: 103,\n            Other: 105,\n        },\n        acuantRegions: {\n            USA: 0,\n            Canada: 1,\n            SouthAmerica: 2,\n            Europe: 3,\n            Australia: 4,\n            Asia: 5,\n            GeneralDocs: 6,\n            Africa: 7.\n        }\n    });\n\n/*\nProd\n\"Category_Id\": 11,\"Category_Name\": \"Try the brands\",\n\"Category_Id\": 2,\"Category_Name\": \"Hi-Tech\",\n\"Category_Id\": 4,\"Category_Name\": \"Music\",\n\"Category_Id\": 9,\"Category_Name\": \"Outdoor\",\n\"Category_Id\": 7,\"Category_Name\": \"Home & Garden\",\n\"Category_Id\": 1,\"Category_Name\": \"Sports\",\n\"Category_Id\": 8,\"Category_Name\": \"Clothes\",\n\"Category_Id\": 13,\"Category_Name\": \"Events\",\n\"Category_Id\": 12,\"Category_Name\": \"Props\",\n\"Category_Id\": 10,\"Category_Name\": \"Other\",\n\nTest\n\"Category_Id\": 12,\"Category_Name\": \"Sports\",\n\"Category_Id\": 15,\"Category_Name\": \"Try & Buy\",\n\"Category_Id\": 8,\"Category_Name\": \"Clothes\",\n\"Category_Id\": 2,\"Category_Name\": \"Hi-Tech\",\n\"Category_Id\": 7,\"Category_Name\": \"Home & Garden\",\n\"Category_Id\": 4,\"Category_Name\": \"Music\",\n */\nangular.module('paladinApp').filter('capitalize', function() {\n    return function(input){\n        //console.log('capitalize : '+input)\n        if (input) {\n            if (input.indexOf(' ') !== -1) {\n                var inputPieces,\n                    i;\n\n                input = input.toLowerCase();\n                inputPieces = input.split(' ');\n\n                for (i = 0; i < inputPieces.length; i++) {\n                    inputPieces[i] = capitalizeString(inputPieces[i].trim());\n                }\n\n                return inputPieces.toString().replace(/,/g, ' ');\n            }\n            else {\n                input = input.toLowerCase();\n                return capitalizeString(input);\n            }\n        }\n        function capitalizeString(inputString) {\n            return inputString.substring(0, 1).toUpperCase() + inputString.substring(1);\n        }\n\n        return input\n    };\n});\nangular.module('paladinApp')\n.filter('ptCurrency', function () {\n   return function (input) {\n       return ' ' + input\n   }\n});\nangular.module('paladinApp')\n.filter('ptTruncate',function () {\n    return function (input, maxChars) {\n\n        if (input) {\n            if (input.length > maxChars) {\n                return input.slice(0,maxChars-3) + '...';\n            }\n        }\n        return input\n    }\n});\nangular.module('paladinApp')\n.filter('ptHtmlToPlainText',function () {\n    return function (input) {\n        return  input ? String(input).replace(/<[^>]+>/gm, '') : input;\n    }\n});\n'use strict';\n\n\nangular.module('paladinApp')\n    .service('chatService', [\n        '$rootScope',\n        'appStateManager',\n        'apiService',\n        'enums',\n        '$base64',\n        'toastService',\n        function ($rootScope,\n                  appStateManager,\n                  apiService,\n                  enums,\n                  $base64,\n                  toastService) {\n\n            const self = this;\n            self.CHAT_HASH = 'ZDA1YWM1NTY2MWUyNzY2M2MwMjVhY2E3MDQ3YzgyNTkwOGFlMTU2MjpQYWxhZGluXzEyMzEyMzEyMw==';\n            self.userDialogs = {};\n            if (window.globals.isProd()) {\n                self.kApplicationID = 48979;\n                self.kAuthKey = \"s64NxQBAMrmGYXz\";\n                self.kAuthSecret = \"wxqqXZAfdYpsEvd\";\n                self.kAccountKey = \"7awzEayyEjqP2LQuppJj\";\n            } else {\n                self.kApplicationID = 58169;\n                self.kAuthKey = \"u3n3guWwktMpCsU\";\n                self.kAuthSecret = \"yV26WrfkrBMZC2n\";\n                self.kAccountKey = \"7awzEayyEjqP2LQuppJj\";\n            }\n\n\n            const onMessage = (userId, message) => {\n                // This is a notification about dialog creation\n                if (message && message.body) {\n                    let msg = message;\n                    msg.isMe = userId == self.chatUser.id;\n                    msg.message = message.body;\n                    msg._id = message.id;\n                    if (msg.message === 'attachment' && msg.extension && msg.extension.attachments && msg.extension.attachments.length > 0) {\n                        msg.message = '';\n                        msg.img = QB.content.privateUrl(msg.extension.attachments[0].uid);\n                    }\n                    $rootScope.$emit(enums.busChatEvents.newMessage,msg);\n                }\n            };\n\n            const onDisconnectedListener = () => {\n                console.warn('onDisconnectedListener')\n            };\n\n            const onReconnectListener = () => {\n                console.warn('onReconnectListener')\n            };\n\n            const init = () => {\n                QB.init(self.kApplicationID,self.kAuthKey,self.kAuthSecret,{\n                    debug: { mode: window.globals.isProd() ? 0 : 1 },\n                    chatProtocol: {\n                        active: 2// set 1 to use BOSH, set 2 to use WebSockets (default)\n                    },\n                });\n                QB.chat.onDisconnectedListener = onDisconnectedListener;\n                QB.chat.onReconnectListener = onReconnectListener;\n                QB.chat.onMessageListener = onMessage;\n                getAppSession();\n\n            };\n\n            const getAppSession = () => {\n                return new Promise((resolve,reject) => {\n                    if (self.chatAppSession) {\n                        resolve(self.chatAppSession)\n                    } else {\n                        QB.createSession(function (err, result) {\n                            // callback function\n                            console.log(err, result);\n                            if (result && result.token) {\n                                self.chatAppSession = result;\n                                resolve(result)\n                            } else {\n                                reject('could not create app session')\n                            }\n                        });\n                    }\n                })\n            };\n\n            const getUserParams = () => {\n                const password = $base64.decode(self.CHAT_HASH).split(':')[1];\n                const {user} = appStateManager;\n                const {User_Email, User_FacebookId, User_UserName} = user;\n                if (User_FacebookId != undefined && User_FacebookId != '') { // facebook user\n                    return {\n                        login: User_FacebookId,\n                        password\n                    }\n                } else { // manual user\n                    return {\n                        login: User_UserName,\n                        password,\n                    };\n                }\n\n            };\n\n            const loginToChat = () => {\n                // Probably open a socket?\n                return new Promise((resolve,reject) =>  {\n                    getAppSession()\n                        .then((session) => {\n                            let params = {\n                                ...getUserParams(),\n                                token: session.token,\n                            };\n                            QB.login(params,(err,user) => {\n                                if (err) {\n                                    if (err.code === 401) { // user doesn't exist in QB, create instead\n                                        signupToChat().then(resolve).catch(reject)\n                                    } else {\n                                        reject(err);\n                                    }\n                                } else {\n                                    self.chatUser = user;\n                                    resolve(user);\n                                    syncQbUserId()\n                                }\n                            })\n                        })\n                        .catch(reject)\n                })\n            };\n\n            const signupToChat = () => {\n                return new Promise((resolve,reject) => {\n                    getAppSession()\n                        .then((session) => {\n                            let params = {\n                                ...getUserParams(),\n                                token: session.token\n                            };\n\n                            QB.users.create(params, function (err, user) {\n                                console.log(err, user);\n                                if (user) {\n                                    // success\n                                    self.chatUser = user;\n                                    resolve(user);\n                                    syncQbUserId()\n                                } else {\n                                    // error\n                                    reject(err)\n                                }\n                            });\n                        })\n                        .catch(reject)\n                })\n            };\n\n\n            const connectToChat = () => { // socket\n                return new Promise((resolve, reject) => {\n                    getAppSession()\n                        .then((session) => {\n                            const params = {\n                                ...getUserParams(),\n                                token: session.token\n                            };\n                            QB.createSession(params,(err,result) => {\n                                if (result) {\n                                    self.userToken = result.token;\n                                    QB.chat.connect({\n                                        userId: self.chatUser.id,\n                                        password:params.password\n                                    }, (err2,res) => {\n                                        if (!err2) {\n                                            //   Connected to socket\n                                            resolve(res);\n                                            if (self.pendingChatToJoin) {\n                                                $rootScope.$emit(enums.busChatEvents.selectPendingChat,{chatId: self.pendingChatToJoin});\n                                                self.pendingChatToJoin = undefined;\n                                            }\n                                        } else {\n                                            reject(err2)\n                                        }\n                                    })\n                                } else {\n                                    reject(err)\n                                }\n                            })\n                        })\n                        .catch(reject)\n                })\n            };\n\n            const syncDialogList = () => {\n                return new Promise((resolve,reject) => {\n                    QB.chat.dialog.list(null,(err,result) => {\n                        if (result) {\n                            result.items.forEach((item) => {\n                                self.userDialogs[item._id] = self.userDialogs[item._id] || 0\n                            });\n                            getUnreadMessage()\n                                .then(resolve)\n                                .catch(reject)\n                        } else {\n                            reject(err)\n                        }\n                    })\n                })\n            };\n\n            const syncQbUserId = () => {\n                apiService.users.editProfile({\n                    User_QBId: self.chatUser.id,\n                    User_Id: appStateManager.getUserId(),\n                })\n                    .then((res) => console.log('SUCCESSFULLY UPDATED PROFILE'))\n                    .catch((err) => console.error('ERROR UPDATING PROFILE'));\n            };\n\n            const disconnectChat = () => {\n                QB.chat.disconnect()\n            };\n\n            const createOrStartChat = ({\n                                           lenderId,\n                                           borrowerId,\n                                           lenderQBId,\n                                           borrowerQBId,\n                                           productId,\n                                           productName,\n                                           chatRoomId = null,\n                                           bookingId = null,\n                                       }) => {\n                /**\n                 * lenderQbId: '=',\n                 lenderId: '=',\n                 borrowerQbId: '=',\n                 borrowerId: '=?',\n                 productId: '=',\n                 bookingId: '=?',\n                 */\n\n                /**\n                 *  {\n                      \"User_UDID\": \"sample string 1\",\n                      \"User_UDIDType\": 2,\n                      \"Borrower_Id\": 3,\n                      \"Lender_Id\": 4,\n                      \"Product_Id\": 5,\n                      \"MeetingTime\": \"sample string 6\",\n                      \"Chat_QBRoomId\": \"sample string 7\",\n                      \"LanguageCode\": \"sample string 8\",\n                      \"BookingId\": 9\n                    }\n                 */\n                return new Promise((resolve,reject) => {\n                        if (chatRoomId) {\n                            // chat exists, fetch from server\n                            apiService.chats\n                                .startBookingChat({\n                                    lenderId,\n                                    borrowerId,\n                                    productId,\n                                    chatRoomId,\n                                    bookingId,\n                                })\n                                .then((res) => {\n                                    resolve(res.Data);\n                                })\n                                .catch((err) => {\n                                    reject(err);\n                                })\n\n                        } else {\n                            // chat doesn't exist, create in QB and link with server\n                            let params = {\n                                name: productName,\n                                type: 2, //group chat,\n                                occupants_ids: [lenderQBId,borrowerQBId],\n                            };\n                            QB.chat.dialog.create(params, (err,result) => {\n                                    if (err) {\n                                        reject(err)\n                                    } else {\n                                        const dialogId = result._id;\n                                        apiService.chats\n                                            .startBookingChat({\n                                                lenderId,\n                                                borrowerId,\n                                                productId,\n                                                chatRoomId: dialogId,\n                                                bookingId,\n                                            })\n                                            .then((res) => {\n                                                resolve(res.Data)\n                                            })\n                                            .catch((err) => {\n                                                result(err)\n                                            })\n                                    }\n                            });\n                        }\n                })\n            };\n\n\n            const setUserTyping = (userId, isTyping) => {\n                return new Promise((resolve => {\n                    resolve(`${userId} is now ${isTyping ? 'Typing..' : 'Idle'}`)\n                }))\n            };\n\n            const uploadMedia = (inputElement) => {\n                return new Promise((resolve => {\n                    resolve('Media file uploaded!')\n                }));\n            };\n\n            const getDialogsList = () => {\n                  return new Promise((resolve,reject) => {\n\n                  })\n            };\n\n            const getChatList = (userId,pageIndex = 0) => {\n                return new  Promise((resolve,reject) => {\n                    // let arr = [];\n                    // let index = 0;\n                    // while (arr.length < 30 && pageIndex < 40) {\n                    //     arr.push({\n                    //         Chat_Id: new Date().getTime() + index++,\n                    //         Product_Title: 'My Product',\n                    //\n                    //         recipient: 'John Smith',\n                    //         borrowerName: 'Samer Murad',\n                    //         thumbnail: 'tofyk5Tv55ghu7pacsjz5a4stKjQj',\n                    //     })\n                    // }\n                    // setTimeout(() => resolve(arr),500);\n                    // return;\n                    apiService.chats.getChatsList({\n                        userId,\n                        pageIndex,\n                    })\n                        .then((res) => {\n                            if (res.Data) {\n                                // resolve(res.Data);\n                                let lists = res.Data.Chat_Borrow.concat(res.Data.Chat_Lent).map((item) => {\n                                    item.thumbnail = item.Lender_UserId == appStateManager.user.User_Id ?  item.Borrower_ProfileImage : item.Lender_ProfileImage;\n                                    item.recipient = item.Lender_UserId == appStateManager.user.User_Id ?   item.Borrower_FullName : item.Lender_FullName;\n                                    item.initialBadge = (self.userDialogs || {})[item.Chat_QBRoomId] || 0;\n                                    item.lastUpdatedDate = new Date(item.ChatLastUpdated);\n                                    item.isLent = item.Lender_UserId == appStateManager.user.User_Id;\n                                    return item;\n                                });\n                                lists = lists.sort((a,b) => a.lastUpdatedDate - b.lastUpdatedDate);\n                                resolve(lists);\n                                if (self.pendingChatToJoin) {\n                                    $rootScope.$emit(enums.busChatEvents.selectPendingChat,{chatId: self.pendingChatToJoin});\n                                    self.pendingChatToJoin = undefined;\n                                }\n                            } else\n                                reject(Error('No data'))\n                        })\n                        .catch(reject)\n                })\n            };\n\n            const getChatDetailed = (chatQbId) => {\n                return new Promise((resolve,reject) => {\n                    apiService.chats.getChatByQBId({chatQbId})\n                        .then((res) => resolve(res.Data))\n                        .catch(reject)\n                })\n            };\n\n            const getChatHistory = (dialogId,skip = 0) => {\n                return new Promise((resolve,reject) => {\n                        // let arr = [];\n                        // let index = 0;\n                        // while (arr.length < 4) {\n                        //     arr.push({\n                        //         message: 'This is test message',\n                        //         isMe: index % 3 == 0,\n                        //         thumbnail: 'tofyk5Tv55ghu7pacsjz5a4stKjQj',\n                        //         img: index == 3 ? 'https://picsum.photos/800/1300/?random' : undefined,\n                        //         isSent: true,\n                        //         _id: new Date().getTime() + index++\n                        //     })\n                        // }\n                        // setTimeout(() => {\n                        //     resolve(arr)\n                        // },500)\n                    QB.chat.message.list({chat_dialog_id: dialogId,skip: skip,limit:10,sort_desc:'date_sent'},(err,result) => {\n                        if (err)\n                            reject(err);\n                        else {\n                            const msgs = result.items.map((item) => {\n                                item.isMe = item.sender_id == self.chatUser.id;\n                                item.thumbnail = 'tofyk5Tv55ghu7pacsjz5a4stKjQj';\n                                item.dateSent = new Date(item.date_sent * 1000);\n                                if (item.message === 'attachment' && item.attachments && item.attachments.length > 0) {\n                                    item.message = '';\n                                    item.img = QB.content.privateUrl(item.attachments[0].uid);\n                                }\n                                return item\n                            });\n                            resolve(msgs.reverse());\n                        }\n                    })\n\n                })\n            };\n\n            const joinChat = (dialogId) => {\n                const chatDialog = QB.chat.helpers.getRoomJidFromDialogId(dialogId);\n                return new Promise((resolve,reject) => {\n                    QB.chat.muc.join(chatDialog,function(presence) {\n                        resolve()\n                    })\n                })\n            };\n\n            const leaveChat = (dialogId) => {\n                const chatDialog = QB.chat.helpers.getRoomJidFromDialogId(dialogId);\n                return new Promise((resolve,reject) => {\n                    QB.chat.muc.leave(chatDialog,function(presence) {\n                            resolve()\n                    })\n                })\n            };\n\n            const sendMessage = ({dialogId, text,productId, input /* inputElement (Optional) */}) => {\n                return new Promise((resolve,reject) => {\n                    const chatDialog = QB.chat.helpers.getRoomJidFromDialogId(dialogId);\n                    if( input && input.files.length > 0) { // is File\n                        const inputFile = input.files[0];\n                        let params = {name: inputFile.name, file: inputFile, type: inputFile.type, size: inputFile.size, 'public': false};\n                        QB.content.createAndUpload(params, function(err, res) {\n                            if (err) {\n                                console.error(err);\n                                reject(err);\n                            } else {\n                                const fileUID = res.uid;\n                                // prepare a message\n                                let msg = {\n                                    type: 'groupchat',\n                                    body: \"attachment\",\n                                    ProductId: productId,\n                                    extension: {\n                                        save_to_history: 1,\n                                        attachments: [ {uid: fileUID , type: 'photo'} ],\n                                        ProductId: productId,\n                                        dialogID: dialogId,\n                                        isBot: '0'\n                                    },\n                                    markable: 1\n                                };\n                                QB.chat.send(chatDialog,msg);\n                                resolve()\n                            }\n                        });\n                    } else {\n\n                        QB.chat.send(chatDialog, {\n                            type: 'groupchat',\n                            body: text,\n                            extension: {\n                                save_to_history: 1,\n                                ProductId: productId,\n                                dialogID: dialogId,\n                                isBot: '0'\n                            },\n                            markable: 1,\n                        });\n                        resolve()\n                    }\n                })\n            };\n\n\n            const notifyUser = ({\n                                     userId,\n                                     dialogId,\n                                     isNewChat = false,\n                                 }) => {\n                return new Promise((resolve,reject) => {\n                        let msg = {\n                            type: 'chat',\n                            extension: {\n                                notification_type: isNewChat? 1 : 2,\n                                _id: dialogId,\n                            },\n                        };\n\n                        QB.chat.send(userId, msg);\n                    resolve();\n                });\n            };\n\n            const getUnreadMessage = () => {\n                return new Promise((resolve,reject) => {\n                    const dialogIds = Object.keys(self.userDialogs);\n                    Promise.all(\n                        dialogIds.map((key) => getUnreadMessagesForDialogId(key))\n                    )\n                        .then((results) => {\n                            results.forEach((item) => {\n                                self.userDialogs[item.dialogId] = item.count || 0\n                            });\n                            resolve(self.userDialogs)\n                        })\n                        .catch((err) => {\n                            reject(err)\n                        });\n                });\n            };\n\n            const getUnreadMessagesForDialogId = (dialogId) => {\n                  return new Promise((resolve) => {\n                      QB.chat.message.unreadCount({chat_dialog_ids: dialogId},(err,res) => {\n                          if (err)\n                              resolve(0);\n                          else {\n                              resolve({\n                                  dialogId: dialogId,\n                                  count: (res || {})[dialogId] || 0\n                              });\n                          }\n                      })\n                  })\n            };\n            const getTotalUnreadCount = () => {\n                return new Promise((resolve => {\n                    QB.chat.message.unreadCount(null,(err,res) => {\n                        if (err)\n                            resolve(0);\n                        else {\n                            resolve(res);\n                        }\n                    })\n                }))\n            } ;\n\n            const clearUnreadBadgesForDialog = (dialogId) => {\n                self.userDialogs[dialogId] = 0;\n                let numberOfUnreadMessages = 0;\n                Object.keys(self.userDialogs)\n                    .forEach((dialog) => {\n                        numberOfUnreadMessages += self.userDialogs[dialog];\n                    });\n                $rootScope.$emit(enums.busChatEvents.updateUnreadCount,{\n                    total: numberOfUnreadMessages,\n                    detailedDict: self.userDialogs,\n                })\n            };\n\n            const activateChatWhenReady = (dialogId) => {\n                self.pendingChatToJoin = dialogId\n            };\n\n            return {\n                init,\n                loginToChat,\n                createOrStartChat,\n                setUserTyping,\n                uploadMedia,\n                getChatList,\n                getChatDetailed,\n                getChatHistory,\n                signupToChat,\n                connectToChat,\n                disconnectChat,\n                syncDialogList,\n                sendMessage,\n                joinChat,\n                leaveChat,\n                notifyUser,\n                getUnreadMessage,\n                clearUnreadBadgesForDialog,\n                activateChatWhenReady\n            }\n    }]);\nangular.module('paladinPopups',[\n    'ngMaterial',\n    'ngMessages',\n    'ngMaterialDateRangePicker',\n    'angularMoment',\n    '720kb.socialshare'\n])\n    .config(['$mdDialogProvider',function ($mdDialogProvider) {\n        $mdDialogProvider.addPreset('confirmPreset', {\n            options: function () {\n                return {\n                    templateUrl: './views/popups/confirm.popup.html',\n                    controller: 'confirmPopup',\n                    bindToController: true,\n                    controllerAs: 'confirmCtrl',\n                    clickOutsideToClose: true,\n                    escapeToClose: true\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('loginSignup', {\n            options: function () {\n                return {\n                    templateUrl:'./views/popups/loginSignup.popup.html',\n                    controller: 'loginSignUpPopup',\n                    bindToController: true,\n                    controllerAs: 'loginSignupCtrl',\n                    clickOutsideToClose: true,\n                    escapeToClose: true,\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('forgotPassword',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/forgotPassword.popup.html',\n                    controller: 'forgotPasswordPopup',\n                    controllerAs: 'forgotPasswordCtrl',\n                    clickOutsideToClose: true,\n                    escapeToClose: true,\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('idVerificationFailureHandler',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/idVerificationFailureHandler.popup.html',\n                    controller: 'idVerificationFailureHandlerPopup',\n                    controllerAs: 'idVerificationFailureHandlerPopup',\n                    clickOutsideToClose: false,\n                    escapeToClose: false\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('emailVerification',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/emailVerification.popup.html',\n                    controller: 'emailVerificationPopup',\n                    controllerAs: 'emailVerificationCtrl',\n                    clickOutsideToClose: false,\n                    escapeToClose: false\n\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('shareReferralLink',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/shareToSocialMedia.popup.html',\n                    controller: 'shareToSocialMediaPopup',\n                    controllerAs: 'shareToSocialMediaCtrl',\n                    clickOutsideToClose: true,\n                    escapeToClose: true\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('changePassword',{\n            options: function () {\n                return {\n                    templateUrl:'./views/popups/changePassword.popup.html',\n                    controller: 'changePasswordPopup',\n                    controllerAs: 'changePasswordCtrl',\n                    clickOutsideToClose: true,\n                    escapeToClose: true\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('transactionStatusChange',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/transactionStatusChange.popup.html',\n                    controller: 'transactionStatusChangePopup',\n                    controllerAs: 'transactionStatusChangeCtrl',\n                    clickOutsideToClose: false,\n                    escapeToClose: false,\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('inputField',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/inputField.popup.html',\n                    controller:'inputFieldPopup',\n                    controllerAs: 'inputFieldCtrl',\n                    clickOutsideToClose: false,\n                    escapeToClose: false,\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('loader',{\n            options: function () {\n                return {\n                    templateUrl: './views/popups/loader.popup.html',\n                    controller: 'loaderPopup',\n                    controllerAs: 'loaderCtrl',\n                    panelClass: 'loaderOverlay',\n                    clickOutsideToClose: false,\n                    escapeToClose: false,\n                }\n            }\n        });\n\n        $mdDialogProvider.addPreset('bookingTrackerInfoMobile', {\n            options: function () {\n                return {\n                    templateUrl: './views/popups/bookingTrackerInfoMobile.popup.html',\n                    controller: 'bookingTrackerInfoMobilePopup',\n                    controllerAs: 'bookingTrackerInfoMobilePopupCtrl',\n                    clickOutsideToClose: false,\n                    escapeToClose: false,\n                }\n            }\n        })\n    }])\n\n\n    .service('popupService', [\n        \n        '$mdDialog',\n        '$mdDateRangePicker',\n        'moment',\n        'ptUtils',\n        function (\n            $mdDialog,\n            $mdDateRangePicker,\n            moment,\n            ptUtils) {\n\n            this.showAlert = function (title, message, okBtn = 'POPUP_OK') {\n                return new Promise((resolve,reject) => {\n                    const confirm2 = $mdDialog.confirmPreset({\n                        locals: {\n                            title,\n                            message,\n                            isConfirm: false,\n                            okBtn: okBtn,\n                        }\n                    });\n\n                    $mdDialog.show(confirm2)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showConfirm = function (title,message,yesButton = 'POPUP_YES', noButton = 'POPUP_NO') {\n                return new Promise((resolve,reject) => {\n                    const confirm2 = $mdDialog.confirmPreset({\n                        locals: {\n                            title,\n                            message,\n                            yesButton,\n                            noButton,\n                            isConfirm: true,\n                        }\n                    });\n\n                    $mdDialog.show(confirm2)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showLoginSignupPopup = function (isSignUp = false) {\n                return new Promise((resolve,reject) => {\n                    const loginSignup = $mdDialog.loginSignup({\n                        locals: {\n                            selectedTab: isSignUp ? 1 : 0\n                        },\n                    });\n                    $mdDialog.show(loginSignup)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showForgotPassword = function () {\n                return new Promise((resolve,reject) => {\n                    $mdDialog.show($mdDialog.forgotPassword())\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showIdVerificationFailureHandler = function (data) {\n                console.log('idVerificationFailureHandler locals ', data)\n                return new Promise((resolve,reject) => {\n                    const idVerificationHandler = $mdDialog.idVerificationFailureHandler({\n                        locals: data\n                    });\n                    $mdDialog.show(idVerificationHandler)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showEmailVerification = function (userId/* Must be provided for verification*/) {\n                return new Promise((resolve,reject) => {\n                    const emailVerification = $mdDialog.emailVerification({\n                        locals: {\n                            userId,\n                        }\n                    });\n                    $mdDialog.show(emailVerification)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showShareReferralLink = function (referralLink) {\n                return new Promise((resolve,reject) => {\n                    const shareReferralLink = $mdDialog.shareReferralLink({\n                        locals: {\n                            referralLink\n                        }\n                    });\n                    $mdDialog.show(shareReferralLink)\n                        .then(resolve)\n                        .catch((err)=>{\n                            // closing the modal on click-outside will reject so catch it here\n                            console.log('close modal err ', err)\n                        })\n                })\n            };\n\n            this.showDateRangePicker = function (productBookingDetails,product) {\n                return new Promise((resolve,reject) => {\n                    const dateRanges = ptUtils.getBookedDateRanges(productBookingDetails);\n\n                    $mdDateRangePicker.show({\n                        onePanel: true,\n                        autoConfirm: true,\n                        model: {},\n                        localizationMap: ptUtils.getTranslationDictForDatePicker(),\n                        maxRange: product.MaxRentalPeriod || undefined,\n                        isDisabledDate: ($date) => {\n                            const momentDate = moment($date);\n                            for (let i = 0; i < dateRanges.length ; i++)\n                                if (momentDate.isBetween(dateRanges[i].startDate,dateRanges[i].endDate) ||\n                                    momentDate.isSame(dateRanges[i].startDate) ||\n                                    momentDate.isSame(dateRanges[i].endDate))\n                                    return true;\n\n                            if (moment().isBefore($date)) return false; // TODO: - Check if product available for rent at dates\n\n                            return true;\n                        }\n                    })\n                        .then((result) => {\n                            resolve(result)\n                        })\n                        .catch(() => {\n                            reject()\n                        })\n                });\n            };\n\n            this.showChangePassword = function () {\n                return new Promise((resolve,reject) => {\n                    const changePass = $mdDialog.changePassword({\n                        locals: {\n                            wot: 'no',\n                        }\n                    });\n                    $mdDialog.show(changePass)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showTransactionStatusChange = function ({ booking, apiMethod, title }) {\n                return new Promise((resolve,reject) => {\n                    const statusChange = $mdDialog.transactionStatusChange({\n                        locals: {\n                            booking,\n                            apiMethod,\n                            title,\n                        }\n                    });\n\n                    $mdDialog.show(statusChange)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            this.showInputField = function ({title,\n                message,\n                initialValue,\n                inputRegexValidation = undefined,\n                validationErrorMessage = 'PLEASE_ENTER_A_VALID_INPUT'}) {\n                return new Promise((resolve,reject) => {\n                    const inputField = $mdDialog.inputField({\n                        locals: {\n                            title,\n                            message,\n                            value: initialValue,\n                            inputRegexValidation,\n                            validationErrorMessage\n                        }\n                    });\n\n                    $mdDialog.show(inputField)\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n            this.showLoader = function () {\n                $mdDialog.show($mdDialog.loader());\n            };\n            this.hideLoader = function () {\n                $mdDialog.hide();\n            };\n\n            this.showBookingTrackerInfoMobilePopup = function (booking) {\n                return new Promise((resolve => {\n                    const bookingTracker = $mdDialog.bookingTrackerInfoMobile({\n                        locals: {\n                            booking: booking\n                        }\n                    });\n                    $mdDialog.show(bookingTracker)\n                        .then(resolve)\n                        .catch(resolve)\n                }))\n            }\n\n        }]);\n\nangular.module('paladinApp')\n.service('ptLog', [function () {\n        this.log = function () {\n            if( window.globals.LOG_LEVEL === 'verbose') {\n                console.log.apply(this,['PALADIN LOG:',...arguments]);\n            }\n        };\n\n        this.warn = function () {\n            if (window.globals.LOG_LEVEL === 'verbose') {\n                console.warn.apply(this,['PALADIN WARN:',...arguments])\n            }\n        };\n\n        this.error = function () {\n            console.error.apply(this,['PALADIN ERROR:',...arguments]);\n        }\n}]);\nangular.module('paladinApp')\n    .service('apiService',[\n        '$rootScope',\n        '$q',\n        '$http',\n        '$base64',\n        'enums',\n        'ptLog',\n        'appStateManager',\n        function (\n            $rootScope,\n            $q,\n            $http,\n            $base64,\n            enums,\n            ptLog,\n            appStateManager) {\n\n            const self = this;\n\n            self.ENV = window.globals.API_URL.slice(0,-1);\n            self.timeoutCounter = 0;\n            self.maxTimeouts = 5;\n            self.raiseTimeout = function() {\n                if (self.timeoutCounter <= self.maxTimeouts)\n                    self.timeoutCounter += 1;\n                if (self.timeoutCounter > self.maxTimeouts && $rootScope.isAppOnline)\n                    $rootScope.$emit(enums.busEvents.onAppOnlineState, false)\n            };\n            self.loweTimeout = function() {\n                if (self.timeoutCounter > 0)\n                    self.timeoutCounter -= 1;\n                if (self.timeoutCounter < self.maxTimeouts && !$rootScope.isAppOnline)\n                    $rootScope.$emit(enums.busEvents.onAppOnlineState, true)\n            };\n\n            self.getHttpConfig = function(params, headers) {\n                let config = {\n                    headers: {\n                        'Access-Control-Allow-Origin': '*',\n                        'X-Requested' : null,\n                        'Content-Type' : 'application/json; charset=utf-8',\n                        'Access-Control-Allow-Methods': 'GET, POST, PATCH, PUT, DELETE, OPTIONS',\n                        'Access-Control-Allow-Headers': 'Origin, Content-Type, X-Auth-Token',\n                    }\n                };\n                if (localStorage.getItem(enums.localStorageKeys.jwtToken)) {\n                    config.headers['Authorization'] = localStorage.getItem(enums.localStorageKeys.jwtToken);\n                }\n\n                if (headers) {\n                    Object.keys(headers).forEach((headerKey) => {\n                        config.headers[headerKey] = headers[headerKey];\n                    });\n                }\n\n                if (params) {\n                    config.params = params;\n                }\n\n                return config;\n            };\n\n            self.getDefaultParams = () => {\n                return {\n                    LanguageCode: appStateManager.getCurrentLang(),\n                }\n            };\n\n            const maxRetries = 5;\n            self.getRequest = function getData (path, params, headers, curRetryCounter) {\n                let deferred = $q.defer();\n                $http.get(self.ENV + path, self.getHttpConfig(params, headers))\n                    .then(function(response) {\n                        self.loweTimeout();\n                        if ((!response || !response.data) || response.data.Status == 'error') {\n                            deferred.reject(response);\n                        } else {\n                            deferred.resolve(response.data);\n                        }\n                        // if (response.status === 204) {\n                        //     deferred.reject(response);\n                        // } else {\n                        //     deferred.resolve(response.data);\n                        // }\n                    }, function(response) {\n                        if (!response) {\n                            console.warn('R_U');\n                            deferred.reject();\n                            return;\n                        }\n\n                        if (response.status === 401 && localStorage.getItem(enums.localStorageKeys.refreshToken)) {\n                            ptLog.log('Refreshing Token');\n                            self.apiMethods.users.refreshToken(localStorage.getItem(enums.localStorageKeys.refreshToken))\n                                .then((response) => {\n                                    ptLog.log('Refreshing Token success');\n                                    $rootScope.$emit(enums.busEvents.tokenRefresh,response.data);\n                                    setTimeout(() => {\n                                        self.getRequest(path, params,headers,curRetryCounter)\n                                            .then(deferred.resolve)\n                                            .catch(deferred.reject);\n                                    },500)\n                                })\n                                .catch(deferred.reject)\n                        } else if (response.status === 423) { /** RETRY HANDLER */\n                            if (!curRetryCounter) curRetryCounter = 0;\n\n                            if (curRetryCounter < maxRetries) {\n                                curRetryCounter++;\n                                let waitingBackoffTime_ms = curRetryCounter * 500; //ms\n                                setTimeout(() => {\n                                    self.getRequest(path, params, headers, curRetryCounter)\n                                        .then(response => deferred.resolve(response.data))\n                                        .catch(deferred.reject);\n                                }, waitingBackoffTime_ms);\n                            } else {\n                                deferred.reject(response);\n                            }\n                        } else {\n                            if (response.status === 0 || response.status === -1) {\n                                /** TIMEOUT */\n                                self.raiseTimeout();\n                            }\n                            deferred.reject(response);\n                        }\n                    });\n                return deferred.promise;\n            };\n\n            self.postRequest = function(path, data, headers, curRetryCounter) {\n                let deferred = $q.defer();\n\n                $http.post(self.ENV + path, data, self.getHttpConfig(null, headers))\n                    .then(function(response) {\n                        self.loweTimeout();\n                        if ((!response || !response.data) || response.data.Status == 'error') {\n                            deferred.reject(response);\n                        } else {\n                            deferred.resolve(response.data);\n                        }\n                        // if (response.status === 204) {\n                        //     deferred.reject(response);\n                        // } else {\n                        //     deferred.resolve(response.data);\n                        // }\n                    }, function(response) {\n\n                        if (!response) {\n                            console.warn('R_U');\n                            deferred.reject();\n                            return;\n                        }\n                        if (response.status === 401 && localStorage.getItem(enums.localStorageKeys.refreshToken)) {\n                                ptLog.log('Refreshing Token');\n                            self.apiMethods.users.refreshToken(localStorage.getItem(enums.localStorageKeys.refreshToken))\n                                .then((response) => {\n                                    ptLog.log('Refreshing Token success');\n                                    $rootScope.$emit(enums.busEvents.tokenRefresh,response.data);\n                                    setTimeout(() => {\n                                        self.postRequest(path, data,headers,curRetryCounter)\n                                            .then(deferred.resolve)\n                                            .catch(deferred.reject);\n                                    },500)\n                                })\n                                .catch(deferred.reject)\n                        } else if (response.status === 423) { /** RETRY HANDLER */\n                            if (!curRetryCounter) curRetryCounter = 0;\n\n                            if (curRetryCounter < maxRetries) {\n                                curRetryCounter++;\n                                let waitingBackoffTime_ms = curRetryCounter * 500; //ms\n                                setTimeout(() => {\n                                    self.postRequest(path, data, headers, curRetryCounter)\n                                        .then(response => deferred.resolve(response.data))\n                                        .catch(deferred.reject);\n                                }, waitingBackoffTime_ms);\n                            } else {\n                                deferred.reject(response);\n                            }\n                        } else {\n                            if (response.status === 0 || response.status === -1) {\n                                /** TIMEOUT */\n                                self.raiseTimeout();\n                            }\n                            deferred.reject(response);\n                        }\n                    });\n\n                return deferred.promise;\n            };\n\n            self.putRequest = function(path, data, headers, curRetryCounter) {\n                let deferred = $q.defer();\n\n                $http.put(self.ENV + path, data, self.getHttpConfig(null, headers))\n                    .then(function(response) {\n                        self.loweTimeout();\n                        if ((!response || !response.data) || response.data.Status == 'error') {\n                            deferred.reject(response);\n                        } else {\n                            deferred.resolve(response.data);\n                        }\n                        // if (response.status === 204) {\n                        //     deferred.reject(response);\n                        // } else {\n                        //     deferred.resolve(response.data);\n                        // }\n                    }, function(response) {\n\n                        if (!response) {\n                            console.warn('R_U');\n                            deferred.reject();\n                            return;\n                        }\n                        if (response.status === 401 && localStorage.getItem(enums.localStorageKeys.refreshToken)) {\n                            ptLog.log('Refreshing Token');\n                            self.apiMethods.users.refreshToken(localStorage.getItem(enums.localStorageKeys.refreshToken))\n                                .then((response) => {\n                                    ptLog.log('Refreshing Token success');\n                                    $rootScope.$emit(enums.busEvents.tokenRefresh,response.data);\n                                    setTimeout(() => {\n                                        self.postRequest(path, data,headers,curRetryCounter)\n                                            .then(deferred.resolve)\n                                            .catch(deferred.reject);\n                                    },500)\n                                })\n                                .catch(deferred.reject)\n                        } else if (response.status === 423) { /** RETRY HANDLER */\n                            if (!curRetryCounter) curRetryCounter = 0;\n\n                            if (curRetryCounter < maxRetries) {\n                                curRetryCounter++;\n                                let waitingBackoffTime_ms = curRetryCounter * 500; //ms\n                                setTimeout(() => {\n                                    self.putRequest(path, data, headers, curRetryCounter)\n                                        .then(response => deferred.resolve(response.data))\n                                        .catch(deferred.reject);\n                                }, waitingBackoffTime_ms);\n                            } else {\n                                deferred.reject(response);\n                            }\n                        } else {\n                            if (response.status === 0 || response.status === -1) {\n                                /** TIMEOUT */\n                                self.raiseTimeout();\n                            }\n                            deferred.reject(response);\n                        }\n                    });\n\n                return deferred.promise;\n            };\n\n\n            self.apiMethods = {\n                    categories: {\n                        getCategories: function () {\n                            return self.getRequest(`/GetCategories?LanguageCode=${appStateManager.getCurrentLang()}`)\n                        },\n\n                    },\n                    pages: {\n                        getHomePageData: function (categories) {\n                            let params = {};\n                            params.LanguageCode = appStateManager.getCurrentLang();\n                            params.Categories = categories;\n                            return self.getRequest(\"/GetHomePageData\", params)\n                        },\n                        getProductDetailData: function(id) {\n                            let params = {};\n                            params.LanguageCode = appStateManager.getCurrentLang();\n                            params.Product_Id = id;\n                            return self.getRequest(\"/GetProductDetailData\", params)\n                        }\n                    },\n                    products: {\n                        getSearchedProducts: function ({\n                                                           keyword /* string (optional) */,\n                                                           isShop /* string (optional) */,\n\n                                                           categoryId /* Number (optional) */,\n                                                           subCategoryId /* Number (optional) */,\n\n                                                           sortBy /* enums.productsSortOptions */,\n\n                                                           minPriceRange /* Number (optional) */,\n                                                           maxPriceRange /* Number (optional) */,\n\n                                                           city /* string (optional) */,\n                                                           lat /* Number (optional) */,\n                                                           lng /* Number (optional) */,\n                                                           range /* Number (optional) */,\n\n                                                           page /* Number (optional) */,\n                                                           productPerPage /* Number (optional) */,\n\n                                                           isWeb /* Boolean (optional) */,\n                                                           productIDs /*String (optional)*/,\n                                                           isTryAndBuy\n\n                                                       }) {\n\n                            const LanguageCode = appStateManager.getCurrentLang();\n                            let params = {\n                                LanguageCode,\n                            };\n\n                            if (keyword)\n                                params.KeywordProduct = encodeURIComponent(keyword);\n                            const userId = appStateManager.getUserId();\n                            if (appStateManager.user != null && userId != null)\n                                params.User_Id = userId;\n\n                            if (categoryId)\n                                params.Category_Id = categoryId;\n\n                            if (subCategoryId)\n                                params.SubCategory_Id = subCategoryId;\n\n                            if (isShop)\n                                params.IsShop = isShop;\n\n                            if (sortBy)\n                                params[sortBy] = true;\n\n\n                            if (minPriceRange)\n                                params.MinPriceRange = minPriceRange;\n\n                            if (maxPriceRange)\n                                params.MaxPriceRange = maxPriceRange;\n\n\n                            if (lat && lng) {\n                                params.Latitude = lat;\n                                params.Longitude = lng;\n                            }\n\n                            if (city)\n                                params.Product_City = city;\n\n                            if (range)\n                                params.Range = range;\n\n                            if (isWeb)\n                                params.IsWeb = isWeb;\n\n                            if (page)\n                                params.PageIndex = page;\n\n                            if (productPerPage)\n                                params.productPerPage = productPerPage;\n\n                            if (productIDs)\n                                params.productIDs = productIDs;\n                            if (isTryAndBuy) \n                                params.isTryAndBuy = isTryAndBuy;\n\n                            return self.getRequest('/GetSearchedProduct',params)\n                        },\n\n                        getPopularTryAndBuy: function () {\n\n                            return self.apiMethods.products.getSearchedProducts({\n                                productPerPage: 20,\n                                sortBy: enums.productsSortOptions.bestProduct,\n                                isTryAndBuy: true,\n                            })\n                        },\n\n                        getSuggestions: function (keyword) {\n                            let params = self.getDefaultParams();\n                            params.Keyword = encodeURIComponent(keyword);\n\n                            return self.getRequest('/Suggestion',params);\n                        },\n\n                        getDetailedProduct: function (productId) {\n                            const obj = self.getDefaultParams();\n                            let params = { Product_Id: productId, ...obj};\n                            const User_Id = appStateManager.getUserId();\n                            if (User_Id)\n                                params.User_Id = User_Id;\n                            return self.getRequest('/GetProductDetail',params)\n                        },\n                        getUserProducts: function ({\n                                                       userId,\n                                                       productsFilter /* enums.userProductsFilter*/,\n                                                       pageIndex = 0,\n                                                   }) {\n                            let obj = self.getDefaultParams();\n                            let params = {\n                                ...obj,\n                                User_Id: userId,\n                                PageIndex: pageIndex,\n                            };\n                            params[productsFilter] = true;\n\n                            return self.getRequest('/GetMyProducts',params);\n                        },\n                        getProductBookingDetails: function ({productId, userId}) {\n                            let obj = self.getDefaultParams();\n                            let params = {\n                                ...obj,\n                                User_Id: userId,\n                                Product_Id: productId,\n                            };\n                            return self.getRequest('/ProductBookingDetail',params);\n                        },\n                        addProduct: function ({\n                                                  Product_ItemCategory_Id,\n                                                  Product_Title,\n                                                  Product_Description,\n                                                  Product_Price_Perday,\n                                                  Product_IsShop,\n                                                  Product_City,\n                                                  Product_ShopURL,\n                                                  Price1Day,\n                                                  Price15Day,\n                                                  Product_TryAndBuy,\n                                                  MinRentalPeriod,\n                                                  MaxRentalPeriod,\n                                                  Product_Longitude,\n                                                  Product_Latitude,\n                                                  ProductImage_Image1,\n                                                  Product_LenduserId\n                                              }) {\n                            const data = {\n                                ...self.getDefaultParams(),\n                                Product_ItemCategory_Id,\n                                Product_Title,\n                                Product_Description,\n                                Product_Price_Perday,\n                                Product_IsShop,\n                                Product_City,\n                                Product_ShopURL,\n                                Price1Day,\n                                Price15Day,\n                                Product_TryAndBuy,\n                                MinRentalPeriod,\n                                MaxRentalPeriod,\n                                Product_Longitude,\n                                Product_Latitude,\n                                ProductImage_Image1,\n                                Product_LenduserId,\n                            };\n\n                            return self.postRequest('/AddProduct',data)\n\n                        }\n                    },\n                    reviews: {\n                        submitTransactionReview: (params) => {\n                            //console.log('submit review params ', params)\n                            return self.postRequest('/AddBookingReview', params)\n                        }\n                    },\n                    users: {\n                        signUp: function ({ email, username, password, location, currentLang, referralCode}) {\n                            const obj = {\n                                User_UserName : username,\n                                User_Email : email,\n                                User_Address : location,\n                                User_Password : password,\n                                User_UDIDType : 3,\n                                LanguageCode: currentLang,\n                                ReferralCode: referralCode\n                            };\n                            return self.postRequest('/SignUp',obj);\n                        },\n\n                        signupFacebook: function ({facebookName,email,address,currentLang,facebookUserId, referralCode}) {\n                            const dataObj = {\n                                User_UserName :facebookName.replace(\" \",\"-\") ,\n                                User_Email : email,\n                                User_Address : address,\n                                User_Password : \"\",\n                                User_UDIDType : 3,\n                                LanguageCode: currentLang,\n                                User_DisplayPicturePath:'https://graph.facebook.com/' + facebookUserId + '/picture?type=large',\n                                User_DisplayPicture: 'https://graph.facebook.com/' + facebookUserId + '/picture?type=large',\n                                User_FacebookId: facebookUserId ,\n                                User_FullName: facebookName,\n                                User_QBId:'',\n                                ReferralCode: referralCode\n                            };\n                            return self.postRequest('/Signup',dataObj);\n                        },\n\n                        signUpReferred: function(referralCode){\n                            const dataObj = {\n                                ReferralCode: referralCode,\n                                LanguageCode: appStateManager.getCurrentLang()\n                            };\n\n                            return self.getRequest('/VerifyReferralCode', dataObj);\n                        },\n\n                        login: function ({ username = '',email = '', password, currentLang}) {\n                            const obj = {\n                                User_UserName : username,\n                                User_Email : email,\n                                User_Mobile: \"\",\n                                User_UDIDType : 3,\n                                User_Password : password,\n                                User_FacebookId: \"\",\n                                LanguageCode: currentLang\n                            };\n                            return self.postRequest('/Login',obj);\n                        },\n\n                        forgotPassword: function({ email , currentLang }) {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                User_Email : email,\n                            };\n                            return self.postRequest('/ForgetPassword',dataObj,{ Authorization: $base64.encode('Paladin:Paladin123') })\n                        },\n\n                        changePassword: function ({userId,newPassword,oldPassword}) {\n                            const params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                User_NewPassword: newPassword,\n                                User_OldPassword: oldPassword\n                            };\n                            return self.postRequest('/ChangePassword',params);\n                        },\n\n                        emailVerification: function ({userId /* USER ID CODIFIED WITH BACKEND KEY*/}) {\n                            return self.getRequest(`/EmailVerfication/?User_Id=${userId}`,undefined,{ Authorization: $base64.encode('Paladin:Paladin123') });\n                        },\n\n                        getUserProfile: function ({userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId\n                            };\n                            return self.getRequest(`/GetUserProfile`,params);\n                        },\n\n                        getUserCredit: function ({userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId\n                            };\n                            return self.getRequest(`/GetUserCredit`,params);\n                        },\n\n\n                        refreshToken: function (refreshToken) {\n                            return $http({\n                                method: 'POST',\n                                url: window.globals.TOKEN_URL,\n                                headers: {'Content-Type': 'application/x-www-form-urlencoded'},\n                                transformRequest: function(obj) {\n                                    let str = [];\n                                    for(let p in obj)\n                                        str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\n                                    return str.join(\"&\");\n                                },\n                                data: {grant_type: 'refresh_token', refresh_token: refreshToken}\n                            })\n                        },\n\n                        editProfile: function (profile) {\n                            let body = {\n                                ...self.getDefaultParams(),\n                                ...profile\n                            };\n                            return self.putRequest('/EditProfile',body);\n                        },\n\n                        updateNotificaton: ({userId, emailNotif, chatNotif }) => {\n                            let dataObj = {\n                                ...self.getDefaultParams(),\n                                Notification_Chat: chatNotif,\n                                Notification_Push: chatNotif,\n                                Notification_Email: emailNotif,\n                                Notification_UserId: userId,\n                            };\n                            return self.postRequest('/UpdateNotification',dataObj)\n                        },\n\n                        deleteAccount: function (userId) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                            };\n                            return self.getRequest('/DeleteUser',params)\n                        }\n                    },\n                    bookings: {\n                        getUserBookings: function (userId) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId\n                            };\n                            return self.getRequest('/GetUserBookings',params);\n                        },\n                        getBookingDetailed: function ({bookingId, userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                BookingId: bookingId\n                            };\n                            return self.getRequest('/GetBookingDetail',params);\n                        },\n                        acceptBookingRequest: function ({bookingId, userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                Lender_Id: userId,\n                                BookingId: bookingId,\n                            };\n                            return self.getRequest('/AcceptBookingRequest',params);\n                        },\n                        rejectBookingRequest: function ({bookingId, userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                BookingId: bookingId\n                            };\n                            return self.getRequest('/RejectBookingRequest',params);\n                        },\n                        cancelBookingRequest: function ({bookingId, userId, reason}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                BookingId: bookingId,\n                                Reason: reason,\n                            };\n                            return self.getRequest('/CancelBookingRequest',params)\n                        },\n                        startRental: function ({bookingId, userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                BookingId: bookingId\n                            };\n                            return self.getRequest('/StartRentalBookingRequest',params)\n                        },\n                        endRental: function ({bookingId, userId}) {\n                            let params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                BookingId: bookingId\n                            };\n                            return self.getRequest('/EndRentalBookingRequest',params)\n                        },\n                        bookProduct: function ({\n                                                   stripeEmail,\n                                                   borrowerId,\n                                                   lenderId,\n                                                   productId,\n                                                   startDate,\n                                                   endDate,\n                                                   noOfDays,\n                                                   coupon,\n                                                   stripeCustomerId,\n                                                   isSaveCard,\n                                                   idVerified,\n                                                   isPickUp,\n                                                   deliveryLat,\n                                                   deliveryLng,\n                                                   deliveryAddress,\n                                                   deliveryName,\n                                                   deliveryPhone,\n                                                   deliveryBell,\n                                                   isTryAndBuy\n                                               }) {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                Stripe_Email: stripeEmail,\n                                Borrower_UserId: borrowerId,\n                                Lender_UserId: lenderId,\n\n                                Product_Id: productId,\n                                StartDate: startDate,\n                                EndDate: endDate,\n                                NoOfDays: noOfDays,\n\n                                CouponNumber: coupon,\n                                CustomerAccountId: stripeCustomerId,\n                                SaveCard: isSaveCard,\n\n                                IdVerfied: idVerified,\n                                Booking_PickupProduct: isPickUp,\n\n                                Delivery_Latitude: deliveryLat,\n                                Delivery_Longitude: deliveryLng,\n                                Delivery_Address: deliveryAddress,\n                                Complete_Borrower_Name: deliveryName,\n                                Phone_Number: deliveryPhone,\n                                House_Name: deliveryBell\n                            };\n\n                            return self.postRequest(isTryAndBuy ? '/BookTryAndBuyProduct' : '/BookProduct',dataObj);\n\n                        }\n                    },\n                    payments: {\n                        createUserStripeAccount: function ({userId, bookingId, email, country}) {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                Booking_Id: bookingId,\n                                User_Email: email,\n                                User_Country: country,\n\n                            };\n                            return self.postRequest(`/CreateBookingStripeAccount`,dataObj)\n                        },\n                        verifyCoupon: function ({coupon, userId}) {\n                            const params = {\n                                ...self.getDefaultParams(),\n                                Coupon: coupon,\n                                User_Id: userId,\n                            };\n                            return self.getRequest(`/VerifyCoupon`, params);\n                        },\n                        createStripeCustomer: function ({email, cardToken}) {\n                            // Somebody, very smart, switched the values of token and email in the server -_- so I flipped them here as well\n                            // Email field is used as token and vice versa\n                            const params = {\n                                ...self.getDefaultParams(),\n                                Email: cardToken,\n                                TokenId: email\n                            };\n                            return self.getRequest('/CreateStripeCustomer',params);\n                        }\n                    },\n                    purchase: {\n                        buyProduct: function ({\n                            stripeEmail,\n                            bookingId,\n                            purchaseAmount,\n                            borrowerId,\n                            lenderId,\n                            productId,\n                            stripeCustomerId,\n                            isSaveCard,\n                            isPickUp,\n                            deliveryLat,\n                            deliveryLng,\n                            deliveryAddress,\n                            deliveryName,\n                            deliveryPhone,\n                            deliveryBell\n                        }) {\n                        const dataObj = {\n                            ...self.getDefaultParams(),\n                            Stripe_Email: stripeEmail,\n                            Borrower_UserId: borrowerId,\n                            Lender_UserId: lenderId,\n                            Stripe_Amount: purchaseAmount, \n\n                            Product_Id: productId,\n                            Booking_Id: bookingId,\n\n                            CustomerAccountId: stripeCustomerId,\n                            SaveCard: isSaveCard,\n\n                            Booking_PickupProduct: isPickUp,\n\n                            Delivery_Latitude: deliveryLat,\n                            Delivery_Longitude: deliveryLng,\n                            Delivery_Address: deliveryAddress,\n                            Complete_Borrower_Name: deliveryName,\n                            Phone_Number: deliveryPhone,\n                            House_Name: deliveryBell\n                        };\n\n                        return self.postRequest('/BuyProduct',dataObj);\n\n                        }\n                    },\n                    verification: {\n                        uploadPassport: ({passportImage,selfie,userId}) => {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                PassPort: passportImage,\n                                User_Selfie: selfie,\n                                User_Id: userId,\n                            };\n                            return self.postRequest('/IDVerficationDocument',dataObj);\n                        },\n                        sendToManualVerification: (data) => {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                PassPort: data.passportImage,\n                                User_Id: data.userId,\n                                NICFront: data.NICDLFront,\n                                NICBack: data.NICDLBack,\n                                User_Selfie: data.selfie,\n                                BookingId: data.bookingId\n                            };\n                            return self.postRequest('/IDManualVerficationDocument',dataObj);\n                        },\n                        uploadNICDL: ({NICDLFront,NICDLBack,selfie,userId}) => {\n                            const dataObj = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                NICFront: NICDLFront,\n                                NICBack: NICDLBack,\n                                User_Selfie: selfie,\n                            };\n                            return self.postRequest('/IDVerficationDocument',dataObj);\n                        }\n                    },\n                    chats: {\n                        getChatsList: ({userId, pageIndex = 0}) => {\n                            const params = {\n                                ...self.getDefaultParams(),\n                                User_Id: userId,\n                                PageIndex: pageIndex,\n                            };\n                            return self.getRequest('/GetChatList',params)\n                        },\n                        getChatDetailed: ({chatId}) => {\n                            const params = {\n                                ...self.getDefaultParams(),\n                                Chat_Id: chatId,\n                                ChatDone: 0,\n                            };\n                            return self.getRequest('/GetChatDetail',params)\n                        },\n                        getChatByQBId: ({chatQbId}) => {\n                            const params = {\n                                ...self.getDefaultParams(),\n                                Chat_QBRoomId: chatQbId,\n                                ChatDone: 0,\n                            };\n                            return self.getRequest('/GetChatInfoByQBId',params);\n                        },\n                        startBookingChat: ({\n                                               lenderId,\n                                               borrowerId,\n                                               productId,\n                                               chatRoomId = null,\n                                               bookingId = null }) => {\n\n                            let dataObj = {\n                                ...self.getDefaultParams(),\n                                User_UDIDType: 3,\n                                Lender_Id: lenderId,\n                                Borrower_Id: borrowerId,\n                                Product_Id: productId,\n                                BookingId: bookingId,\n                                Chat_QBRoomId: chatRoomId,\n                            };\n                            return self.postRequest('/StartBookingChat',dataObj)\n                        }\n                    }\n            };\n\n            return self.apiMethods;\n        }]);\n\n// angular.module('paladinApp')\n// .config(['$translateProvider', function($translateProvider) {\n// \t$translateProvider\n// \t.useStaticFilesLoader({\n// \t    prefix: '/translations/',\n// \t    suffix: '.json'\n// \t})\n// \t.preferredLanguage('it');\n// \t/*.useLocalStorage()\n//   \t.useMissingTranslationHandlerLog()*/\n// }]);\n//\n\nangular.module('paladinApp')\n    .factory('ngTranslateErrorHandler', ['ptLog',function (ptLog) {\n        // has to return a function which gets a tranlation ID\n        return function (translationID,uses) {\n            // do something with dep1 and dep2\n            ptLog.warn(`Translation for key \"${translationID}\" not found when using: ${uses}, using key instead`);\n            return translationID;\n        };\n    }]);\nangular.module('paladinApp')\n    .config(['$translateProvider', function($translateProvider) {\n        $translateProvider\n            .useStaticFilesLoader({\n                prefix: '/translations/locale-',\n                suffix: '.json'\n            }).preferredLanguage(localStorage.getItem('PT_LSK_preferredLanguage') || 'it')\n            .useMissingTranslationHandler('ngTranslateErrorHandler')\n            // .useMissingTranslationHandlerLog()\n            .useSanitizeValueStrategy('escapeParameters');\n\n\n    }]);\nangular.module('paladinApp')\n    .factory('Filters', ['$http','$base64','$rootScope','$q',\n  function ($http,$base64,$rootScope,$q) {\n\n  var Filters = {};\n\n  Filters.getHeaders = function(){\n    var headers = {\n        //\"Authorization\": \"Basic \" + auth,\n        'Access-Control-Allow-Origin': '*',\n        'X-Requested' : null,\n        'Content-Type' : 'application/json; charset=utf-8'\n    };\n\n    return headers;\n  };\n\n  Filters.get = function(languageCode,callback) {\n    \n    if ($rootScope.categoriesMap && $rootScope.categoriesMap.get(languageCode)) {\n      return;\n    }\n\n    var payload = {\n       // headers: this.getHeaders()\n    };\n\n    $http.get( window.globals.API_URL + 'GetCategories?LanguageCode='+this.formatLanguageCode(languageCode)).then(callback);\n   \n  };\n\n\n\n  Filters.getCategoryById = function(id, lang) {\n    if ($rootScope.categoriesMap && $rootScope.categoriesMap.get(lang)) {\n      var categories = $rootScope.categoriesMap.get(lang);\n      for (var i=0;i<categories.length;i++) {\n        if (categories[i].Category_Id == id) {\n          return categories[i];\n        }\n      }\n    } \n    //console.error(\"Filters.getCategoryById: \"+ id + \",\"+lang+\" $rootScope.categoriesMap not defined or null\")\n  }\n  \n\n\n  Filters.getSubcategoryById = function(id, lang) {\n  \n    if ($rootScope.categoriesMap && $rootScope.categoriesMap.get(lang)) {\n      var categories = $rootScope.categoriesMap.get(lang);\n      for (var i=0;i<categories.length;i++) {\n        for (var j=0; j<categories[i].Category_SubCatrgories.length; j++) {\n          if (categories[i].Category_SubCatrgories[j].SubCategory_Id == id) {\n            return categories[i].Category_SubCatrgories[j];\n          }\n        }\n      }\n    } \n    //console.error(\"Filters.getSubcategoryById: \"+ id + \",\"+lang+\" $rootScope.categoriesMap not defined or null\")    \n  };\n\n  Filters.getCategoryByName = function(name, lang, isTryAndBuy) {\n    if ($rootScope.categoriesMap && $rootScope.categoriesMap.get(lang)) {\n      var categories = $rootScope.categoriesMap.get(lang);\n      for (var i=0;i<categories.length;i++) {\n        if (isTryAndBuy == categories[i].IsTryAndBuy && categories[i].Category_Name && (categories[i].Category_Name.toLowerCase().replace(/ /g,'-') == name.toLowerCase())) {\n          return categories[i];\n        }\n      }\n    } \n    //console.error(\"Filters.getCategoryByName: \"+ name + \",\"+lang+\" $rootScope.categoriesMap not defined or null\");\n  }\n\n  Filters.getSubcategoryByName = function(name, lang) {\n    \n      if ($rootScope.categoriesMap && $rootScope.categoriesMap.get(lang)) {\n        var categories = $rootScope.categoriesMap.get(lang);\n        for (var i=0;i<categories.length;i++) {\n          for (var j=0; j<categories[i].Category_SubCatrgories.length; j++) {\n            if (categories[i].Category_SubCatrgories[j].SubCategory_Name &&\n              categories[i].Category_SubCatrgories[j].SubCategory_Name.toLowerCase().replace(/ /g,'-') == name.toLowerCase()) {\n              return categories[i].Category_SubCatrgories[j];\n            }\n          }\n        }\n      } \n      //console.error(\"Filters.getSubcategoryByName: \"+ name + \",\"+lang+\" $rootScope.categoriesMap not defined or null\");\n    }\n\n\n  Filters.findByName = function(name,languageCode,callback){\n    var payload = {\n        headers: this.getHeaders()\n    };\n\n    $http.get(window.globals.API_URL  + 'GetCategories?LanguageCode='+this.formatLanguageCode(languageCode)).then(function(response){\n      var categories = response.data.Data;\n      for(var i=0;i<categories.length;i++){\n        var category = categories[i];\n        if(category.Category_Name && (category.Category_Name.toLowerCase().replace(/ /g,'-') == name.toLowerCase()) ){\n          callback(category);\n          return;\n        }\n      }\n      callback(null);\n    });\n  }\n\n  Filters.getSuggestions = function(keywords, languageCode) {\n    return $http.get(window.globals.API_URL + 'Suggestion?Keyword='+keywords+'&&LanguageCode='+this.formatLanguageCode(languageCode)).then(function(response) {\n      return response.data.Data.map(function(item){\n          return item.Keyword;\n        })\n    });\n  }\n\n\n  Filters.getCategoriesUrl = (categoryName, subcategoryName, isTryAndBuy, languageCode) => {\n    let path = window.globals.ROOT_PATH + languageCode + \"/categorie/\" + (isTryAndBuy ? '' : \"privato/\");\n    if (subcategoryName == null) {\n      path = path + categoryName;\n    } else {\n      path = path + categoryName + \"/\" + subcategoryName + (filter.glCity? \"/\" + filter.glCity : '');\n    }\n\n    return path.split(' ').join('-');;\n  }\n\n\n\n  Filters.formatLanguageCode = function(code){\n    return code=='it'?'it-IT':code;\n  }\n\n \n  return Filters;\n}]);\n\nangular.module('paladinApp')\n    .factory('Products', ['$http','$base64','enums', function ($http,$base64,enums) {\n  var Products = {};\n\n  Products.getHeaders = function(){\n    var headers = {\n        //\"Authorization\": \"Basic \" + auth,\n        'Access-Control-Allow-Origin': '*',\n        'X-Requested' : null,\n        'Content-Type' : 'application/json; charset=utf-8'\n    };\n\n    return headers;\n  }\n\n  Products.getAll = function(filters) {\n    \n    if(!filters.languageCode)filters.languageCode='it-IT';\n\n    var payload = {\n        //headers: this.getHeaders()\n    };\n\n    //console.log(\"-----GET SEARCHED PRODUCTS: \");\n    //console.log(this.searchProductParam(filters));\n   return $http.get( window.globals.API_URL  + 'GetSearchedProduct?'+this.searchProductParam(filters))\n  };\n\n  Products.getTotalPageCount = function(filters) {\n    \n    if(!filters.languageCode)filters.languageCode='en';\n\n    var payload = {\n        headers: this.getHeaders()\n    };\n    //console.log(\"-----GET PAGE COUNT----\");\n    //console.log(window.globals.API_URL  + 'GetPageCount?'+this.searchProductParam(filters));\n\n    return $http.get( window.globals.API_URL  + 'GetPageCount?'+this.searchProductParam(filters))\n  };\n\n  /*\n  Products.decryptProductURL = function(url) {\n    return url.split('-').join(' ').split('_').join('-').split('^').join('/').split('__').join('_');\n  }\n  */\n\n  Products.encryptProductURL = function(productName) {\n    return productName.trim().split(' ').join('-').split('/').join('-');\n  }\n\n  Products.getDetail = function(productId,languageCode,callback) {\n    var payload = {\n        headers: this.getHeaders()\n    };\n\n    if(!languageCode)LanguageCode='en';\n\n    //console.log(\"-----GET PRODUCT DETAIL API----\");\n    //console.log(window.globals.API_URL  + 'GetProductDetail?User_Id=0&Product_Title='\n    //+encodeURIComponent(Products.decryptProductURL(productId)));\n\n    \n\n    if(!isNaN(productId)){\n      $http.get(window.globals.API_URL  + 'GetProductDetail?User_Id=0&Product_Id='+productId).then(callback);\n    }else{\n      $http.get(window.globals.API_URL  + 'GetProductDetail?User_Id=0&Product_Title='+encodeURIComponent(Products.decryptProductURL(productId))).then(callback);\n    }\n\n  };\n\n  Products.formatLanguageCode = function(code){\n    return code=='it'?'it-IT':code;\n  };\n\n  Products.searchProductParam = function(json){\n    var _this = this;\n    var keys = Object.keys(json);\n    var paramStr = '';\n    for(var i=0;i<keys.length;i++){\n      var k = keys[i];\n      var val = json[k] ;\n      if(k == 'languageCode' && val){\n        paramStr+= 'LanguageCode' + '=' + encodeURIComponent(this.formatLanguageCode(val)); \n      }else if(k == 'category' && val){\n        if(val.selectedCategoryId){\n          paramStr+= 'Category_Id' + '=' + encodeURIComponent(val.selectedCategoryId); \n        }\n        if(val.selectedSubCategoryId){\n          paramStr+= '&SubCategory_Id' + '=' + encodeURIComponent(val.selectedSubCategoryId); \n        }\n        if(val.isTryAndBuy != undefined){\n          paramStr+=paramStr[paramStr.length-1] == '&' ? \n            'isTryAndBuy=' + encodeURIComponent(val.isTryAndBuy) :\n            '&isTryAndBuy=' + encodeURIComponent(val.isTryAndBuy);\n        }\n      }else if(k == 'sortBy' && val){\n        \n        if(val=='SortByPopularity'){\n          paramStr+='SortByPopularity' + '=true' ; \n        }else if(val=='SortByRecent'){\n          paramStr+='SortByRecent' + '=true' ; \n        }else if(val=='SortByGeoLocation'){\n          paramStr+='SortByGeoLocation' + '=true' ; \n        }else if(val=='SortByLowPrice'){\n          paramStr+='SortByLowPrice' + '=true' ; \n        }else if(val=='SortByHighPrice'){\n          paramStr+='SortByHighPrice' + '=true' ; \n        }else if(val=='SortByBestProduct'){\n          paramStr+='SortByBestProduct' + '=true' ; \n        }\n\n      }else if(k == 'priceRange' && val){\n        var minPrice = val[0];\n        var maxPrice = val[1];\n        paramStr+= 'MinPriceRange' + '=' + encodeURIComponent(minPrice)+'&'+'MaxPriceRange'+'='+encodeURIComponent(maxPrice); \n      }else if(k == 'currentPage' && val){\n        paramStr+= 'PageIndex' + '=' + encodeURIComponent(val-1); \n      }else if(k == 'search' && val){\n\n        var finalStr = ''; \n        if(val.searchStr){\n          finalStr+='KeywordProduct' + '=' + encodeURIComponent(val.searchStr); \n          if(val.lat)finalStr+='&';\n        }\n        \n        //we only need to send lat long for sort = nearest\n        if(val.lat && json.sortByCode == enums.productsSortByTextCode.SortByGeoLocation){\n          finalStr+='Latitude' + '=' +encodeURIComponent(val.lat); \n          if(val.lng)finalStr+='&';\n        }\n        if(val.lng && json.sortByCode == enums.productsSortByTextCode.SortByGeoLocation){\n          finalStr+='Longitude' + '=' +encodeURIComponent(val.lng); \n        }\n        paramStr+= finalStr;\n      }else if(k == 'distanceRange' && val && json.sortByCode == enums.productsSortByTextCode.SortByGeoLocation){\n        var maxDistance = val;\n        if(maxDistance<=50)paramStr+= 'Range' + '=' + encodeURIComponent(maxDistance); \n      }else if(k == 'currentPage' && val){\n        paramStr+='PageIndex='+(val-1);    \n      }\n\n      if(i<(keys.length-1) && paramStr && paramStr.slice(-1) !='&'){\n\n        paramStr+='&';\n      }\n      \n    }\n\n    \n    if(paramStr.endsWith('&')){\n      paramStr = paramStr.substring(0,paramStr.length-1)\n    }\n    \n    paramStr+='&isWeb=true';\n    return paramStr;\n  };\n\n  \n  return Products;\n}]);\nangular.module('paladinApp')\n    .service('productReviewService', [\n        '$state',\n        '$stateParams',\n        '$window',\n        'enums',\n        'apiService',\n        function (\n            $state,\n            $stateParams,\n            $window,\n            enums,\n            apiService\n        ) {\n\n            let self = this;\n\n            // save ref to the booking to be reviewed\n            self.booking = null;\n\n            const startReviewFlow = (booking, isLender) => {\n                self.booking = booking;\n                $state.go('app.products.productReview', {bookingId: booking.Booking_Id});\n            };\n\n            const leaveProductReviewPage = (toState = null) => {\n                $window.history.back();\n            };\n\n            const submitTransactionReview = (params) => {\n                apiService.reviews.submitTransactionReview(params)\n                    .then((result)=>{\n                        toastService.simpleToast($translate.instant('REVIEW_ADDED_SUCCESSFULLY'));\n                    });\n            };\n\n            const getBookingToReview = () => {\n                return self.booking;\n            };\n\n            return {\n                startReviewFlow,\n                leaveProductReviewPage,\n                submitTransactionReview,\n                getBookingToReview\n            }\n        }]);\n\nangular.module('paladinApp')\n    .factory('pager', ['$rootScope', '$location', function($rootScope, $location) {\n  var pagerService = {};\n\n  // service implementation\n  pagerService.GetPager =function(totalPages, currentPage, pageSize) {\n      // default to first page\n      currentPage = currentPage || 1;\n\n      // default page size is 10\n      pageSize = pageSize || 10;\n\n      // calculate total pages\n      //var totalPages = Math.ceil(totalItems / pageSize);\n      var totalItems = totalPages*pageSize;\n      var startPage, endPage;\n      if (totalPages <= 10) {\n          // less than 10 total pages so show all\n          startPage = 1;\n          endPage = totalPages;\n      } else {\n          // more than 10 total pages so calculate start and end pages\n          if (currentPage <= 6) {\n              startPage = 1;\n              endPage = 10;\n          } else if (currentPage + 4 >= totalPages) {\n              startPage = totalPages - 9;\n              endPage = totalPages;\n          } else {\n              startPage = currentPage - 5;\n              endPage = currentPage + 4;\n          }\n      }\n\n      // calculate start and end item indexes\n      var startIndex = (currentPage - 1) * pageSize;\n      var endIndex = Math.min(startIndex + pageSize - 1, totalItems - 1);\n\n      // create an array of pages to ng-repeat in the pager control\n      var pages = _.range(startPage, endPage + 1);\n\n      // return object with all pager properties required by the view\n      return {\n          totalItems: totalItems,\n          currentPage: currentPage,\n          pageSize: pageSize,\n          totalPages: totalPages,\n          startPage: startPage,\n          endPage: endPage,\n          startIndex: startIndex,\n          endIndex: endIndex,\n          pages: pages\n      };\n  };\n\n  return pagerService;\n}]);\nangular.module('paladinApp')\n.service('appStateManager', ['enums','$base64',function (enums,$base64) {\n    /// Filled from server and localStorage\n    let appState = {\n        currentLang: localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it',\n        getCurrentLang: () => appState.currentLang == 'it' ? 'it-IT' : appState.currentLang,\n        user: null,\n        chatUser: null,\n        getUserId: () => {\n            let userId;\n            const hash = localStorage.getItem(enums.localStorageKeys.userId);\n            userId = $base64.decode(hash).split(':')[1] || undefined;\n            return userId;\n        },\n        location: null, // Filled from geoLocation service -> dataService\n        categoriesDict: null,\n    };\n\n    return appState;\n}]);\nangular.module('paladinApp')\n    .service('dataService',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        '$translate',\n        'ptLog',\n        '$base64',\n        'apiService',\n        '$state',\n        'popupService',\n        '$timeout',\n        'geoLocationService',\n        'chatService',\n        '$interval',\n        'ngMeta',\n        '$location',\n        function (\n            $rootScope,\n            enums,\n            appStateManager,\n            $translate,\n            ptLog,\n            $base64,\n            apiService,\n            $state,\n            popupService,\n            $timeout,\n            geoLocationService,\n            chatService,\n            $interval,\n            ngMeta,\n            $location) {\n        const TAG = 'dataService || ';\n        let didInit = false;\n        const init = function () {\n            if (!didInit) {\n                didInit = true;\n                registerBus();\n            }\n\n            $translate.preferredLanguage(localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it');\n\n\n            /// Load user if exists\n            if (getUserId()) {\n                getMe();\n            }\n\n            // getCategories();\n\n            //geoLocationUpdate();\n            // geoLocationUpdateInterval();\n        };\n\n        const registerBus = () => {\n            $rootScope.$on(enums.busEvents.userLogin, (event, data) => {\n                let {\n                    oAuthToken,\n                } = data;\n                setTokens(oAuthToken);\n                setUserId(data.User_Id);\n                getMe();\n\n            });\n\n            $rootScope.$on(enums.busEvents.userSignup, (event, data) => {\n\n            });\n\n            $rootScope.$on(enums.busEvents.tokenRefresh,(event,data) => {\n                setTokens(data)\n            });\n\n            $rootScope.$on(enums.busEvents.preferredLanguageChange, (event, data) => {\n                localStorage.setItem(enums.localStorageKeys.preferredLanguage, data.currentLang);\n                appStateManager.currentLang = data.currentLang;\n                $translate.preferredLanguage(data.currentLang);\n                $translate.use(data.currentLang);\n                $translate.refresh();\n                const newPath = location.pathname.replace(location.pathname.split('/')[1],data.currentLang);\n                location.replace(newPath)\n            });\n\n            $rootScope.$on(enums.busEvents.userLogout,(event) => {\n                chatService.disconnectChat();\n                localStorage.clear();\n                localStorage.setItem(enums.localStorageKeys.preferredLanguage,appStateManager.currentLang);\n                (false);\n                appStateManager.user = null;\n                $rootScope.$emit(enums.busEvents.updatedUser,null);\n                $state.go('app.home',{languageCode:appStateManager.currentLang});\n\n            });\n\n\n            $rootScope.$on(enums.busEvents.triggerEmailValidation,(event,data) => {\n                popupService.showEmailVerification(data.userId)\n                    .then(() => {\n                        $state.go('app.home')\n                    })\n                    .catch(() =>{\n                        $state.go('app.home')\n                    })\n            });\n            $rootScope.$on('$destroy', () => {\n                console.log('ROOT SCOPE IS DEAD')\n            })\n        };\n\n        const geoLocationUpdate = () => {\n            return new Promise((resolve, reject) => {\n                ptLog.log(TAG, 'Starting location update');\n                geoLocationService.getLocation()\n                    .then((location) => {\n                        updateGeoLocationStorage(location);\n                        ptLog.log('Successfully got location');\n                        resolve(location);\n                    })\n                    .catch((err) => {\n                        ptLog.error(TAG, 'error getting location', JSON.stringify(err));\n                        reject(err);\n                    })\n            })\n        };\n\n        const geoLocationUpdateInterval = () => {\n            $timeout(() => {\n                geoLocationUpdate()\n                    .finally(() => {\n                        geoLocationUpdateInterval();\n                    })\n            }, 10 * 1000)\n        };\n\n        const getGeoLocationForApp = () => {\n            return new Promise((resolve,reject) => {\n                if (appStateManager.location) {\n                    resolve(appStateManager.location);\n                } else if (localStorage.getItem(enums.localStorageKeys.locationLatLong)) {\n                    const {lat, lng} = JSON.parse(localStorage.getItem(enums.localStorageKeys.locationLatLong));\n                    resolve({\n                        lat,\n                        lng\n                    })\n                } else {\n                    geoLocationUpdate()\n                        .then((location) => {\n                            const lat = location.geometry.location.lat(),\n                                lng = location.geometry.location.lng();\n                            resolve({\n                                lat,\n                                lng\n                            })\n                        })\n                        .catch(reject)\n                }\n            })\n\n        };\n\n        const updateGeoLocationStorage = (location) => {\n            appStateManager.location = location;\n            const latLong = {\n                lat: location.geometry.location.lat(),\n                lng: location.geometry.location.lng()\n            };\n            localStorage.setItem(enums.localStorageKeys.locationLatLong,JSON.stringify(latLong));\n            $rootScope.$emit(enums.busEvents.locationUpdate,latLong);\n        };\n\n        const getLatLong = () => {\n            return new Promise((resolve,reject) => {\n                const latLngStr = localStorage.getItem(enums.localStorageKeys.locationLatLong);\n                if (!latLngStr) {\n                    geoLocationUpdate()\n                        .then(() => {\n                            getLatLong().then(resolve).catch(reject)\n                        })\n                        .catch(reject)\n                } else {\n                    resolve(JSON.parse(latLngStr))\n                }\n            })\n        };\n\n        const setUserId = (userId) => {\n            localStorage.setItem(enums.localStorageKeys.userId,$base64.encode(`${enums.secret}:${userId}`));\n        };\n\n        const setTokens = (oAuthToken) => {\n            if (oAuthToken && oAuthToken.access_token && oAuthToken.token_type && oAuthToken.refresh_token) {\n                localStorage.setItem(enums.localStorageKeys.jwtToken,`${oAuthToken.token_type} ${oAuthToken.access_token}`);\n                localStorage.setItem(enums.localStorageKeys.refreshToken, oAuthToken.refresh_token)\n            } else {\n                ptLog.error(TAG,'Sign up successful but access token was not provided!');\n            }\n        };\n\n        const getUserId = () => {\n            return appStateManager.getUserId()\n        };\n\n        let messagesPollerInterval = undefined;\n        const messagesPoller = (isStart) => {\n                if (isStart) {\n                    if (messagesPollerInterval) {\n                        return new Error('message poller already active');\n                    }\n                    messagesPollerInterval = $interval(getUnreadMessages,30 * 1000);\n                } else {\n                    if (!messagesPollerInterval) {\n                        return new Error('message poller already deactivated');\n                    }\n                    $interval.cancel(messagesPollerInterval);\n                    messagesPollerInterval = undefined;\n                }\n        };\n\n        const getUnreadMessages = () => {\n            chatService.syncDialogList()\n                .then((dialogsDict) => {\n                    console.log(dialogsDict);\n                    let nummberOfUnreadMessages = 0;\n                    Object.keys(dialogsDict)\n                        .forEach((dialog) => {\n                            nummberOfUnreadMessages += dialogsDict[dialog];\n                        });\n\n                    $rootScope.$emit(enums.busChatEvents.updateUnreadCount,{\n                        total: nummberOfUnreadMessages,\n                        detailedDict: dialogsDict,\n                    });\n\n                })\n                .catch((err) => {\n                    if (err.code == 404) { // no chats, no messages\n                        $rootScope.$emit(enums.busChatEvents.updateUnreadCount,{\n                            total: 0,\n                            detailedDict: {},\n                        });\n                    } else  {\n                        ptLog.error(err)\n                    }\n                })\n        };\n\n        const getCategories = () => {\n            apiService.categories.getCategories()\n                .then((response) => {\n                    let catDict = {};\n\n                    response.Data.forEach((item) => catDict[item.Category_Id] = item);\n                    appStateManager.categoriesDict = catDict;\n                    $rootScope.$emit(enums.busEvents.categoriesUpdate,catDict);\n                })\n                .catch((err) => {\n                    ptLog.error(err);\n                })\n        };\n\n        const getMe = () => {\n            const userId = getUserId();\n            if (userId) {\n                apiService.users.getUserProfile({userId})\n                    .then((response) => {\n                        appStateManager.user = response.Data;\n                        ptLog.log(TAG,'Fetched user profile');\n                        $rootScope.$emit(enums.busEvents.updatedUser,appStateManager.user);\n                        activatePendingPrivateState();\n                        chatService.loginToChat()\n                            .then(() => {\n                                chatService.connectToChat()\n                                    .then(() => {\n                                        chatService.syncDialogList();\n                                        messagesPoller(true);\n                                    })\n                                    .catch((err) => {\n                                        console.error('Could not connect to chat',JSON.stringify(err));\n                                    })\n                            })\n                    })\n                    .catch((err) => {\n                        ptLog.error(TAG,JSON.stringify(err));\n                    })\n            } else {\n                ptLog.log(TAG,'User Id not found');\n            }\n        };\n\n\n        const forceLogin = (transition) => {\n            const nexState = transition.targetState();\n            let stateObjToSave = {\n                name: nexState.identifier().name,\n                params: nexState.params(),\n                options: nexState.options().current(),\n            };\n            setPendingPrivateState(stateObjToSave);\n            popupService.showLoginSignupPopup(false)\n                .catch((err) => {\n                    // User decided not to login, delete saved state\n                    setPendingPrivateState(null);\n                })\n\n        };\n\n        const updateGeneralSEO = () => {\n            const languageCode = appStateManager.currentLang;\n            window.globals.SUPPORTED_LANGS.forEach((item) => {\n               ngMeta.setTag(enums.ngMetaValues.currentUrl(item.code),$location.absUrl().replace(`/${languageCode}/`,`/${item.code}/`));\n            });\n        };\n\n        const setPendingPrivateState = (state) => {\n                if (state) {\n                    const encodedState = $base64.encode(`${enums.secret}|:${JSON.stringify(state)}`);\n                    localStorage.setItem(enums.localStorageKeys.pendingPrivateState,encodedState);\n                } else {\n                    localStorage.removeItem(enums.localStorageKeys.pendingPrivateState)\n                }\n        };\n\n        const activatePendingPrivateState = () => {\n            const encodedState = localStorage.getItem(enums.localStorageKeys.pendingPrivateState);\n            if (encodedState) {\n                const targetState = JSON.parse($base64.decode(encodedState).split('|:')[1]);\n                if (targetState) {\n                    setPendingPrivateState(null);\n                    $state.go(targetState.name,targetState.params,targetState.options);\n                }\n            }\n        };\n\n        return {\n            init,\n            setUserId,\n            getUserId,\n            getCategories,\n            getGeoLocationForApp,\n            forceLogin,\n            updateGeneralSEO,\n        }\n}]);\nangular.module('paladinApp')\n    .service('menusService',[\n        '$rootScope',\n        'appStateManager',\n        '$translate',\n        'popupService',\n        '$mdToast',\n        '$state',\n        'enums',\n        'ZendeskWidget',\n        function ($rootScope,\n                  appStateManager,\n                  $translate,\n                  popupService,\n                  $mdToast,\n                  $state,\n                  enums,\n                  ZendeskWidget) {\n\n        /**\n         *\n         About:\n         How it works\n         Try & Buy\n         Blog\n         FAQ\n         Account (logged in):\n         My profile\n         My Listings\n         My Rentals\n         Log out\n         Account (logged out)\n         Log in\n         Sign up\n         Links:\n         Contact us\n         Terms and Conditions   (not showing in header)  route to paladintrue.com/terms-and-conditions/\n         */\n\n            /**\n             *\n             * @type {{aboutMenu: {title: string, list: *[]}, accountLoggedOut: {title: string, shouldHide: function(), list: *[]}, accountLoggedIn: {title: string, shouldHide: function(), list: *[]}, linksMenu: {title: string, list: *[]}, common: {title: string, list: *[]}}}\n             */\n        const commonMenus = {\n            aboutMenu: {\n                title: 'ABOUT',\n                list:[\n                    // {\n                    //     itemId:'menu-item-how-it-works',\n                    //     title: 'HOW_IT_WORKS', // $translate directive\n                    //     link:`https://paladintrue.com/${appStateManager.currentLang}/how-it-works/`\n                    // },\n                    {\n                        itemId:'menu-item-try-n-buy',\n                        title: 'TRY_AND_BUY',\n                        link: `https://paladintrue.com/${appStateManager.currentLang}/${window.globals.SUPPORTED_LANGS.find((lang) => appStateManager.currentLang == lang.code).tryAndBuyWordPressPath}/`,\n                    },\n                    {\n                        itemId:'menu-item-blog',\n                        title: 'BLOG',\n                        link:`https://paladintrue.com/${appStateManager.currentLang}/blog/`\n                    },\n                    {\n                        itemId:'menu-item-faq',\n                        title: 'FAQ',\n                        link:`https://paladintrue.com/${appStateManager.currentLang}/faq/`\n                    }\n                ]\n            },\n            accountLoggedOut: {\n                title: 'HEADER_MY_ACCOUNT',\n                shouldHide: () => {\n                    return (appStateManager.user != null)\n                },\n                list: [\n                    {\n                        itemId:'menu-item-login',\n                        title: 'HEADER_LOGIN',\n                        BL: () => popupService.showLoginSignupPopup(false),\n                    },\n                    {\n                        itemId: 'menu-item-signup',\n                        title: 'HEADER_SIGNUP',\n                        BL: () => popupService.showLoginSignupPopup(true),\n                    }\n                ]\n            },\n            accountLoggedIn: {\n                title: 'HEADER_MY_ACCOUNT',\n                shouldHide: () => {\n                    return (appStateManager.user == null)\n                },\n                list: [\n                    {\n                        itemId:'menu-item-my-profile',\n                        title: 'MY_PROFILE',\n                        BL: () => {\n                            $rootScope.$emit(enums.busNavigation.userProfile, {userId: appStateManager.user.User_Id})\n                        },\n                    },\n                    // {\n                    //     itemId: 'menu-item-my-rentals',\n                    //     title: 'MY_RENTAL',\n                    //     BL: () => $rootScope.$emit(enums.busNavigation.rentals),\n                    // },\n                    {\n                        itemId: 'menu-item-message',\n                        title: 'MESSAGES',\n                        BL: () => $rootScope.$emit(enums.busNavigation.chat),\n                    },\n                    {\n                        itemId: 'menu-item-logout',\n                        title: 'HEADER_LOGOUT',\n                        BL: () => $rootScope.$emit(enums.busEvents.userLogout),\n                    }\n                ]\n            },\n            linksMenu: {\n                title: 'LINKS',\n                list:\n                    [\n                        {\n                            itemId: 'menu-item-contact',\n                            title:'CONTACT',\n                            //link:`https://paladintrue.com/${appStateManager.currentLang}/contact/`\n                            link: $translate.instant(\"URL_CONTACT\")\n                        },\n                        {\n                            itemId: 'menu-item-terms-n-conditions',\n                            title: 'TANDC',\n                            link: `https://paladintrue.com/${appStateManager.currentLang}/terms-and-conditions/`\n                        },\n                        {\n                            itemId: 'menu-item-privacy-policy',\n                            title: 'PRIVACY_POLICY',\n                            link: `https://paladintrue.com/${appStateManager.currentLang}/privacy-policy/`\n                        },\n                        {\n                            itemId: 'menu-item-help-support',\n                            title: 'SUPPORT',\n                            BL: () => {\n                                ZendeskWidget.activate();\n                            }\n                        }\n                    ]\n            },\n            common: {\n                title: '', // no title\n                list: [\n                    {\n                        itemId:'menu-item-browse',\n                        title: 'BORROW',\n                        BL: () => $state.go('app.browse'),\n                        link: window.globals.ROOT_PATH + appStateManager.currentLang + \"/categorie/\"+ (appStateManager.currentLang == 'it'? \"Tutte-le-Categorie\" : \"All-Categories\")+ \"?sortBy=SortByBestProduct&pageIndex=1\",\n                    },\n                    {\n                        itemId: 'menu-item-lend',\n                        title: 'LEND',\n                        BL: () => {\n                            if (appStateManager.user == null) {\n                                popupService.showLoginSignupPopup(false)\n                            } else {\n                                $rootScope.$emit(enums.busNavigation.userListings);\n                            }\n                        }\n                    },\n                    {\n                        itemId: 'menu-item-my-rentals',\n                        title: 'MY_RENTAL',\n                        BL: () => {\n                            if (appStateManager.user == null) {\n                                popupService.showLoginSignupPopup(false)\n                            } else {\n                                $rootScope.$emit(enums.busNavigation.rentals);\n                            }\n                        }\n                    }\n                ]\n            }\n\n        };\n\n\n        /**\n         *\n         * @param menuItem the clicked menu item\n         *\n         */\n        const menuClickHandlerMethod = (menuItem) => {\n            //bl has prio against link\n            if (menuItem.BL) {\n                menuItem.BL();\n            } else if (menuItem.link) {\n                window.open(menuItem.link,\"_self\");\n            }\n        };\n\n        const shouldShowMenuItem = (menuItem) => {\n            return menuItem.shouldHide == undefined || !menuItem.shouldHide();\n        };\n\n\n        const dummyNavNotImplementedToast = () => {\n            $mdToast.show(\n                $mdToast.simple()\n                    .textContent(`Navigation on menu item not implemented yet`)\n                    .hideDelay(3000)\n            );\n        };\n        return {\n            commonMenus,\n            menuClickHandlerMethod,\n            shouldShowMenuItem,\n        }\n    }]);\nangular.module('paladinApp')\n    .service('geoLocationService',[\n        '$rootScope',\n        'appStateManager',\n        'ptLog',\n        function (\n            $rootScope,\n            appStateManager,\n            ptLog) {\n            const TAG = 'geoLocationService || ';\n            const geocoder = new google.maps.Geocoder();\n\n            const getGeoLocationPostion = () => {\n                return new Promise((resolve,reject) => {\n                    if (navigator.geolocation) {\n                        navigator.geolocation.getCurrentPosition(resolve,reject)//,{timeout: 5 * 1000}) // drop results that take more than five secs\n                    } else {\n                        reject({message: 'goeLocation not supported by browser'})\n                    }\n                })\n            };\n\n            const getLocation = () => {\n                return new Promise((resolve,reject) => {\n                    ptLog.log('GET USER LOCATION');\n                    getGeoLocationPostion()\n                        .then((position => {\n                            let data = {\n                                location: {\n                                    lat:position.coords.latitude,\n                                    lng: position.coords.longitude\n                                }\n                            };\n                            geoCodeLocation(data)\n                                .then((results) => {\n                                    resolve(results)\n                                })\n                                .catch(reject)\n\n                        }))\n                        .catch((err) => {\n                            ptLog.error(TAG, JSON.stringify(err));\n                            ptLog.log(TAG,'Getting default location');\n                            const defaultLoc = getDefaultLocationAddressForLang();\n                            geoCodeLocation(defaultLoc)\n                                .then((results) => {\n                                    resolve(results)\n                                })\n                                .catch(reject)\n                        })\n                })\n            };\n\n\n            const geoCodeLocation = (locData) => {\n                return new Promise((resolve,reject) => {\n                    geocoder.geocode(locData, function (results, status) {\n                        if (results && results.length > 0) {\n                            resolve(results[0])\n                        } else {\n                            reject({status: status})\n                        }\n                    })\n                })\n            };\n\n            const getDefaultLocationAddressForLang = () => {\n                const lang = window.globals.SUPPORTED_LANGS.find((lang) => lang.code === appStateManager.currentLang);\n                return lang ? {address: lang.defaultLocation} : { address: 'milan italy'}\n            };\n\n            const getUserCountryFromUserAddress = (address) => {\n                return new Promise((resolve,reject) => {\n                    geocoder.geocode({address},(results,status) => {\n\n                        if (status == 'OK') {\n\n                            if (results && results.length > 0) {\n                                const {\n                                    address_components\n                                } = results[0];\n\n                                if (address_components && address_components.length > 0) {\n                                    const country = address_components.find((comp) => {\n                                        const { types } = comp;\n                                        if (types && types.length > 0) {\n                                            return types[0].toLowerCase() === 'country';\n                                        } else {\n                                            return false\n                                        }\n                                    });\n\n                                    if (country) {\n                                       resolve(country)\n                                    } else {\n                                        reject(new Error('Country not found'))\n                                    }\n\n                                } else {\n                                    reject(new Error('Address not found'))\n                                }\n\n                            } else {\n                                reject(new Error('No results found'))\n                            }\n\n                        } else {\n                            reject(new Error('Could not geocode address'))\n                        }\n                    })\n                });\n            };\n\n            const getUserAddressFromCoordinates = ({lat,lng}) => {\n                return new Promise((resolve,reject) => {\n                    geocoder.geocode({ location: { lat, lng } },(results,status) => {\n\n                        if (status === 'OK') {\n\n                            if (results && results.length > 0) {\n                                const streetAddress = results.find((res) => {\n                                    const { types } = res;\n                                    if (types && types.length > 0) {\n                                        return types[0].toLowerCase() === 'street_address';\n                                    } else {\n                                        return false\n                                    }\n                                });\n\n                                if (streetAddress) {\n                                    resolve(streetAddress.formatted_address)\n                                } else {\n                                    reject(new Error('Address not found'))\n                                }\n                            } else {\n                                reject(new Error('No results found'))\n                            }\n\n                        } else {\n                            reject(new Error('Could not geocode coordinates'))\n                        }\n                    })\n                });\n            };\n            return {\n                getLocation,\n                getUserCountryFromUserAddress,\n                getUserAddressFromCoordinates\n            }\n        }]);\nangular.module('paladinApp')\n.service('toastService',['$mdToast',function ($mdToast) {\n    this.simpleToast = function (message,delay = 3000, isRight = true) {\n        $mdToast.show(\n            $mdToast.simple()\n                .textContent(message)\n                .hideDelay(delay)\n                .position(isRight ? 'bottom right' : 'bottom left')\n        );\n    }\n}]);\nangular.module('paladinApp')\n    .service('navigationService',[\n        '$rootScope',\n        '$state',\n        'enums',\n        'ptLog',\n        'ptUtils',\n        'toastService',\n        function (\n            $rootScope,\n            $state,\n            enums,\n            ptLog,\n            ptUtils,\n            toastService) {\n            const TAG = 'navigationService ||';\n\n            $rootScope.$on(enums.busNavigation.homePage,() => $state.go('app.home'));\n\n            $rootScope.$on(enums.busNavigation.productDetailed,(event,{product}) => {\n                if (product) {\n                    $state.go('app.products.selectedProduct',{productNameAndId: ptUtils.getProductNameAndId(product)});\n                } else {\n                    ptLog.error(TAG, enums.busNavigation.productDetailed, 'NO PRODUCT');\n                }\n            });\n\n            $rootScope.$on(enums.busNavigation.browseCategory,(event,{categoryId,subCategoryName,categoryName}) => {\n                let obj = {};\n                if (categoryId)\n                    obj.category = categoryId;\n                else if (categoryName)\n                    obj.category = categoryName.replace(/\\ /g,'-');\n\n                if (subCategoryName)\n                    obj.subCategory = subCategoryName.replace(/\\ /g,'-');\n                obj.sortBy = enums.productsSortOptions.bestProduct;\n                obj.isResetSearch = true;\n                $state.go('app.browse',obj);\n            });\n\n            $rootScope.$on(enums.busNavigation.browseKeyword,(event,data) => {\n                $state.go('app.browse',{ search: data.keyword });\n            });\n\n            $rootScope.$on(enums.busNavigation.switchBrowseMode, (event,{isTryAndBuy}) => {\n                if (isTryAndBuy) {\n                    $state.go('app.browse');\n                } else {\n                    $state.go('app.browsePrivate');\n                }\n            });\n\n            $rootScope.$on(enums.busNavigation.browseSort,(event,data) => {\n                $state.go('app.browse',{sortBy:data.sortBy,search:'',isResetSearch: true });\n            });\n\n            $rootScope.$on(enums.busNavigation.userProfile,(event,{ userId, replace }) => {\n               $state.go('app.profiles.publicProfile', { userId }, replace ? {location: 'replace'} : undefined)\n            });\n\n            $rootScope.$on(enums.busNavigation.userListings,() => $state.go('app.myListings'));\n\n            $rootScope.$on(enums.busNavigation.newProduct,() => $state.go('app.products.newProduct') );\n\n            $rootScope.$on(enums.busNavigation.rentals,() => $state.go('app.bookings.userBookings') );\n\n            $rootScope.$on(enums.busNavigation.transactionDetailed,(event,{ bookingId,replace }) => {\n                $state.go('app.bookings.bookingDetailed',{bookingId: bookingId},replace ? { location: 'replace'} : undefined)\n            });\n\n            $rootScope.$on(enums.busNavigation.idVerification,(event,{bookingId ,replace}) => {\n                // optional booking object\n                $state.go('verification.user', { bookingId: bookingId ? bookingId : undefined }, replace ? {location: 'replace'} : undefined);\n            });\n\n            $rootScope.$on(enums.busNavigation.userReview, (event, { bookingId, isLender}) => {\n\n                $state.go('app.products.productReview', {bookingId: booking.Booking_Id});\n            });\n\n            $rootScope.$on(enums.busNavigation.paymentDetailed,(event,{startDate, endDate, productId, purchase, bookingId}) => {\n                        $state.go('app.bookings.paymentDetailed',{\n                            startDate,\n                            endDate,\n                            productId,\n                            purchase,\n                            bookingId,\n                        });\n                        // ptLog.error(TAG, `Navigation Error: ${enums.busNavigation.paymentDetailed}, please provide startDate, endDate and productId`)\n                    // }\n            });\n\n            $rootScope.$on(enums.busNavigation.chat, (event, data = undefined) => {\n                if (data && data.chatId)\n                    $state.go('app.chat',{chatId:data.chatId});\n                else\n                    $state.go('app.chat')\n            })\n\n        }]);\nangular.module('paladinApp')\n.service('uploadHandler',[function () {\n    this.convertInputElementToBas64 = function (inputElement) {\n        return new Promise((resolve,reject) => {\n            if (inputElement && inputElement.files && inputElement.files.length > 0) {\n                return convertFile(inputElement.files[0]).then(resolve)\n                    .catch(reject)\n            } else {\n                // No file uploaded\n                reject('no file uploaded')\n            }\n        })\n    };\n\n    const convertFile = (imgFile) => {\n        return new Promise((resolve,reject) => {\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                if (reader.result) {\n                    const img64 = reader.result.replace(`data:${imgFile.type};base64,`, '');\n                    resolve({\n                        original64:reader.result,\n                        serverParsed64: img64,\n                    });\n                } else\n                    reject('error uploading image');\n            };\n            reader.readAsDataURL(imgFile);\n        })\n    }\n}]);\n'use strict';\nangular.module('paladinApp')\n    .service('ptUtils', [\n        '$rootScope',\n        'enums',\n        'moment',\n        '$translate',\n        '$timeout',\n        'ptLog',\n        'geoLocationService',\n        '$sce',\n        function (\n            $rootScope,\n            enums,\n            moment,\n            $translate,\n            $timeout,\n            ptLog,\n            geoLocationService,\n            $sce) {\n            const TAG = 'ptUtils';\n\n            const stringToDate = (dateString, format = 'DD/MM/YYYY HH:mm', dateDelimiter = '/', timeDelimiter = ':', dateTimeSplitter = ' ') => {\n\n                const isHasTime = format.indexOf('HH') != -1 && format.indexOf('mm') != -1;\n                let dateTimeSplits = [dateString];\n\n                if (isHasTime)\n                    dateTimeSplits = dateString.split(dateTimeSplitter);\n\n                const datePartFormat = (isHasTime ? format.split(dateTimeSplitter)[0] : format).split(dateDelimiter);\n                const dateItems = (isHasTime ? dateString.split(dateTimeSplitter)[0] : dateString).split(dateDelimiter);\n                let yearI = datePartFormat.indexOf(datePartFormat.find((item) => item.indexOf('Y') != -1));\n                let monthI = datePartFormat.indexOf('MM');\n                let dayI = datePartFormat.indexOf('DD');\n                let hourI = undefined;\n                let minuteI = undefined;\n\n\n                if (isHasTime) {\n                    const timeItems = dateString.split(dateTimeSplitter)[1].split(timeDelimiter);\n                    const timePartFormat = format.split(dateTimeSplitter)[1].split(timeDelimiter);\n                    hourI = timePartFormat.indexOf('HH');\n                    minuteI = timePartFormat.indexOf('mm');\n                    return new Date(dateItems[yearI], parseInt(dateItems[monthI]) - 1, dateItems[dayI], timeItems[hourI], timeItems[minuteI]);\n                }\n                return new Date(dateItems[yearI], parseInt(dateItems[monthI]) - 1, dateItems[dayI]);\n            };\n\n            const getDisplayDataForTransactionStatus = (statusId) => {\n                let text = undefined;\n                let color = undefined;\n                switch (statusId) {\n                    case enums.productRentalStatus.available:\n                        text = 'PRODUCT_STATUS_AVAILABLE';\n                        color = 'rentOrderStatus-primary-50';\n                        break;\n                    case enums.productRentalStatus.requested:\n                        color = 'rentOrderStatus-primary-100';\n                        text = 'PRODUCT_STATUS_REQUESTED';\n                        break;\n                    case enums.productRentalStatus.timeout:\n                    case enums.productRentalStatus.timeoutByBorrower:\n                        color = 'rentOrderStatus-primary-200';\n                        text = 'PRODUCT_STATUS_TIMEOUT';\n                        break;\n                    case enums.productRentalStatus.canceled:\n                    case enums.productRentalStatus.criticalCancel:\n                    case enums.productRentalStatus.moderateCancel:\n                    case enums.productRentalStatus.canceledByLender:\n                        color = 'rentOrderStatus-primary-200';\n                        text = 'PRODUCT_STATUS_CANCELED';\n                        break;\n                    case enums.productRentalStatus.denied:\n                        color = 'rentOrderStatus-primary-200';\n                        text = 'PRODUCT_STATUS_DECLINED';\n                        break;\n                    case enums.productRentalStatus.accepted:\n                        color = 'rentOrderStatus-primary-300';\n                        text = 'PRODUCT_STATUS_ACCEPTED';\n                        break;\n                    case enums.productRentalStatus.started:\n                        color = 'rentOrderStatus-primary-400';\n                        text = 'PRODUCT_STATUS_STARTED';\n                        break;\n                    case enums.productRentalStatus.ended:\n                        color = 'rentOrderStatus-primary-500';\n                        text = 'PRODUCT_STATUS_ENDED';\n                        break;\n                    case enums.productRentalStatus.verified:\n                        color = 'rentOrderStatus-primary-50';\n                        text = 'PRODUCT_STATUS_VERIFIED';\n                        break;\n                    case enums.productRentalStatus.notVerified:\n                        color = 'rentOrderStatus-primary-100';\n                        text = 'PRODUCT_STATUS_NOT_VERIFIED';\n                        break;\n                    case enums.productRentalStatus.verifying:\n                        color = 'rentOrderStatus-primary-100';\n                        text = 'PRODUCT_STATUS_VERIFYING'; \n                        break;\n                    case enums.productRentalStatus.booked:\n                        color = 'rentOrderStatus-primary-300';\n                        text = 'PRODUCT_STATUS_BOOKED'; \n                        break;\n                }\n                return {\n                    text,\n                    color\n                }\n            };\n\n            const getPriceForRentalPeriod = (product, rentalPeriodInDays) => {\n                const {\n                    Price1Day,\n                    Price3Day,\n                    Price5Day,\n                    Price7Day,\n                    Price10Day,\n                    Price15Day,\n                    Product_TryAndBuy,\n                    Product_CategoryId,\n                    Product_Price_Perday\n                } = product;\n                let daysFactor = 0;\n\n                if (enums.categoriesIds.tryAndBuy == Product_CategoryId || Product_TryAndBuy) {\n                    if (Price15Day > 0 && rentalPeriodInDays >= 15) {\n                        daysFactor = rentalPeriodInDays - 15;\n                        if (daysFactor > 0)\n                            return Price15Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price15Day;\n                    } else if (Price10Day > 0 && rentalPeriodInDays >= 10) {\n                        daysFactor = rentalPeriodInDays - 10;\n                        if (daysFactor > 0)\n                            return Price10Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price10Day;\n                    } else if (Price7Day > 0 && rentalPeriodInDays >= 7) {\n                        daysFactor = rentalPeriodInDays - 7;\n                        if (daysFactor > 0)\n                            return Price7Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price7Day;\n                    } else if (Price5Day > 0 && rentalPeriodInDays >= 5) {\n                        daysFactor = rentalPeriodInDays - 5;\n                        if (daysFactor > 0)\n                            return Price5Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price5Day;\n                    } else if (Price3Day > 0 && rentalPeriodInDays >= 3) {\n                        daysFactor = rentalPeriodInDays - 3;\n                        if (daysFactor > 0)\n                            return Price3Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price3Day;\n\n                    } else if (Price1Day > 0 && rentalPeriodInDays >= 1) {\n                        daysFactor = rentalPeriodInDays - 1;\n                        if (daysFactor > 0)\n                            return Price1Day + getPriceForRentalPeriod(product, daysFactor);\n                        else\n                            return Price1Day;\n                    } else {\n                        return Product_Price_Perday * rentalPeriodInDays;\n                    }\n                } else {\n                    return Product_Price_Perday * rentalPeriodInDays;\n                }\n            };\n\n            const getPriceForRentalPeriodLegacy = (product, rentalPeriodInDays) => {\n                const {\n                    Price3Day,\n                    Price5Day,\n                    Price7Day,\n                    Price10Day,\n                    Price15Day,\n                    Product_TryAndBuy,\n                    Product_CategoryId,\n                    Product_Price_Perday\n                } = product;\n                let daysFactor = 0;\n                let periodFixedPrice = undefined;\n                if (enums.categoriesIds.tryAndBuy == Product_CategoryId || Product_TryAndBuy) {\n                    if (Price15Day > 0 && rentalPeriodInDays >= 15) {\n                        daysFactor = rentalPeriodInDays - 15;\n                        periodFixedPrice = Price15Day;\n                    } else if (Price10Day > 0 && rentalPeriodInDays >= 10) {\n                        daysFactor = rentalPeriodInDays - 10;\n                        periodFixedPrice = Price10Day;\n                    } else if (Price7Day > 0 && rentalPeriodInDays >= 7) {\n                        daysFactor = rentalPeriodInDays - 7;\n                        periodFixedPrice = Price7Day;\n                    } else if (Price5Day > 0 && rentalPeriodInDays >= 5) {\n                        daysFactor = rentalPeriodInDays - 5;\n                        periodFixedPrice = Price5Day;\n                    } else if (Price3Day > 0 && rentalPeriodInDays >= 3) {\n                        daysFactor = rentalPeriodInDays - 3;\n                        periodFixedPrice = Price3Day;\n                    }\n                }\n\n                if (periodFixedPrice) {\n                    if (daysFactor > 0)\n                        return periodFixedPrice + (daysFactor * Product_Price_Perday);\n                    else\n                        return periodFixedPrice\n                } else {\n                    return Product_Price_Perday * rentalPeriodInDays;\n                }\n\n            };\n\n            const getPriceCalculatedDescriptionForRentalPeriod = (product, rentalPeriodInDays) => {\n                const {\n                    Price1Day,\n                    Price3Day,\n                    Price5Day,\n                    Price7Day,\n                    Price10Day,\n                    Price15Day,\n                    Product_TryAndBuy,\n                    Product_CategoryId,\n                    Product_Price_Perday\n                } = product;\n                let days = rentalPeriodInDays;\n                let priceDivisions = {};\n\n\n                for (let i = days; i > 0;) {\n                    let division = 0;\n                    let divisionPrice = 0;\n                    if (enums.categoriesIds.tryAndBuy == Product_CategoryId || Product_TryAndBuy) {\n                        if (Price15Day > 0 && i >= 15) {\n                            division = 15;\n                            divisionPrice = Price15Day;\n                        } else if (Price10Day > 0 && i >= 10) {\n                            division = 10;\n                            divisionPrice = Price10Day;\n                        } else if (Price7Day > 0 && i >= 7) {\n                            division = 7;\n                            divisionPrice = Price7Day;\n                        } else if (Price5Day > 0 && i >= 5) {\n                            division = 5;\n                            divisionPrice = Price5Day;\n                        } else if (Price3Day > 0 && i >= 3) {\n                            division = 3;\n                            divisionPrice = Price3Day;\n                        } else if (Price1Day > 0 && i >= 1) {\n                            division = 1;\n                            divisionPrice = Price1Day;\n                        } else {\n                            division = 1;\n                            divisionPrice = Product_Price_Perday;\n                        }\n                    } else {\n                        division = 1;\n                        divisionPrice = Product_Price_Perday;\n                    }\n\n                    priceDivisions[divisionPrice] = (priceDivisions[divisionPrice] || 0) + 1;\n                    i -= division;\n                }\n\n                let priceDescription = '';\n                for (let div in priceDivisions) {\n                    priceDescription += (priceDescription === '' ? '' : '+') + `${div}x${priceDivisions[div]}`;\n                }\n                return priceDescription;\n            };\n\n\n            const calculatePricingListForProduct = (\n                startRentDate,\n                endRentDate,\n                product,\n                productBookingDetails,\n                isDelivery = false,\n                userCredit = null,\n                coupon = undefined,\n                isBuy = false,\n            ) => {\n                return new Promise((resolve, reject) => {\n                    if (startRentDate && endRentDate && !isBuy) {\n                        const days = getRentalPeriodInDays({startRentDate, endRentDate});\n                        let prices = [];\n                        const {\n                            Product_CategoryId,\n                            Product_TryAndBuy,\n                            MinRentalPeriod,\n                            MaxRentalPeriod\n                        } = product;\n                        const {\n                            DeliveryAndPickupDetail\n                        } = productBookingDetails;\n                        const {\n                            Delivery_Fee,\n                            PickUp_Address\n                        } = DeliveryAndPickupDetail;\n\n                        const isTryAndBuy = enums.categoriesIds.tryAndBuy == Product_CategoryId || Product_TryAndBuy;\n                        let price = getPriceForRentalPeriodLegacy(product, days);\n                        let priceDescription = '' + days;\n                        // getPriceCalculatedDescriptionForRentalPeriod(product, days);\n\n                        if (isTryAndBuy) {\n                            if (MinRentalPeriod > 0 && days < MinRentalPeriod)\n                                return reject({\n                                    code: -2,\n                                    message: $translate.instant('INVALID_MIN_RENTAL_PERIOD', {days: MinRentalPeriod}),\n                                });\n                            else if (MaxRentalPeriod > 0 && days > MaxRentalPeriod)\n                                reject({\n                                    code: -3,\n                                    message: $translate.instant('INVALID_MAX_RENTAL_PERIOD', {days: MaxRentalPeriod}),\n                                });\n                        }\n\n                        prices = [\n                            {\n                                price: price,\n                                description: `${priceDescription} ${$translate.instant(days == 1 ? 'DAY' : 'DAYS')}`\n                            },\n                            {\n                                price: 0,\n                                description: $translate.instant('SERVICE_FEE'),\n                                tooltip: $translate.instant('SERVICE_FEE_FREE'),\n                            }\n                        ];\n\n                        if (isTryAndBuy && isDelivery) {\n                            prices.push({\n                                price: Delivery_Fee || 0,\n                                description: $translate.instant('DELIVERY_FEE')\n                            })\n                        }\n\n                        let totalPrice = (isTryAndBuy && isDelivery ? (Delivery_Fee || 0) : 0) + price;\n\n\n                        if (coupon) {\n                            \n                            const {\n                                Coupon,\n                                CouponValue,\n                                CouponIsPercentage,\n                                CouponIsFixed,\n                            } = coupon;\n\n                            if (!CouponIsFixed) {\n                                \n                                let discount = CouponIsPercentage ? totalPrice * (CouponValue / 100) : CouponValue;\n                                totalPrice -= discount;\n                                if (totalPrice < 0) {\n                                    totalPrice = 0\n                                }\n                                prices.push({\n                                    description: $translate.instant('COUPON'),\n                                    isCoupon: true,\n                                    price: `-${discount}`\n                                })\n\n                            } else {\n                                totalPrice = CouponValue;\n                                prices.push({\n                                    description: $translate.instant('FIX_COUPON_DISCOUNT'), \n                                    isCoupon: true,\n                                    price: `${CouponValue}`    \n                                })\n                            }\n                            \n                        } else if (userCredit && userCredit.User_Credit) {\n                            const credit = userCredit.User_Credit;\n\n                            let discount = credit >= totalPrice - 5 ? totalPrice - 5 : credit;\n\n                            totalPrice -= discount;\n\n                            prices.push({\n                                description: $translate.instant('CREDIT'),\n                                isCredit: false,\n                                price: `-${discount}`\n                            })\n\n                        }\n\n\n                        prices.push({\n                            description: $translate.instant('TOTAL'),\n                            price: totalPrice,\n                        });\n\n                        resolve(prices)\n                    } else if (isBuy) {\n                        let prices = [];\n                        //buy case\n                        prices.push({\n                            description: $translate.instant('RETAIL_PRICE'),\n                            price: product.Product_PurchasePrice\n                        })\n                        if (isDelivery) {\n                            prices.push({\n                                description: $translate.instant('DELIVERY_FEE'),\n                                price: product.Product_Process_Fee\n                            })\n                        }\n                       \n\n                        let totalPrice = product.Product_Process_Fee+product.Product_PurchasePrice;\n                        prices.push({\n                            description: $translate.instant('TOTAL'),\n                            price: totalPrice\n                        })\n\n                        resolve(prices)\n                        \n                    }\n                })\n            };\n\n            const calculatePriceingListForBooking = (booking) => {\n                return new Promise((resolve) => {\n\n\n                    const {\n                        Booking_PickupProduct,\n                        FullEndDate,\n                        FullStartDate,\n                        Discount,\n                        DeliveryAndPickupDetail,\n                        RentAmount,\n                        Fix_Amount_Coupon,\n                        AmountCharge,\n                    } = booking;\n                    const {\n                        Delivery_Fee\n                    } = DeliveryAndPickupDetail;\n                    \n                    const days = getRentalPeriodInDays({\n                        startRentDate: new Date(FullStartDate),\n                        endRentDate: new Date(FullEndDate),\n                    });\n                    const priceDescription = '' + days;\n                    const isDelivery = !Booking_PickupProduct;\n\n                    let prices = [\n                        {\n                            price: isDelivery ? RentAmount-Delivery_Fee : RentAmount,\n                            description: `${priceDescription} ${$translate.instant(days == 1 ? 'DAY' : 'DAYS')}`\n                        },\n                        {\n                            price: 0,\n                            description: $translate.instant('SERVICE_FEE'),\n                            tooltip: $translate.instant('SERVICE_FEE_FREE'),\n                        }\n                    ];\n\n                    if (isDelivery) {\n                        prices.push({\n                            price: Delivery_Fee || 0,\n                            description: $translate.instant('DELIVERY_FEE'),\n                        })\n                    }\n                    if (Discount) {\n                        prices.push({\n                            price: -Discount,\n                            description: $translate.instant('DISCOUNT'),\n                        })\n                    }\n\n                    if (Fix_Amount_Coupon>0) {\n                        prices.push({\n                            price: Fix_Amount_Coupon,\n                            description: $translate.instant('FIX_COUPON_DISCOUNT'),\n                        })  \n                    }\n                    /* \n                    let totalPrice = RentAmount + (Booking_PickupProduct ? 0 : Delivery_Fee || 0) - (Discount ? Discount : 0);\n                    if (totalPrice < 0)\n                        totalPrice = 0;\n                    */\n                    //as total price we use AmountCharge    \n                    prices.push({\n                        price: AmountCharge,\n                        description: $translate.instant('TOTAL'),\n                    });\n\n                    resolve(prices)\n                })\n\n            };\n\n            const getRentalPeriodInDays = ({startRentDate, endRentDate}) => {\n                let startDate = moment.isMoment(startRentDate) ? startRentDate : moment(new Date(startRentDate));\n                let endDate = moment.isMoment(endRentDate) ? endRentDate : moment(new Date(endRentDate));\n                return endDate.diff(startDate, 'days') + 1;\n            };\n\n            /**\n             * @return {\n             *  startDate: Date,\n             *  endDate: Date,\n             * }\n             */\n            const getProductFirstAvailableDatesToRent = (productBookingDetails) => {\n                const dateRanges = getBookedDateRanges(productBookingDetails);\n                let firstAvailableDates = {\n                    startDate: moment(),\n                    endDate: moment().add(1, 'day')\n                };\n\n                for (let i = 0; i < dateRanges.length; i++) {\n                    if (isBookingDateBookedForDateRange(firstAvailableDates.startDate, dateRanges[i]) ||\n                        isBookingDateBookedForDateRange(firstAvailableDates.endDate, dateRanges[i])) {\n                        firstAvailableDates.startDate = moment(dateRanges[i].endDate).add(1, 'day');\n                        firstAvailableDates.endDate = moment(firstAvailableDates.startDate).add(1, 'day');\n                    }\n                }\n\n                return firstAvailableDates;\n            };\n\n\n            const getBookedDateRanges = (productBookingDetails) => {\n                const {ProductBookingDetail} = productBookingDetails;\n\n                if (ProductBookingDetail && ProductBookingDetail.length > 0) {\n                    let dateRanges = [];\n                    ProductBookingDetail.forEach((booking) => {\n                        dateRanges.push({\n                            endDate: moment(booking.EndDate),\n                            startDate: moment(booking.StartDate)\n                        })\n                    });\n\n                    return dateRanges;\n                }\n                return []\n            };\n\n            /**\n             *\n             * @param momentDate date to validate (moment Object)\n             * @param range dateRange containing startDate and enDate dates, usually means that the method \"getBookedDateRanges\" was called at an earlier step\n             */\n            const isBookingDateBookedForDateRange = (momentDate, range) => {\n                return (momentDate.isBetween(range.startDate, range.endDate) ||\n                    momentDate.isSame(range.startDate) ||\n                    momentDate.isSame(range.endDate))\n            };\n            const regexPatterns = {\n                email: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\n                numbersOnly: /^[0-9]+$/,\n                minMaxLength: (min = 2, max = undefined) => new RegExp(`.{${min},${max ? max : ''}}`),\n            };\n\n            const sorters = {\n                bookingLastModifiedEpoch: (a, b) => b.Last_Modified - a.Last_Modified,\n            };\n\n\n            const dataUrlToBlob = (dataUrl) => {\n                // Decode the dataUrl\n                let binary = atob(dataUrl.split(',')[1]);\n                // Create 8-bit unsigned array\n                let array = [];\n                for (let i = 0; i < binary.length; i++) {\n                    array.push(binary.charCodeAt(i));\n                }\n                // Return our Blob object\n                return new Blob([new Uint8Array(array)], {type: 'image/jpg'});\n            };\n\n            const isMobile = {\n                Android: function () {\n                    return navigator.userAgent.match(/Android/i);\n                },\n                BlackBerry: function () {\n                    return navigator.userAgent.match(/BlackBerry/i);\n                },\n                iOS: function () {\n                    return navigator.userAgent.match(/iPhone|iPad|iPod/i);\n                },\n                Opera: function () {\n                    return navigator.userAgent.match(/Opera Mini/i);\n                },\n                Windows: function () {\n                    return navigator.userAgent.match(/IEMobile/i);\n                },\n                any: function () {\n                    return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());\n                }\n            };\n\n            const isCrawler = () => {\n                return /bot|prerender|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent);\n            };\n\n            const playErrorSound = () => {\n                try {\n                    let context = new AudioContext();\n                    let o = context.createOscillator();\n                    let g = context.createGain();\n                    o.type = \"sine\";\n                    o.connect(g);\n                    g.connect(context.destination);\n                    o.start();\n                    g.gain.exponentialRampToValueAtTime(\n                        0.00010, context.currentTime + 1\n                    )\n                } catch (err) {\n                    ptLog.error('AudioContext not supported');\n                }\n            };\n\n            const isProductTryAndBuy = (product) => {\n                const {\n                    Product_CategoryId,\n                    Product_TryAndBuy\n                } = product;\n                return enums.categoriesIds.tryAndBuy == Product_CategoryId || Product_TryAndBuy;\n            };\n\n            const getProductDetailUrl = (product) => {\n                return window.globals.ROOT_PATH + $translate.use() + '/product/' + getProductNameAndId(product);\n            }\n\n            const getProductNameAndId = (product) => {\n                return `${product.Product_Title} ${product.Product_Id}`.replace(/\\ /g,'-');\n            }\n\n            \n\n            const getAddressToDisplayForBooking = ({product, productBookingDetails, booking}) => {\n                return new Promise((resolve, reject) => {\n                    const isProductTryAndBuyBool = isProductTryAndBuy(product);\n                    let location = {\n                        title: 'PICK_UP',\n                        address: undefined,\n                        lat: undefined,\n                        lng: undefined,\n                    };\n                    if (!product) {\n                        return reject('product must not be undefined')\n                    }\n                    location.address = product.Lender_User_Address;\n                    location.lat = product.Product_Latitude;\n                    location.lng = product.Product_Longitude;\n\n                    if (isProductTryAndBuyBool) {\n                        if (productBookingDetails) {\n                            if (booking) {\n                                const {Booking_PickupProduct, Delivery_Latitude, Delivery_Longitude, Delivery_Address} = booking;\n\n                                if (!Booking_PickupProduct) {\n                                    location.title = 'DELIVERY_ADDRESS';\n                                    location.address = Delivery_Address;\n                                    location.lat = Delivery_Latitude;\n                                    location.lng = Delivery_Longitude;\n                                } else {\n                                    const {PickUp_Address, PickUp_Latitude, PickUp_Longitude} = productBookingDetails;\n                                    location.address = PickUp_Address;\n                                    location.lat = PickUp_Latitude;\n                                    location.lng = PickUp_Longitude;\n                                }\n                            }\n                        }\n                    }\n\n                    extractAndGeoLocateAddressFromObjectForFieldNames({\n                        object: location,\n                        addressFieldName: 'address',\n                        latFieldName: 'lat',\n                        lngFieldName: 'lng'\n                    })\n                        .then((address) => {\n                            resolve({\n                                ...address,\n                                title: location.title\n                            })\n                        })\n                        .catch(reject)\n                })\n            };\n\n            const extractAndGeoLocateAddressFromObjectForFieldNames = ({object, addressFieldName, latFieldName, lngFieldName}) => {\n                return new Promise((resolve, reject) => {\n                    let address = object[addressFieldName];\n                    let lat = Number(object[latFieldName] || 0);\n                    let lng = Number(object[lngFieldName] || 0);\n                    if (!address && lat && lng) {\n                        geoLocationService.getUserAddressFromCoordinates({lat, lng})\n                            .then((geoLocatedAddress) => {\n                                resolve({\n                                    address: geoLocatedAddress,\n                                    lat,\n                                    lng\n                                })\n                            })\n                            .catch(reject)\n                    } else {\n                        resolve({\n                            address,\n                            lat,\n                            lng,\n                        })\n                    }\n\n                });\n\n            };\n\n\n            const parseBookingStepTutorialHTMLTemplateForTranslationId = (translationId) => {\n                const translatedText = $translate.instant(translationId);\n\n                if (translatedText.indexOf('|') != -1) {\n                    const textComponents = $translate.instant(translationId).split('|');\n                    let HTML_TEXT = '<div>';\n                    textComponents.forEach((comp, index) => {\n                        if (index == 0)\n                            HTML_TEXT += `<span>${comp}</span> <ol>`;\n                        else\n                            HTML_TEXT += `<li>${comp}</li>`\n\n                    });\n                    HTML_TEXT += '</ol><div>';\n                    return $sce.trustAsHtml(HTML_TEXT);\n                } else {\n                    ptLog.warn(TAG, 'parseBookingStepTutorialHTMLTemplateForTranslationId', 'failed to parse translationId:', translationId);\n                    return translatedText;\n                }\n            };\n\n            const getTranslationIdForBookingStatus = (bookingStatus, isLender, isTryAndBuy) => {\n                if (bookingStatus === enums.productRentalStatus.notVerified ||\n                    bookingStatus === enums.productRentalStatus.verified)\n                    return `BookingStatusNotVerified_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.verifying)\n                    return `BookingStatusVerifying_Borrower`;\n                else if (bookingStatus === enums.productRentalStatus.requested)\n                    return `BookingStatusRequested_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.accepted)\n                    return `BookingStatusAccepted_${ isLender ? 'Lender' : 'Borrower' }`;\n                \n                else if (bookingStatus === enums.productRentalStatus.booked)\n                    return `BookingStatusBooked_Borrower`;\n                \n                else if (bookingStatus === enums.productRentalStatus.timeout)\n                    return `BookingStatusTimeout_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.denied)\n                    return `BookingStatusDenied_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.canceled)\n                    return `BookingStatusCancelled_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.criticalCancel)\n                    return `BookingStatusCriticalCancelled_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.moderateCancel)\n                    return `BookingStatusModerateCancelled_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.canceledByLender)\n                    return `BookingStatusCancelledLender_${ isLender ? 'Lender' : 'Borrower' }`;\n                else if (bookingStatus === enums.productRentalStatus.started) {\n                    if (isTryAndBuy) \n                        return isLender ? `BookingStatusStarted_Lender` : `BookingStatusStarted_Borrower_TnB`;\n                    else \n                        return `BookingStatusStarted_${ isLender ? 'Lender' : 'Borrower' }`;\n                }\n                else if (bookingStatus === enums.productRentalStatus.ended)\n                    if (isTryAndBuy) \n                        return isLender ? `BookingStatusEnded_Lender` : `BookingStatusEnded_Borrower_TnB`;\n                    else \n                        return `BookingStatusEnded_${ isLender ? 'Lender' : 'Borrower' }`;\n            };\n\n            const getTranslationDictForDatePicker = () => {\n                return {\n                    'Month': $translate.instant('Month'),\n                    'Year': $translate.instant('Year'),\n                    'Date Range Template': $translate.instant('Date Range Template'),\n                    'Custom Date Range': $translate.instant('Custom Date Range'),\n                    'Today': $translate.instant('Today'),\n                    'Yesterday': $translate.instant('Yesterday'),\n                    'This Week': $translate.instant('Week'),\n                    'Last Week': $translate.instant('Week'),\n                    'This Month': $translate.instant('Month'),\n                    'Last Month': $translate.instant('Month'),\n                    'This Year': $translate.instant('Year'),\n                    'Last Year': $translate.instant('Year'),\n                    'Cancel': $translate.instant('Cancel'),\n                    'Clear': $translate.instant('Clear'),\n                    'Ok': $translate.instant('Ok'),\n                    'Sunday': $translate.instant('Sunday'),\n                    'Monday': $translate.instant('Monday'),\n                    'Tuesday': $translate.instant('Tuesday'),\n                    'Wednesday': $translate.instant('Wednesday'),\n                    'Thursday': $translate.instant('Thursday'),\n                    'Friday': $translate.instant('Friday'),\n                    'Saturday': $translate.instant('Saturday'),\n                    'Sun': $translate.instant('Sunday'),\n                    'Mon': $translate.instant('Monday'),\n                    'Tue': $translate.instant('Tuesday'),\n                    'Wed': $translate.instant('Wednesday'),\n                    'Thu': $translate.instant('Thursday'),\n                    'Fri': $translate.instant('Friday'),\n                    'Sat': $translate.instant('Saturday'),\n                    'January': $translate.instant('January'),\n                    'February': $translate.instant('February'),\n                    'March': $translate.instant('March'),\n                    'April': $translate.instant('April'),\n                    'May': $translate.instant('May'),\n                    'June': $translate.instant('June'),\n                    'July': $translate.instant('July'),\n                    'August': $translate.instant('August'),\n                    'September': $translate.instant('September'),\n                    'October': $translate.instant('October'),\n                    'November': $translate.instant('November'),\n                    'December': $translate.instant('December'),\n                    'Week': $translate.instant('Week'),\n                }\n            };\n\n            const getCategoriesUrl = (categoryName, subcategoryName, isTryAndBuy, languageCode) => {\n                let path = window.globals.ROOT_PATH + languageCode + \"/categorie/\" + (isTryAndBuy ? '' : \"privato/\");\n                if (subcategoryName == null) {\n                  path = path + categoryName;\n                } else {\n                  path = path + categoryName + \"/\" + subcategoryName;\n                }\n            \n                return path.split(' ').join('-');;\n              }\n\n            return {\n                stringToDate,\n                getDisplayDataForTransactionStatus,\n                getPriceForRentalPeriod,\n                calculatePricingListForProduct,\n                getPriceCalculatedDescriptionForRentalPeriod,\n                getBookedDateRanges,\n                isBookingDateBookedForDateRange,\n                getProductFirstAvailableDatesToRent,\n                regexPatterns,\n                sorters,\n                isProductTryAndBuy,\n                playErrorSound,\n                dataUrlToBlob,\n                isMobile,\n                isCrawler,\n                extractAndGeoLocateAddressFromObjectForFieldNames,\n                getAddressToDisplayForBooking,\n                getRentalPeriodInDays,\n                calculatePriceingListForBooking,\n                parseBookingStepTutorialHTMLTemplateForTranslationId,\n                getTranslationIdForBookingStatus,\n                getTranslationDictForDatePicker,\n                getProductDetailUrl,\n                getProductNameAndId,\n                getCategoriesUrl\n\n            }\n        }]);\n\n'use strict';\nangular.module('paladinApp')\n    .service('transactionService',[\n        '$rootScope',\n        'appStateManager',\n        'enums',\n        'apiService',\n        'popupService',\n        'geoLocationService',\n        'ptLog',\n        'ptUtils',\n        '$translate',\n        'gtmService',\n        'productReviewService',\n        'moment',\n        function ($rootScope,\n                  appStateManager,\n                  enums,\n                  apiService,\n                  popupService,\n                  geoLocationService,\n                  ptLog,\n                  ptUtils,\n                  $translate,\n                  gtmService,\n                  productReviewService,\n                  moment) {\n            const TAG = 'transactionService || ';\n            const acceptRental = (booking) => {\n                return new Promise((resolve,reject) => {\n                    const apiMethod = () => {\n                        return new Promise((resolve2,reject2) => {\n                            apiService.bookings.acceptBookingRequest({bookingId:booking.Booking_Id,userId: booking.Lender_Id})\n                                .then((res) => {\n                                    gtmService.trackEvent('rental-status', 'request-accepted');\n                                    popupService.showAlert('SUCCESS', 'BOOKING_ACCEPTED_SUCCESS')\n                                        .finally(() => {\n                                            $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                            resolve2()\n                                        })\n                                })\n                                .catch((err) => {\n                                    if (err && err.data && err.data.Data && err.data.Data == 403) {\n                                        return showInvalidOperationError(booking)\n                                    }\n                                    popupService.showConfirm('ERROR', 'BOOKING_ACCEPTED_FAILURE','POPUP_TRY_AGAIN','POPUP_CANCEL')\n                                        .then(() => {\n                                            apiMethod()\n                                                .then(resolve2)\n                                                .catch(reject2)\n                                        })\n                                        .catch(() => {\n                                            resolve2()\n                                        })\n                                })\n                        })\n                    };\n                    popupService.showTransactionStatusChange({booking,apiMethod,title:'ACCEPT_REQUEST'})\n                        .then(resolve)\n                        .catch(reject)\n                })\n            };\n\n            // Reject Rental is used for both lender and borrower prio request acceptance\n            // Borrower: will see a cancel request CTA\n            // Lender: will see decline request CTA\n            // Both \"Reject\" the booking and don't \"Cancel\" it\n            // transactionService.cancelBooking should be called only after a certain booking was accepted,\n            // by either the borrower or the lender\n            const rejectRental = (booking, isLender) => {\n                return new Promise((resolve,reject) => {\n                    const apiMethod = () => {\n                        return new Promise((resolve2,reject2) => {\n                            const userId = isLender ? booking.Lender_Id : booking.Borrower_Id;\n                            apiService.bookings.rejectBookingRequest({\n                                bookingId: booking.Booking_Id,\n                                userId,\n                                reason: ''\n                            })\n                                .then((res) => {\n                                    gtmService.trackEvent('rental-status', isLender? 'request-declined' : 'request-cancelled-prior-approval');\n                                    popupService.showAlert('SUCCESS', 'BOOKING_CANCELED_SUCCESS')\n                                        .finally(() => {\n                                            $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                            resolve2()\n                                        })\n                                })\n                                .catch((err) => {\n                                    if (err && err.data && err.data.Data && err.data.Data == 403) {\n                                        return showInvalidOperationError(booking)\n                                    }\n                                    popupService.showConfirm('ERROR', 'BOOKING_CANCELED_FAILURE','POPUP_TRY_AGAIN','POPUP_CANCEL')\n                                        .then(() => {\n                                            apiMethod()\n                                                .then(resolve2)\n                                                .catch(reject2)\n                                        })\n                                        .catch(() => {\n                                            resolve2()\n                                        })\n                                })\n                        })\n                    };\n\n                   popupService.showConfirm('CONFIRM', isLender ? 'BOOKING_REJECT_WARNING' : 'CANCEL_REQUEST_WARNING')\n                        .then(() => {\n                            popupService.showTransactionStatusChange({booking, apiMethod, title: isLender ? 'DECLINE_REQUEST' : 'CANCEL_REQUEST'})\n                                .then(resolve)\n                                .catch((e)=> {\n                                    console.log('...... ERR ', e, ' .... ', reject)\n                                    reject();\n                                })\n                        })\n                        .catch(() => {\n                            resolve()\n                        })\n                })\n            };\n\n\n            const cancelRental = (booking,isLender) => {\n                return new Promise((resolve,reject) => {\n                    const apiMethod = () => {\n                        return new Promise((resolve2,reject2) => {\n                            const userId = isLender ? booking.Lender_Id : booking.Borrower_Id;\n                            apiService.bookings.cancelBookingRequest({\n                                bookingId: booking.Booking_Id,\n                                userId,\n                                reason: ''\n                            })\n                                .then((res) => {\n                                    gtmService.trackEvent('rental-status', isLender ? 'booking-cancelled-by-lender' : 'booking-cancelled-by-borrower');\n                                    popupService.showAlert('SUCCESS', 'BOOKING_CANCELED_SUCCESS')\n                                        .finally(() => {\n                                            $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                            resolve2()\n                                        })\n                                })\n                                .catch((err) => {\n                                    if (err && err.data && err.data.Data && err.data.Data == 403) {\n                                        return showInvalidOperationError(booking)\n                                    }\n                                    popupService.showConfirm('ERROR', 'BOOKING_CANCELED_FAILURE','POPUP_TRY_AGAIN','POPUP_CANCEL')\n                                        .then(() => {\n                                            return apiMethod()\n                                                .then(resolve2)\n                                                .catch(reject2)\n                                        })\n                                        .catch(() => {\n                                            resolve2()\n                                        })\n                                })\n                        })\n                    };\n                    const {\n                        FullStartDate,\n                    } = booking;\n                    const daysLeftBeforeBookingStarts = moment(new Date(FullStartDate)).diff(moment(),'days');\n                    let msg = 'BOOKING_CANCELLATION_MODERATE_WARNING';\n                    if (daysLeftBeforeBookingStarts <= 1) {\n                        msg = 'BOOKING_CANCELLATION_CRITICAL_WARNING';\n                    }\n\n                    popupService.showConfirm('CONFIRM',msg)\n                        .then(() => {\n                            popupService.showTransactionStatusChange({booking, apiMethod, title: 'CANCEL_REQUEST'})\n                                .then(resolve)\n                                .catch(reject)\n                        })\n                        .catch(() => {\n                            resolve()\n                        })\n                })\n            };\n\n\n            const startRental = (booking) => {\n              return new Promise((resolve,reject) => {\n                  const apiMethod = () => {\n                      return new Promise((resolve2,reject2) => {\n                            apiService.bookings.startRental({\n                                bookingId: booking.Booking_Id,\n                                userId: booking.Borrower_Id,\n                            })\n                                .then(() => {\n                                    gtmService.trackEvent('rental-status', 'rental-started');\n                                    popupService.showAlert('SUCCESS','BOOKING_START_RENTAL_SUCCESS')\n                                        .finally(() => {\n                                            resolve2();\n                                            $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                        })\n                                })\n                                .catch((err) => {\n                                    if (err && err.data && err.data.Data && err.data.Data == 403) {\n                                        return showInvalidOperationError(booking)\n                                    }\n\n                                    popupService.showConfirm('ERROR','BOOKING_START_RENTAL_FAILURE','POPUP_TRY_AGAIN','POPUP_CANCEL')\n                                        .then(() => {\n                                            return apiMethod()\n                                                    .then(resolve2)\n                                                    .catch(reject2)\n                                        })\n                                        .catch(reject2)\n                                })\n                      })\n                  };\n                  popupService.showConfirm('CONFIRM','BOOKING_START_RENTAL_WARNING')\n                      .then(() => {\n                          popupService.showTransactionStatusChange({booking, apiMethod, title: 'START_RENTAL'})\n                              .then(resolve)\n                              .catch(reject)\n                      })\n              })\n            };\n\n            const endRental = (booking) => {\n                return new Promise((resolve,reject) => {\n                    const apiMethod = () => {\n                        return new Promise((resolve2,reject2) => {\n                            const user = appStateManager.user;\n                            apiService.bookings.endRental({\n                                bookingId: booking.Booking_Id,\n                                userId: booking.Lender_Id\n                            })\n                                .then((res) => {\n                                    gtmService.trackEvent('rental-status', 'rental-ended');\n                                    if (!user.User_StripeAccount) {\n                                        // user has no stripe account, call create stripe account to allow him to get paid\n                                        createUserStripeAccount(booking)\n                                            .then((res) => {\n                                                gtmService.trackEvent('rental-status', 'stripe-account-created');\n                                                popupService.showAlert('SUCCESS','BOOKING_END_RENTAL_SUCCESS_PAYMENT')\n                                                    .finally(() => {\n                                                        resolve2();\n                                                        $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                                    })\n                                            })\n                                            .catch((err) => {\n                                                if (err && err.isMissingAddress) {\n                                                    popupService.showAlert('ERROR', 'PAYOUT_MISSING_ADDRESS')\n                                                        .finally(() => {\n                                                            reject2()\n                                                        });\n                                                } else {\n                                                    reject2()\n                                                }\n                                            })\n                                    } else {\n                                        popupService.showAlert('SUCCESS','BOOKING_END_RENTAL_SUCCESS_PAYMENT')\n                                            .finally(() => {\n                                                resolve2();\n                                                $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                            })\n                                    }\n                                })\n                                .catch((err) => {\n                                    if (err && err.data && err.data.Data && err.data.Data == 403) {\n                                        return showInvalidOperationError(booking)\n                                    }\n                                    popupService.showConfirm('ERROR','BOOKING_END_RENTAL_FAILURE')\n                                        .then(() => {\n                                            return apiMethod()\n                                                .then(resolve2)\n                                                .catch(reject2)\n                                        })\n                                        .catch(() => {\n                                            resolve2()\n                                        })\n                                })\n                        })\n                    };\n                    popupService.showConfirm('CONFIRM','BOOKING_END_RENTAL_WARNING')\n                        .then(() => {\n                            popupService.showTransactionStatusChange({booking, apiMethod, title: 'END_RENTAL'})\n                                .then(resolve)\n                                .catch(reject)\n                        })\n                })\n\n            };\n\n\n            const endRentalForStripeAccountOnly = (booking) => {\n                return new Promise((resolve,reject) => {\n                    const apiMethod = () => createUserStripeAccount(booking);\n                    popupService.showTransactionStatusChange({booking, apiMethod, title: 'CREATE_STRIPE_ACCOUNT'})\n                        .then(() => {\n                            gtmService.trackEvent('rental-status', 'stripe-account-created');\n                            popupService.showAlert('SUCCESS', 'CREATE_STRIPE_ACCOUNT_SUCCESS')\n                                .then(() => {\n                                    $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                    resolve()\n                                })\n                        })\n                        .catch((err) => {\n                            if (err && err.isMissingAddress) {\n                                popupService.showAlert('ERROR','PAYOUT_MISSING_ADDRESS')\n                                    .finally(() => {\n                                        resolve()\n                                    });\n                            } else {\n                                popupService.showAlert('ERROR', 'CREATE_STRIPE_ACCOUNT_FAILURE')\n                                    .then(() => {\n                                        $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                                        resolve()\n                                    })\n                            }\n                        })\n                })\n            };\n\n            const createUserStripeAccount = (booking,email = undefined) => {\n                return new Promise((resolve,reject) => {\n                    const { user } = appStateManager;\n                    const { User_Address, User_Email,User_Id } = user;\n\n                    if (!User_Address) {\n                        return reject({isMissingAddress: true})\n                    }\n\n                    geoLocationService.getUserCountryFromUserAddress(User_Address)\n                        .then((country) => {\n                            const {short_name} = country;\n                            apiService.payments.createUserStripeAccount({\n                                userId: User_Id,\n                                email: email == undefined ? User_Email : email,\n                                bookingId: booking.Booking_Id,\n                                country: short_name\n                            })\n                                .then(resolve)\n                                .catch((err) => {\n                                    popupService.showInputField({\n                                        title: 'ERROR',\n                                        message: 'BOOKING_END_RENTAL_STRIPE_ACCOUNT_DUPLICATE_ERROR',\n                                        initialValue: appStateManager.user.User_Email,\n                                        inputRegexValidation: ptUtils.regexPatterns.email,\n                                    })\n                                        .then((res) => {\n                                            const apiMethod = () => createUserStripeAccount(booking,res.value);\n                                            popupService.showTransactionStatusChange({booking, apiMethod, title: 'END_RENTAL'})\n                                                .then(resolve)\n                                                .catch(reject)\n                                        })\n                                        .catch(reject)\n\n                                })\n                        })\n                        .catch((err) => {\n                            ptLog.error(`${TAG}, error getting user country, ${JSON.stringify(err)}`);\n                            reject(err)\n                        })\n                })\n            };\n\n            const showInvalidOperationError = (booking) => {\n                popupService.showAlert('ERROR','BOOKING_INVALID_OPERATION','REFRESH')\n                    .finally(() => {\n                        $rootScope.$emit(enums.busEvents.reloadDetailedBooking, {bookingId: booking.Booking_Id});\n                    })\n            };\n\n            return {\n                acceptRental,\n                rejectRental,\n                cancelRental,\n                startRental,\n                endRental,\n                createUserStripeAccount,\n                endRentalForStripeAccountOnly\n            }\n\n        }]);\n\n'use strict';\nangular.module('paladinApp')\n    .service('stripeService',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        '$q',\n        '$http',\n        function (\n            $rootScope,\n            enums,\n            appStateManager,\n            $q,\n            $http) {\n\n            const self = this;\n            self.ENV = window.globals.STRIPE_URL;\n\n            self.JSON_to_URLEncoded = (element, key, list) => {\n                list = list || [];\n                if ( typeof ( element ) == 'object' ) {\n                    for (let idx in element)\n                        self.JSON_to_URLEncoded(element[idx], key ? key + '['+idx+']' : idx, list);\n                } else {\n                    list.push(key+'='+encodeURIComponent(element));\n                }\n                return list.join('&');\n            };\n\n            self.getHttpConfig = (params, headers) => {\n                let config = {\n                    headers: {\n                        'Access-Control-Allow-Origin': '*',\n                        'X-Requested' : null,\n                        'Content-Type' : 'application/x-www-form-urlencoded; charset=utf-8',\n                        'Access-Control-Allow-Methods': 'GET, POST, PATCH, PUT, DELETE, OPTIONS',\n                        'Access-Control-Allow-Headers': 'Origin, Content-Type, X-Auth-Token',\n                        'Authorization': `Bearer ${window.globals.STRIPE_SK}`\n                    }\n                };\n\n                if (headers) {\n                    Object.keys(headers).forEach((headerKey) => {\n                        config.headers[headerKey] = headers[headerKey];\n                    });\n                }\n\n                if (params) { config.params = params; }\n                return config;\n            };\n\n            self.postRequest = function (path, data, headers) {\n                // let deferred = $q.defer();\n                const config = self.getHttpConfig(null, headers);\n                return $http({\n                    method: 'POST',\n                    url: self.ENV + path,\n                    headers: config.headers,\n                    params: config.params,\n                    transformRequest: function(obj) {\n                        return self.JSON_to_URLEncoded(obj)\n                    },\n                    data,\n                })\n                // return deferred.promise;\n            };\n\n            self.getRequest = function (path, params, headers) {\n                const config = self.getHttpConfig(null, headers);\n                return $http({\n                    method: 'GET',\n                    url: self.ENV + path,\n                    headers: config.headers,\n                    params: config.params,\n                    transformRequest: function(obj) {\n                        return self.JSON_to_URLEncoded(obj)\n                    },\n                })\n            };\n\n            self.apiMethods = {\n                createToken: function ({number,exp_month,exp_year,cvc,name}) {\n                    return self.postRequest('/tokens',{\n                        card: {\n                            number,\n                            exp_month,\n                            exp_year,\n                            cvc,\n                            name\n                        }\n                    })\n                },\n                getCustomer: function (customerId) {\n                    return self.getRequest(`/customers/${customerId}`)\n                },\n                getCustomerSources: function (customerId) {\n                    return self.getRequest(`/customers/${customerId}/sources`)\n                }\n            };\n\n            return self.apiMethods\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .service('acuantService',[\n        '$rootScope',\n        '$http',\n        '$base64',\n        function (\n            $rootScope,\n            $http,\n            $base64) {\n\n            const ACUANT_URL = 'https://cssnwebservices.com/CSSNService/CardProcessor';\n            const LISENCE = $base64.encode(window.globals.isProd() ? 'A0E66E952D88' : 'E265037472E6');\n            const post = (path,imageData) => {\n                return $http({\n                    method: 'POST',\n                    url: ACUANT_URL + path,\n                    headers: {\n                        // 'Access-Control-Allow-Headers': 'Content-Type',\n                        // 'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n                        // 'Access-Control-Allow-Origin': '*',\n                        'Content-Type': 'application/octet-stream; charset=utf-8;',\n                        'Authorization': `LicenseKey ${LISENCE}`,\n                    },\n                    \n                    dataType: 'json',\n                    data: imageData,\n\n                })\n            };\n            const postDuplex = (path,imageData) => {\n                return $http({\n                    method: 'POST',\n                    url: ACUANT_URL + path,\n                    transformRequest: angular.identity,\n                    headers: {\n                        // 'Access-Control-Allow-Headers': 'Content-Type',\n                        // 'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n                        // 'Access-Control-Allow-Origin': '*',\n                        'Content-Type': undefined,\n                        'Authorization': `LicenseKey ${LISENCE}`,\n                    },\n                    \n                    dataType: 'json',\n                    data: imageData,\n\n                })\n            };\n            const processPassportImage = ({imageToProcess, imageSource, usePreprocessing}) => {\n                return post(`/ProcessPassport/true/true/true/0/150/${usePreprocessing.toString()}/${imageSource.toString()}/true/false`,imageToProcess);\n            };\n\n            const processNICDLDuplexImage = ({frontImage, backImage,selectedRegion, imageSource, usePreprocessing}) =>{\n                const imgsToProcess = new FormData();\n                imgsToProcess.append(\"frontImage\", frontImage);\n                imgsToProcess.append(\"backImage\", backImage);\n                return postDuplex(`/ProcessDLDuplex/${selectedRegion}/true/-1/true/false/true/0/150/${imageSource.toString()}/${usePreprocessing.toString()}/true/false`, imgsToProcess);\n                    // .success(function(){\n                    //     console.log(\"SUCCESS\");\n                    // })\n                    // .error(function(){\n                    //     console.log(\"ERROR\");\n                    // });\n            };\n\n\n            const processDriversLicense = ({imageToProcess, selectedRegion, imageSource, usePreprocessing}) => {\n                return post(`/ProcessDriversLicense/${selectedRegion}/true/-1/true/true/true/0/150/${usePreprocessing.toString()}/${imageSource.toString()}/true/false`,imageToProcess)\n            };\n\n            const processFacialMatch = ({idFaceImage, selfie}) => {\n                const facialMatchData = new FormData();\n                facialMatchData.append(\"idFaceImage\", idFaceImage);\n                facialMatchData.append(\"selfie\", selfie);\n                return post(`/FacialMatch`,facialMatchData);\n            };\n\n\n            return {\n                processPassportImage,\n                processNICDLDuplexImage,\n                processFacialMatch,\n                processDriversLicense\n            }\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .service('gtmService',['$window', function ($window) {\n\n        this.trackEvent = function(category, action, label, value) {\n\n            if (!window.globals.isProd())\n                return\n                \n            if (category == undefined || action == undefined) {\n                throw Error('GTMService.trackEvent: Missing required property. Aborting hit.');\n            } \n    \n            $window.dataLayer.push({\n                'event': 'ngTrackEvent',\n                'attributes': {\n                    'category': category,\n                    'action': action,\n                    'label': label ? label : null,\n                    'value': value ? value : null,\n                    'nonInteraction': true\n                }\n            });\n    \n            console.log(\"DataLayer Event fired \"+ category + \" \" + action);\n        }\n                  \n    }]);\nangular.module('paladinApp').service('referralsService',\n    [\n        '$q',\n        '$location',\n        'apiService',\n        function (\n            $q,\n            $location,\n            apiService\n        ) {\n\n            this.userName = null;\n            this.referralCode = null;\n\n            this.validateReferralCode = (referralNameCode) => {\n                let self = this;\n\n                // referralCode includes the userName\n                let referralCode = referralNameCode;\n\n                let parts = referralNameCode.split('-');\n                // remove the alpha-numeric part which is last\n                parts.pop();\n                let userName = parts.join(' ');\n\n                // do some validation here to avoid unnecessary api calls\n                /*\n                                if(!referralCode || !referralCode.match(/^[a-z0-9]{6}$/i)){\n                                    $location.path('/');\n                                    return false;\n                                }\n                */\n\n                return $q(\n                    function (resolve, reject) {\n                        return apiService.users.signUpReferred(referralCode)\n                            .then(\n                                function (result) {\n                                    self.userName = userName;\n                                    self.referralCode = referralCode;\n\n                                    resolve({\n                                        userName: self.userName,\n                                        referralCode: self.referralCode\n                                    });\n                                },\n                                function (reason) {\n                                    // redirect to normal registration or some handler page\n                                    $location.path('/');\n                                    reject(reason);\n                                });\n\n                    },\n                    function (reason) {\n                        console.info('Validating the referralCode was rejected with reason: ', reason);\n                    })\n            };\n\n            this.getReferralData = () => {\n                return {\n                    userName: this.userName,\n                    code: this.referralCode\n                }\n            }\n        }\n    ]);\n\nclass FilterComponent {\n\n    constructor($scope,$sce,Filters,$rootScope,$translate,$location,enums) {\n      this.scope =$scope;\n      this.Filters = Filters;\n      this.translate = $translate;\n      //this.filter = {categories:[],languageCode:'en',selectedCategoryId:null,priceRange:[10,100]};\n      this.enums = enums;\n      this.rootScope = $rootScope;\n      this.categoryImageBaseUrl = window.globals.CATEGORY_IMAGE_URL;\n      this.location = $location;\n      this.sce = $sce;\n      this.slider = {};\n      this.showCategoriesDiv = false;\n      this.slider.priceSliderOption = {\n        options: {\n          orientation: 'horizontal',\n          min: 0,\n          max: 240,\n          step: 10,\n          range: true\n        }\n      };\n     this.slider.distanceSliderOption = {\n        options: {\n          orientation: 'horizontal',\n          min: 0,\n          max: 240,\n          step: 10,\n          range: false\n        }\n      };\n    }\n    \n    $onInit() {\n      this.scope.priceRange = [0,1000];\n      this.count=0;\n      this.selectedTab = this.filter.category.isTryAndBuy == true ? 0 : 1 || 0;\n      this.customCategoriesTnB = this.getCategories(true); \n      this.customCategoriesP2P = this.getCategories(false);\n      \n      var _this= this;\n      //this.scope.distanceRange = 100;\n\n\n      this.scope.$watch('priceRange',function(){\n        if (_this.filter.priceRange[0] != _this.scope.priceRange[0] ||\n          _this.filter.priceRange[1] != _this.scope.priceRange[1]) {\n          _this.filter.priceRange = _this.scope.priceRange;\n          //console.log(\"price range changed... to \" + _this.scope.priceRange);\n          //console.log(\"old price range is \" + _this.filter.priceRange);\n          _this.refreshProducts();\n        }\n      });\n\n      /*this.scope.$watch('distanceRange',function(){\n        _this.filter.distanceRange = _this.scope.distanceRange;\n        _this.refreshProducts();\n      })*/\n\n      /*\n      //here we already load the categories in case the page is refreshed, and we select the All Categories by default\n      if (!this.rootScope.filter || this.rootScope.forceLoadCategory) {\n        this.refreshCategories(null,null, $rootScope.lang);\n      }\n      */\n\n      \n      this.scope.$on('languageChanged', function(event,data){\n        _this.filter.languageCode = _this.getCurrentLanguageCode();\n\n        if (_this.filter.category.selectedSubCategoryId != null) {\n          //subcategory selected\n\n          _this.refreshCategories(_this.filter.category.selectedCategoryId,\n                                  _this.filter.category.selectedSubCategoryId, _this.filter.languageCode);\n   \n        } else if (_this.filter.category.selectedCategoryId != null) {\n          //parent category other than All Categories selected\n          _this.refreshCategories(_this.filter.category.selectedCategoryId, null, _this.filter.languageCode);\n\n        } else {\n          _this.refreshCategories(null, null, _this.filter.languageCode);\n        }\n\n      }); \n\n    }\n\n    selectCategories(selCategoryId, selSubcategoryId, lang) {\n      if (selCategoryId==null) {\n        this.selectCategory(this.enums.allCategories[lang], false);\n      } else {\n        this.selectCategory(this.Filters.getCategoryById(selCategoryId, lang), false);\n        if (selSubcategoryId!=null)\n          this.selectSubCategory(this.Filters.getSubcategoryById(selSubcategoryId, lang), false);\n      }\n    }\n\n    refreshCategories(selCategoryId, selSubcategoryId, lang){\n\n      this.filter.categories = this.rootScope.categoriesMap.get(lang);\n      this.selectCategories(selCategoryId, selSubcategoryId, lang);\n    }\n\n    getCategories(isTryAndBuy) {\n      let categories = {};\n      let i = 0;\n      this.rootScope.categoriesMap.get(this.getCurrentLanguageCode()).forEach((item) => {\n        if (isTryAndBuy && item.IsTryAndBuy || !isTryAndBuy && !item.IsTryAndBuy) {\n          categories[i++] = item;\n        } \n      });\n\n      return categories;\n      \n    }\n\n    toggleDiv() {\n      this.showCategoriesDiv = !this.showCategoriesDiv;\n    }\n    getCurrentLanguageCode() {\n      return this.translate.use();\n    }\n    selectCategory(category, refreshProductList){\n      if(typeof category != 'string'){\n        this.filter.category.selectedCategoryId = category.Category_Id;\n        this.filter.category.selectedCategoryDesc =this.sce.trustAsHtml(category.Category_Description);  \n        this.filter.category.selectedCategoryName =this.sce.trustAsHtml(category.Category_Name);  \n        this.filter.category.selectedCategoryImagePath = category.Category_ImagePath;\n        this.filter.category.selectedCategoryBannerImage = category.Category_BannerPath;\n        this.filter.category.isTryAndBuy = category.IsTryAndBuy;\n        this.rootScope.category = this.filter.category.selectedCategoryName;\n        \n      }else{\n        this.filter.category.selectedCategoryId = null;\n        this.filter.category.selectedCategoryDesc =this.sce.trustAsHtml(category);\n        this.filter.category.selectedCategoryName =category;  \n        this.filter.category.selectedCategoryImagePath =null;\n        this.filter.category.isTryAndBuy = this.rootScope.isTryAndBuy;\n        this.filter.category.selectedCategoryBannerImage = window.globals.IS_PROMO ? this.enums.categoriesBannersPaths.promo : this.enums.categoriesBannersPaths.all[this.getCurrentLanguageCode()];\n        this.rootScope.category=category;\n\n      }\n      this.selectSubCategory(null,false);\n\n      //console.log('category clicked...')\n      \n      if (refreshProductList) {\n        this.refreshProducts();\n      }\n    }\n\n    onTabSelected() {\n      if (this.selectedTab == 0) {\n        this.rootScope.$emit(this.enums.busNavigation.switchBrowseMode, {isTryAndBuy: true});\n      } else {\n        this.rootScope.$emit(this.enums.busNavigation.switchBrowseMode, {isTryAndBuy: false});\n      }\n    }\n\n    selectSubCategory(subCategory,refreshProductList){\n      if(subCategory){\n        //console.log(this.sce.trustAsHtml(subCategory.SubCategory_Name));\n        this.filter.category.selectedSubCategoryId = subCategory.SubCategory_Id;\n        this.filter.category.selectedSubCategoryDesc =this.sce.trustAsHtml(subCategory.SubCategory_Description);  \n        this.filter.category.selectedSubCategoryName =this.sce.trustAsHtml(subCategory.SubCategory_Name);  \n        this.filter.category.selectedSubCategoryImagePath = subCategory.SubCategory_ImagePath;\n        this.filter.category.selectedSubCategoryBannerImage = subCategory.SubCategory_BannerPath;\n        this.rootScope.subcategory=this.filter.category.selectedSubCategoryName;\n      }else{\n        this.filter.category.selectedSubCategoryId = null;\n        this.filter.category.selectedSubCategoryDesc =null;  \n        this.filter.category.selectedSubCategoryName =null;  \n        this.filter.category.selectedSubCategoryImagePath = null;\n        this.filter.category.selectedSubCategoryBannerImage = null;\n        this.rootScope.subcategory = null;\n      }\n\n      this.filter.search.searchStr = '';\n      this.filter.search.currentSearchStr='';\n      this.rootScope.searchKey = null;\n      this.location.search('search',null);\n      \n      if (this.rootScope.searchKey != null) {\n        this.rootScope.searchKey = null;\n      }\n\n      this.filter.currentPage =1;\n\n      //console.log('sub category clicked...')\n      if(refreshProductList)this.refreshProducts();\n    }\n\n    getCategoryUrl(category, subcategory, isTryAndBuy) {\n      return this.Filters.getCategoriesUrl(category==0 ? this.translate.instant('ACTG') : category.Category_Name, \n            subcategory == null ? null : subcategory.SubCategory_Name, isTryAndBuy, this.translate.use());\n    }\n    \n    refreshProducts(){\n        //console.log(\"REFRESH PRODUCTS in filters.js\");\n        this.rootScope.$broadcast('filtersUpdated',this.filter);\n    }    \n\n    increment() {\n      this.count++;\n    }\n\n    decrement() {\n      this.count--;\n    }\n    \n};\n\nangular\n.module('paladinApp')\n.component('filters', {\n  bindings: {\n    categories : '<',\n    filter :'=',\n    count: '='\n  },\n  controller: FilterComponent,\n  templateUrl: './views/templates/filter.tpl.html'\n})\n\n;\nangular\n.module('paladinApp')\n.directive('footer',[\n    '$rootScope',\n    'menusService',\n    'appStateManager',\n    'enums',\n    '$mdMedia',\n    '$state',\n    function (\n        $rootScope,\n        menusService,\n        appStateManager,\n        enums,\n        $mdMedia,\n        $state) {\n    return {\n        restrict:'E',\n        templateUrl:'./views/templates/footer.tpl.html',\n        scope: {\n\n        },\n        link: function ($scope, elem, attr) {\n\n            $scope.extraStyle = {\n                height: '150px'\n            };\n\n            $scope.aboutMenu = menusService.commonMenus.aboutMenu;\n            $scope.linksMenu = menusService.commonMenus.linksMenu;\n            $scope.menuLists = [\n                menusService.commonMenus.aboutMenu,\n                menusService.commonMenus.accountLoggedIn,\n                menusService.commonMenus.accountLoggedOut,\n                menusService.commonMenus.linksMenu,\n            ];\n\n            $scope.supportedLanguages = window.globals.SUPPORTED_LANGS;\n            $scope.selectedLanguage = $scope.supportedLanguages.find((lang) => lang.code === appStateManager.currentLang);\n\n            $scope.menuClick = (item) => {\n                menusService.menuClickHandlerMethod(item);\n            };\n\n            $scope.getMenuItemLink = (item) => {\n                return item.link || '#';\n            };\n\n            $scope.filterMenuItems = (item) => {\n              return menusService.shouldShowMenuItem(item)\n            };\n\n            $scope.onSelectLanguage = function(code) {\n                $scope.selectedLanguage = $scope.supportedLanguages.find((lang) => lang.code === code);\n                $rootScope.$emit(enums.busEvents.preferredLanguageChange,{currentLang: code});\n                $rootScope.$broadcast('languageChanged', code);\n            };\n\n            const setExtraHeight = (extraHeight) => {\n                if (extraHeight != $scope.extraStyle.height)\n                    $scope.extraStyle.height = extraHeight;\n\n            };\n            let deregs = [];\n\n            deregs.push($rootScope.$on(enums.busEvents.footerExtraHeight,(event,data) => {\n                $scope.extraStyle.height = data.height || $scope.extraStyle.height;\n            }));\n\n            deregs.push($scope.$watch(function () {return $mdMedia('gt-sm') },function (mgSm) {\n                    let extraHeight = '0';\n                    if (!mgSm) {\n                        if (\n                            $state.includes('app.products.newProduct') ||\n                            $state.includes('app.products.selectedProduct') ||\n                            $state.includes('app.bookings.bookingDetailed') ||\n                            $state.includes('app.bookings.paymentDetailed') ||\n                            $state.includes('app.bookings.bookingDetailed') ||\n                            $state.includes('verification.user')\n\n                        ) {\n                            extraHeight = '150px'\n                        }\n                    }\n\n                    setExtraHeight(extraHeight)\n            }));\n\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()();\n            });\n        }\n\n    }\n}]);\nangular\n.module('paladinApp')\n.component('header', {\n  bindings: {\n      user:'=',\n  },\n  controller: class HeaderComponent {\n\n    constructor($base64, $scope,$rootScope,$translate, $mdDialog, $http, $cookies, $timeout,popupService,enums) {\n      this.base64 = $base64;\n      this.scope =$scope;\n      this.rootScope = $rootScope;\n      this.translate = $translate;\n      this.baseUrl = window.globals.API_URL;\n      this.supportedLanguages = window.globals.SUPPORTED_LANGS;\n      this.profileImageBaseUrl = window.globals.PROFILE_IMAGE_URL;\n      this.mdDialog = $mdDialog;\n      this.http = $http;\n      this.btnStatus = 10;\n      this.signupMessage = \"\";\n      this.signupStatus = \"\";\n      this.signupFacebookStatus = \"\";\n      this.signupacebookMessage = \"\";\n      this.loginFacebookStatus = \"\";\n      this.loginFacebookMessage = \"\";\n      this.loginStatus = \"\";\n      this.loginMessage = \"\";\n      this.cookies = $cookies;\n      this.userStatus = false;\n      this.timeout = $timeout;\n      this.popupService = popupService;\n      this.enums = enums;\n      this.user = null;\n      this.registerBusEvents();\n    };\n    \n\n    registerBusEvents() {\n        let deregs = [];\n\n        deregs.push(this.rootScope.$on(this.enums.busEvents.updatedUser,(event,data) => {\n            this.user = data;\n            this.userStatus = this.user != null;\n        }));\n\n        this.scope.$on('$destroy', function() {\n            while (deregs.length)\n                deregs.pop()();\n        });\n    }\n\n    $onInit() {\n\n      this.profileDefaultImage=\"../../assets/profile.png\"; \n      var _this = this;\n      this.currentLang =this.translate.proposedLanguage()?this.translate.proposedLanguage(): this.translate.preferredLanguage();\n      this.currentLang  = this.rootScope.lang;\n      this.translate.use(this.rootScope.lang);\n      \n      this.scope.$on('updateLanguage', function(event,data){\n        _this.changeLanguage(data,false)\n      })\n      \n      if(this.cookies.getObject('globals') != undefined)\n          if (this.cookies.getObject('globals').currentUser != undefined)\n              if (this.cookies.getObject('globals').currentUser.username != undefined)\n                     this.userStatus = true;     \n        \n       \n      this.rootScope.$on('registeredSuccess', function(event,data){\n        _this.userStatus = true;     \n      })   \n    }\n\n    changeLanguage(lang,broadcastChange){\n      this.rootScope.lang = lang.code;\n      this.translate.use(lang.code);\n      this.currentLang = lang.code;\n  \n      \n      if(broadcastChange) {\n          this.rootScope.$broadcast('languageChanged', lang.code);\n          this.rootScope.$emit(this.enums.busEvents.preferredLanguageChange,{currentLang: lang.code});\n      }\n\n    }\n\n    hide() {\n      this.mdDialog.hide();\n    };\n\n    cancel() {\n      this.mdDialog.cancel();\n    };\n\n    answer(answer) {\n      this.mdDialog.hide(answer);\n    };\n\n    forgotPassword(email){\n      this.btnForgotPasswordStatus = 1;\n      var dataObj = {\n        User_Email : email,\n        LanguageCode: this.currentLang == \"it\" ? \"it-IT\" : this.currentLang\n      };\n        \n        \n        this.http.defaults.headers.common['Authorization'] = 'Basic ' + this.base64.encode('Paladin:Paladin123');\n        this.http.defaults.headers.common['Charset'] = 'UTF-8';\n        this.http.defaults.headers.common['Content-Type'] = 'application/json';\n\n          this.http.post(this.baseUrl + \"ForgetPassword/\", JSON.stringify(dataObj)).then((response) => {\n                this.btnForgotPasswordStatus = 10;\n                this.forgotpasswordStatus = response.data.Status;\n                this.forgotPasswordMessage = response.data.Message;\n            });\n\n    }\n      showTabDialogForgotPassword(ev){\n\n        this.mdDialog.show({\n          controller: ()=>this,\n        controllerAs: 'ctrl',\n          templateUrl: 'tabDialogForgotPassword',\n          parent: angular.element(document.body),\n          targetEvent: ev,\n          clickOutsideToClose:true,\n        http: this.http\n        });\n          \n\n      }\n\n\n  register(username, password, email, location) {\n    this.btnStatus = 1;\n    var dataObj = {\n      User_UserName : username,\n      User_Email : email,\n      User_Address : location,\n      User_Password : password,\n      User_UDIDType : 3,\n      LanguageCode: this.currentLang == \"it\" ? \"it-IT\" : this.currentLang\n    };\n        this.http.post(this.baseUrl + \"SignUp/\", dataObj).then((response) => {\n           this.btnStatus = 10;\n              this.signupStatus = response.data.Status;\n              if(response.data.Status == 'error')\n                this.signupMessage = response.data.Message;\n          });\n  }\n  registerFacebook() {\n\n    if(this.rootScope.facebookApiLoaded) {\n\n        this.btnStatus = 1;\n\n        var dataObj = {\n          User_UserName :this.rootScope.facebook_user.name.replace(\" \",\"-\") ,\n          User_Email : this.rootScope.facebook_user.email,\n          User_Address : this.rootScope.facebook_user.address,\n          User_Password : \"\",\n          User_UDIDType : 3,\n          LanguageCode: this.currentLang  == \"it\" ? \"it-IT\" : this.currentLang,\n          User_DisplayPicturePath:'http://graph.facebook.com/' + this.rootScope.facebook_user.id + '/picture?type=small',\n          User_DisplayPicture: 'http://graph.facebook.com/' + this.rootScope.facebook_user.id + '/picture?type=small',\n          User_FacebookId: this.rootScope.facebook_user.id ,\n          User_FullName: this.rootScope.facebook_user.name,\n          User_QBId:''\n        };\n\n\n            this.http.post(this.baseUrl + \"SignUp/\", dataObj).then((response) => {\n               this.btnStatus = 10;\n                  this.signupFacebookStatus = response.data.Status;\n                  if(response.data.Status == 'error'){\n                    this.signupFacebookMessage = response.data.Message;\n                  }else{\n                    this.rootScope.globals = {\n                        currentUser: {\n                            username: response.data.Data.User_UserName,\n                            token_type: response.data.Data.oAuthToken.token_type,\n                            access_token: response.data.Data.oAuthToken.access_token,\n                            refresh_token:  response.data.Data.oAuthToken.refresh_token,\n                            User_Id: response.data.Data.User_Id,\n                            User_DisplayPicturePath:'http://graph.facebook.com/' + this.rootScope.facebook_user.id + '/picture?type=small',\n                            User_DisplayPicture: 'http://graph.facebook.com/' + this.rootScope.facebook_user.id + '/picture?type=small'\n                          }\n                        };\n                    \n                        var cookieExp = new Date();\n                        cookieExp.setDate(cookieExp.getDate() + response.data.Data.oAuthToken.expires_in);\n                        this.cookies.putObject('globals', this.rootScope.globals, { expires: cookieExp });\n                        \n                        this.http.defaults.headers.common['Authorization'] = this.cookies.getObject('globals').currentUser.token_type + ' ' + this.cookies.getObject('globals').currentUser.access_token;\n                        this.hide();\n                        this.userStatus = true;\n                  }\n\n              });\n        }else{\n            this.signupFacebookStatus = 'error';\n            this.signupFacebookMessage =  this.translate.instant('FACEBOOK_LOADING');\n            var _this = this;\n            this.timeout( function(){\n              _this.registerFacebook();\n            }, 2000 );\n        }\n\n  }\n  logout(){\n      this.userStatus = false;\n      this.cookies.remove(\"globals\");\n      this.http.defaults.headers.common['Authorization'] = '';\n  };\n\n  login(username, password) {\n    this.btnStatus = 1;\n    var dataObj = {\n      User_UserName : username,\n      User_Email : \"\",\n      User_Mobile: \"\",\n      User_Password : password,\n      User_FacebookId: \"\",\n      LanguageCode: this.currentLang == \"it\" ? \"it-IT\" : this.currentLang\n    };\n\n\n    this.http.post(this.baseUrl + \"Login/\", dataObj).then((response) => {\n       this.btnStatus = 10;\n\n      if(response.data.Status != 'error'){\n          this.loginStatus = response.data.Status;\n          console.log(response.data.Data);\n          this.rootScope.globals = {\n            currentUser: {\n                username: response.data.Data.User_UserName,\n                token_type: response.data.Data.oAuthToken.token_type,\n                access_token: response.data.Data.oAuthToken.access_token,\n                refresh_token:  response.data.Data.oAuthToken.refresh_token,\n                User_Id: response.data.Data.User_Id,\n                User_DisplayPicturePath : response.data.Data.User_DisplayPicturePath\n              }\n            };\n        \n            var cookieExp = new Date();\n            cookieExp.setDate(cookieExp.getDate() + response.data.Data.oAuthToken.expires_in);\n            this.cookies.putObject('globals', this.rootScope.globals, { expires: cookieExp });\n            \n            this.http.defaults.headers.common['Authorization'] = this.cookies.getObject('globals').currentUser.token_type + ' ' + this.cookies.getObject('globals').currentUser.access_token;\n            \n            this.http.get(this.baseUrl + \"GetUserProfile?User_Id=\" + this.cookies.getObject('globals').currentUser.User_Id + \"&LanguageCode=\" + this.currentLang).then((response) => {\n                console.log(response);\n                this.hide();\n                this.userStatus = true;\n              });\n    \n          }else{\n            console.log(JSON.stringify(response, null, 4));\n            this.loginStatus = response.data.Status;\n            this.loginMessage = response.data.Message;\n          }\n\n\n      });\n  };\n\n  showTabDialog(ev) {\n      this.popupService.showLoginSignupPopup();\n  }\n  },\n  templateUrl: './views/templates/header.tpl.html'\n})\n\nangular.module('paladinApp')\n    .directive('headerV2',[\n        '$rootScope',\n        'appStateManager',\n        'popupService',\n        '$mdMenu',\n        '$translate',\n        'enums',\n        '$mdSidenav',\n        '$window',\n        'menusService',\n        'apiService',\n        '$state',\n        '$transitions',\n        '$mdComponentRegistry',\n        function (\n            $rootScope,\n            appStateManager,\n            popupService,\n            $mdMenu,\n            $translate,\n            enums,\n            $mdSidenav,\n            $window,\n            menusService,\n            apiService,\n            $state,\n            $transitions,\n            $mdComponentRegistry) {\n            return {\n                restrict: 'E',\n                scope: {\n                    // isScrollOffsetZero: '=',\n                },\n                templateUrl: './views/templates/headerV2.tpl.html',\n                link: function ($scope, elem, attr) {\n                    $scope.isScrollOffsetZero = ($state.current.data || {}).isCollapsingHeader || false;\n                    $scope.searchText = '';\n                    $scope.searchItems = ['one','two','three','four','five'];\n\n                    $scope.unreadBadge = 0;\n                    $scope.aboutMenu = menusService.commonMenus.aboutMenu.list;\n\n                    $scope.profileMenu = menusService.commonMenus.accountLoggedIn.list;\n                    $scope.loggedOutMenu = menusService.commonMenus.accountLoggedOut.list;\n                    $scope.commonMenu = menusService.commonMenus.common.list;\n                    $scope.linksMenu = menusService.commonMenus.linksMenu;\n\n                    $scope.loggedInMenu = [\n                        {\n                            title: $translate.instant('LENT_BORROWED'),\n                            BL: (() => alert(`Navigate to ${$translate.instant('LENT_BORROWED')}`))\n                        },\n                        {\n                            title: $translate.instant('LISTINGS'),\n                            BL: (() => alert(`Navigate to ${$translate.instant('LISTINGS')}`))\n                        },\n                        {\n                            title: $translate.instant('MESSAGES'),\n                            BL: (() => alert(`Navigate to ${$translate.instant('MESSAGES')}`))\n                        },\n\n                    ];\n\n                    $scope.loginSignUpPopupClick = (isSignUp) => {\n                        popupService.showLoginSignupPopup(isSignUp);\n                    };\n\n\n                    $scope.querySearch = (textQuery) => {\n                        const query = textQuery.toLowerCase();\n                        return apiService.products.getSuggestions(query)\n                            .then((response) => {\n                                return [{Rank: Infinity, Keyword: textQuery},...response.Data.sort((a,b) => b.Rank - a.Rank)];\n                            })\n                    };\n\n                    $scope.headerMenuClick = (item) => {\n                        $scope.close();\n                        menusService.menuClickHandlerMethod(item)\n                    };\n\n                    $scope.getMenuItemLink = (item) => {\n                        return item.link || '#';\n                    };\n\n                    $scope.initiateSearch = (keyword) => {\n                        if (keyword && keyword != '') {\n                            $rootScope.$emit(enums.busNavigation.browseKeyword,{keyword});\n                        }\n                    };\n\n\n                    $scope.searchBarOnKeyPress = ($event) => {\n                        if ($event.which == 13 && $event.target.value && $event.target.value != '') {\n                            $scope.initiateSearch($event.target.value);\n                            $event.preventDefault();\n                        }\n                    };\n\n                    $scope.toggleSideNav = () => {\n                        if ($mdComponentRegistry.get(enums.inAppSideNavsIds.chatSideNav) && $mdSidenav(enums.inAppSideNavsIds.chatSideNav).isOpen())\n                            $mdSidenav(enums.inAppSideNavsIds.chatSideNav).toggle();\n\n                        $mdSidenav(enums.inAppSideNavsIds.mainMobileNav).toggle();\n                    };\n\n                    $scope.close = () => {\n                        $mdSidenav(enums.inAppSideNavsIds.mainMobileNav).close()\n                    };\n\n                    if (appStateManager.user) { //TODO here user is always undefined \n                        $scope.user = appStateManager.user;  \n                    }\n\n                    $scope.updateCreditButton = () => {\n                        let userId = appStateManager.getUserId();\n                        if (userId) {            \n                            apiService.users.getUserCredit({userId})\n                            .then(\n                                (result) => {\n                                    $scope.currentCredit = result.Data.User_Credit;\n                                    $scope.currentCreditText = ($scope.currentCredit && $scope.currentCredit>0) \n                                        ? $translate.instant('CREDIT_MENU_ITEM') + \": \" + $scope.currentCredit + \"\"\n                                        : $translate.instant('GET_FREE_CREDIT'); \n                                },\n                                (reason) => {\n                                    console.log('getUserCredit failed because: ', reason);\n        \n                                });\n                        }\n                    }\n\n                    \n                    \n                    $scope.creditMenuClick = () => {\n                        $scope.close();\n                        $rootScope.$emit(enums.busNavigation.userProfile, {userId: $scope.user.User_Id})\n                    }\n                    \n\n                    let deregs = [];\n                    deregs.push($rootScope.$on(enums.busEvents.updatedUser,(event,data) => {\n                        $scope.user = appStateManager.user;\n                        $scope.updateCreditButton();\n                    }));\n\n                    deregs.push($rootScope.$on(enums.busChatEvents.updateUnreadCount,(event,data) => {\n                        $scope.unreadBadge = data.total || 0;\n                        $scope.$apply();\n                    }));\n\n                    $transitions.onSuccess({to: 'app.**'}, function() {\n                        $scope.isScrollOffsetZero = ($state.current.data || {}).isCollapsingHeader || false;\n                        $scope.hideSearch = $state.includes('app.browse')\n                    });\n\n                    // let isLocked = false;\n                    angular.element(document.getElementById('main-ui-view')).bind('scroll',function () {\n\n                            const lastState = $scope.isScrollOffsetZero;\n                            let newState;\n                           if (this.scrollTop > 50)\n                               newState = false;\n                           else\n                               newState =\n                                   ($state.current.data || {}).isCollapsingHeader || false;\n                        if (newState !== lastState) {\n                            $scope.$evalAsync(() => {\n                                $scope.isScrollOffsetZero = newState;\n                            })\n                            // if (!isLocked) {\n                            //     isLocked = true;\n                            //     $scope.$apply(function () {\n                            //         isLocked = false;\n                            //     });\n                            // }\n                        }\n                    });\n\n                    $scope.$on('$destroy',() => {\n                        angular.element(document.getElementById('main-ui-view')).unbind('scroll');\n                        while (deregs.length)\n                            deregs.pop()();\n                    })\n\n                    $scope.updateCreditButton();\n                }\n            }\n    }]);\nangular\n.module('paladinApp')\n.component('search', {\n  bindings: {\n\n    filter:'='\n  },\n  controller: class FilterComponent {\n\n  constructor($scope,$rootScope,$translate,apiService,enums) {\n    this.scope = $scope;\n    this.rootScope = $rootScope;\n    this.translate = $translate;\n    this.apiService = apiService;\n    this.enums = enums;\n  }\n\n  $onInit() {\n      var _this = this;\n      this.scope.distanceDropDown = [{\n            \"l_id\": 1,\n            \"distance\":1,\n            \"name\": \"VC\"\n          }, {\n            \"l_id\": 2,\n            \"distance\":5,\n            \"name\": \"NB\"\n          }, {\n            \"l_id\": 3,\n            \"distance\":10,\n            \"name\": \"IC\"\n          },\n          {\n            \"l_id\": 4,\n            \"distance\":50,\n            \"name\": \"IA\"\n          },\n          {\n            \"l_id\": 5,\n            \"distance\":200,\n            \"name\": \"FA\"\n          }\n      ];\n      this.scope.distanceRange=200;\n      this.selectedRange={\n                                \"l_id\": 5,\n                                \"distance\":200,\n                                \"name\": \"FA\"\n                              };\n      this.scope.myModelVal= this.scope.distanceDropDown[4];\n\n      this.scope.$on('distanceChanged', function(event, args){\n        if (args) {\n          _this.changeDistanceFilter();\n        }\n        _this.loading = false;\n      });\n\n      this.selectedItem = '';\n\n  }\n\n  initiateSearch(keyword) {\n    if (keyword && keyword != '') {\n        $rootScope.$emit(enums.busNavigation.browseKeyword,{keyword});\n    }\n  }\n\n\nsearchBarOnKeyPress($event) {\n    if ($event.which == 13 && $event.target.value && $event.target.value != '') {\n        this.initiateSearch($event.target.value);\n        $event.preventDefault();\n    }\n  }\n  \n  querySearch(textQuery) {\n    const query = textQuery.toLowerCase();\n    return this.apiService.products.getSuggestions(query)\n        .then((response) => {\n            return [{Rank: Infinity, Keyword: textQuery},...response.Data.sort((a,b) => b.Rank - a.Rank)];\n        })\n  }\n\n  showLocation() {\n    return this.filter.sortBy === this.enums.productsSortOptions.geoLocation;\n  }\n  \n\n  onSelectedSuggestion(item,model,label,event) {\n    this.filter.search.searchStr = item;\n    event.stopPropagation();\n  }\n  onKeyPressed(event, item) {\n\n    if (event.keyCode == 13) {\n      applySearch();\n    } \n\n    if (event.keyCode == 38 || event.keyCode == 40) {\n      this.filter.search.searchStr = item; \n    }\n\n  }\n  \n\n  changeDistanceFilter(){\n      if(this.filter){\n          this.filter.distanceRange=this.selectedRange.distance;\n          this.applySearch();\n      }\n  }\n  applySearch(){\n      this.filter.currentPage =1;\n      this.filter.search.currentSearchStr = this.filter.search.searchStr;\n      this.rootScope.$broadcast('filtersUpdated');\n  }\n  addSuggestionToSearch(suggestion, loadResults) {\n    this.filter.search.searchStr = suggestion;\n    applySearch();\n  }\n  smallScreen() {\n    return window.innerWidth<768;\n  }\n},\n  templateUrl:'./views/templates/search.tpl.html'\n});\nangular\n    .module('paladinApp')\n.component('productlist', {\n  bindings: {\n      filter:'=',\n      pages:'<',\n      totalPages:'<',\n      productsList:'=?',\n      count: '<',\n      isLoading: '=?'\n  },\n  controller: class FilterComponent {\n\n    constructor($scope,$rootScope,$location,Products,ngMeta,pager,$anchorScroll,$translate,enums,ptUtils) {\n        this.rootScope = $rootScope;\n        this.scope = $scope;\n        this.Products=Products;\n        this.profileImageBaseUrl = window.globals.PROFILE_IMAGE_URL;\n        this.productImageBaseUrl = window.globals.PRODUCT_IMAGE_URL;\n        this.ngMeta=ngMeta;\n        this.pager=pager;\n        this.anchorScroll=$anchorScroll;\n        this.translate = $translate;\n        this.location = $location;\n        this.enums = enums;\n        this.ptUtils = ptUtils;\n    }\n    $onInit() {\n      //this.products=[];\n      this.count=0;\n      this.totalPages=0;\n      this.productsList = null;\n      this.isLoading = false;\n  //    this.refreshPageList();      \n      this.anchorScroll.yOffset = 0;\n      this.profileDefaultImage=\"../../assets/profile.png\";  \n\n      //this.onFilterChange(false);\n      var _this = this;\n      this.scope.$on('filtersUpdated', function(event){\n        _this.onFilterChange(false);\n      });\n\n      this.scope.$on('languageChanged', function(event,data){\n        \n        _this.filter.languageCode = data;\n        _this.onFilterChange(false);\n      });\n\n      if (this.rootScope.filter) {\n        this.onFilterChange(false);  \n      }\n\n    }\n\n    updateMetaTags(){\n      this.ngMeta.setTitle(this.getPageTitle());\n      this.ngMeta.setTag('description',this.getMetaTags());\n      this.ngMeta.setTag('imagePath', '../../assets/paladin-logo-300x300.png');\n    }\n\n    getPageTitle(){\n      if (!this.filter.category.selectedCategoryId) \n      {\n        //all categories selected, we put static title\n        return this.translate.instant('HOME_TITLE');\n      }\n      var title = this.translate.instant('RENT')+' ';\n      if(this.filter.category && this.filter.category.selectedCategoryName && !this.filter.category.selectedSubCategoryName){\n        title += this.filter.category.selectedCategoryName;\n      }else if(this.filter.category && this.filter.category.selectedSubCategoryName){\n        title += this.filter.category.selectedSubCategoryName;\n      }\n\n      var placeName =this.filter.glCity;\n      if(placeName){\n        title += this.translate.instant('IN')+' '+placeName.split(',')[0]; \n      }\n\n      return title;\n    }\n\n    getPricePerDayLabel() {\n      return this.translate.instant(window.innerWidth < 768 ? 'PD' : 'PPD');\n    }\n\n   \n    getMetaTags(){\n      if (this.filter.category.selectedCategoryName == this.enums.allCategories[this.filter.languageCode]) {\n        return this.translate.instant(\"DEFAULT_META_DESC\");\n      }\n      var tag = this.translate.instant(\"RENT_AND_LEND\")+' ';\n      if(this.filter.category && this.filter.category.selectedCategoryName){\n        tag += this.filter.category.selectedCategoryName;\n      }else if(this.filter.category && this.filter.category.selectedSubCategoryName){\n        tag += this.filter.category.selectedSubCategoryName;\n      }\n\n      var placeName =this.filter.glCity;\n      if(placeName){\n            tag += this.translate.instant('IN')+' '+placeName.split(',')[0]; \n      }\n      tag+=' ' + this.translate.instant(\"WITH\") + ' Paladin!'\n      return tag;\n    }\n\n    getDistanceLabel(product) {\n\n      return '< ' + Math.ceil(this.getDistanceFromLatLonInKm(product.Product_Latitude, product.Product_Longitude, \n        this.rootScope.filter.search.lat, this.rootScope.filter.search.lng)) + \" \" + this.translate.instant(\"KM_FROM_YOU\");\n      \n    }\n\n    getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\n      var R = 6371; // Radius of the earth in km\n      var dLat = this.deg2rad(lat2-lat1);  // deg2rad below\n      var dLon = this.deg2rad(lon2-lon1); \n      var a = \n        Math.sin(dLat/2) * Math.sin(dLat/2) +\n        Math.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) * \n        Math.sin(dLon/2) * Math.sin(dLon/2)\n        ; \n      var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \n      var d = R * c; // Distance in km\n      return d;\n    }\n    \n    deg2rad(deg) {\n      return deg * (Math.PI/180)\n    }\n\n   navigateToProduct(product) {\n        this.rootScope.$emit(this.enums.busNavigation.productDetailed,{ product });\n   }\n\n    getProductDetailUrl(product){\n      var url = '/';\n\n      if(product){\n\n        url+= this.filter.languageCode ? this.filter.languageCode : '';\n      \n        url+= '/product';\n\n\n        //url+='/'+product.Product_Title.trim().split('-').join('+').split(' ').join('-').split('/').join('^');\n        url+='/'+this.Products.encryptProductURL(product.Product_Id);\n        url+='-' + product.Product_Id;\n\n        /*\n        var placeName = this.filter.glCity;\n        this.rootScope.searchedLocation = placeName;\n        if(placeName){\n          //url+='?searchedLocation='+encodeURIComponent(placeName);\n        }\n\n        if(this.filter.search.searchStr){\n          this.rootScope.q = this.filter.search.searchStr;\n          //url+='&&q='+encodeURIComponent(this.filter.search.searchStr); \n        }\n\n        if(this.filter.category && this.filter.category.selectedCategoryName){\n          if(url.indexOf('?')<0)url+='?';\n\n          //console.log('SEL CAT : '+this.filter.category.selectedCategoryName)\n          this.rootScope.category = this.filter.category.selectedCategoryName.toString().replace(/-/g, ' ');\n          //url += '&&category='+this.filter.category.selectedCategoryName.toString().replace(/\\s+/g, '-');\n        }\n        if(this.filter.category && this.filter.category.selectedSubCategoryName){\n          if(url.indexOf('?')<0)url+='?';\n\n          //console.log('SEL SUBCAT : '+this.filter.category.selectedSubCategoryName)\n          this.rootScope.subcategory =this.filter.category.selectedSubCategoryName.toString().replace(/-/g, ' ');\n         // url += '&&subcategory='+this.filter.category.selectedSubCategoryName.toString().replace(/\\s+/g, '-');\n        }\n      }\n      //console.log('before redirect : '+this.filter.category.selectedCategoryName);\n      */\n      }\n      return url;\n      //return url;\n    }\n\n    goToProductPage(product) {\n      this.location.url(getProductDetailUrl(product));\n    }\n    \n    goTo(pageNumber){\n      this.filter.currentPage = pageNumber;\n      \n      this.onFilterChange(true);       \n    }\n    \n    isFirstPage(){\n      if(this.filter.currentPage==1)return true;\n      return false;\n    }\n\n    setPage(page){\n         if (page>=1 && page <=this.totalPages) {\n           this.filter.currentPage = page;\n           this.refreshPageList();\n           this.onFilterChange(true);   \n         }\n    }\n    refreshPageList() {\n      this.pages = this.pager.GetPager(this.totalPages,this.filter.currentPage,5);\n      this.isLoading = false;\n      this.ngMeta.setTag(\"prevUrl\", undefined);\n      this.ngMeta.setTag(\"nextUrl\", undefined);\n\n      if (this.filter.currentPage > 1) {\n        this.ngMeta.setTag(\"prevUrl\", this.location.absUrl().replace('pageIndex=' + this.filter.currentPage,'pageIndex=' + (this.filter.currentPage-1)));\n      }\n      if (this.filter.currentPage < this.totalPages) {\n        this.ngMeta.setTag(\"nextUrl\", this.location.absUrl().replace('pageIndex=' + this.filter.currentPage,'pageIndex=' + (this.filter.currentPage+1)));\n\n      }\n      // this.rootScope.$broadcast('hideSpinner');\n      \n    }\n\n    scrollToAnchor() {\n\n      var oldAnchor = this.location.hash();\n      this.location.hash(\"breadcrumb\");\n      this.anchorScroll();\n      this.location.hash(oldAnchor);\n    }\n\n    getProductUrl(product) {\n      if (product)\n          return this.ptUtils.getProductDetailUrl(product);\n      return \"#\";\n    }\n\n    isParentCategorySelected() {\n      return this.filter.category.selectedCategoryId && this.filter.category.selectedSubCategoryId == null;\n    }\n\n    onFilterChange(scrollTop){   \n      \n      if (this.rootScope.filter && !this.isParentCategorySelected() && window.innerWidth < 768 || scrollTop) {\n        this.scrollToAnchor();\n      }           \n      // this.rootScope.$broadcast('showSpinner');\n      this.isLoading = true;\n        this.productsList = [];\n      this.updateMetaTags();\n\n\n      this.scope.$evalAsync(() => {\n          this.productsList = [];\n          Promise.all([\n              this.Products.getAll(this.filter),\n              this.Products.getTotalPageCount(this.filter)\n          ])\n              .then((results) => {\n                  this.scope.$evalAsync(() => {\n                      this.isLoading = false;\n                      this.productsList = results[0].data.Data[0];\n                      this.totalPages = results[1].data.Data;\n                      this.refreshPageList()\n                  })\n              })\n              .catch((err) => {\n                  this.scope.$evalAsync(() => {\n                      this.isLoading = false;\n                      this.productsList = [];\n                      this.totalPages = 0;\n                  })\n              });\n      });\n\n    }\n\n    increment() {\n      this.count++;\n    }\n    decrement() {\n      this.count--;\n    }\n    \n  },\n  templateUrl:'./views/templates/product_list.tpl.html'\n})\n\n;\nangular\n.module('paladinApp')\n.component('products', {\n  bindings: {\n    filter:'=',\n    count: '<',\n    loading:'<'\n  },\n  controller:class ProductController {\n\n    constructor($scope,$sce,Filters,$rootScope,enums,ngMeta,$translate,$window,$location){\n      this.scope =$scope;\n      this.sce = $sce;\n      this.Filters = Filters;\n      this.rootScope= $rootScope;\n      this.ngMeta=ngMeta;\n      this.loading=true;\n      this.translate = $translate;\n      this.window = $window ;\n      this.location =$location;\n      this.enums = enums;\n    }\n\n    $onInit() {\n      this.count=0;    \n      this.loading=true; \n      var _this = this;\n      \n\n      this.scope.$on('showSpinner', function(event){\n        \n        _this.loading = true;\n      });\n\n      this.scope.$on('hideSpinner', function(event){\n        \n        _this.loading = false;\n      });\n\n      \n    }\n\n    getCurrentCategory(){\n      \n      \n      return this.translate.instant('ACTG');\n    }\n\n    isNotAllCategory(){\n      return this.filter.category.defaultCategoryName!=this.filter.category.selectedCategoryName \n            && this.filter.category.selectedCategoryName != this.getCurrentCategory();\n    }\n\n    refreshProducts(){      \n      //console.log(\"REFRESH PRODUCTS in products.js\");  \n      this.rootScope.$broadcast('filtersUpdated',this.filter);       \n    }    \n\n    sortBy(sort,code){\n      this.filter.sortBy = sort;\n      this.filter.sortByCode = code;\n      this.filter.currentPage = 1;\n      this.refreshProducts();\n    }\n\n    getBannerImageUrl(){\n      return (this.isNotAllCategory() ? window.globals.CATEGORY_IMAGE_URL : '')\n        + (this.filter.category.selectedSubCategoryBannerImage ? this.filter.category.selectedSubCategoryBannerImage : this.filter.category.selectedCategoryBannerImage);\n    }\n\n    getCategoryDescription(){\n      if (!this.filter.category.selectedCategoryId) {\n        //all categories selected\n        var desc = this.translate.instant('ALL_CATEGORIES_DESC');\n        if (desc.length>0) {\n          return this.sce.trustAsHtml(desc);\n        } else {\n          return null;\n        }\n      } else if (this.filter.category.selectedSubCategoryId != null) {\n        //sub category selected\n        return this.filter.category.selectedSubCategoryDesc;\n      } else {\n        return this.filter.category.selectedCategoryDesc;\n      }  \n    }\n\n    switchCategoryToAll(category){      \n      this.filter.category.selectedCategoryId = null;\n      this.filter.category.selectedCategoryDesc =this.sce.trustAsHtml(this.translate.instant('ACTG'));\n      this.filter.category.selectedCategoryName =this.translate.instant('ACTG');  \n      this.filter.category.selectedCategoryImagePath=null;\n      this.filter.category.selectedCategoryBannerImage = window.globals.IS_PROMO ? this.enums.categoriesBannersPaths.promo : this.enums.categoriesBannersPaths.all[this.translate.use()];\n      this.removeSubCategory();      \n      this.refreshProducts();\n    }\n\n    getH1(){\n      \n      var h1 = '';\n      var selectedCategoryStr = this.filter.category && this.filter.category.selectedSubCategoryName \n        ? this.filter.category.selectedSubCategoryName\n        : this.filter.category.selectedCategoryName;\n\n        \n      h1 += this.isNotAllCategory() ? this.translate.instant('FIND_THE_BEST')+' ' : this.translate.instant('RENT') + ' ';\n        \n      if (this.filter.search.currentSearchStr && this.filter.search.currentSearchStr.length>0) {\n        h1 +=\"\\\"\" + this.filter.search.currentSearchStr + \"\\\"\" + \" \" + this.translate.instant('WITHIN') + \" \";\n      } \n        h1 += selectedCategoryStr;\n\n      var placeName = this.filter.glCity;\n      if(placeName){\n         h1 += this.translate.instant('IN')+' '+placeName.split(',')[0]; \n      } \n      //return this.capitalizeFilter(h1);\n      return h1;\n    }\n\n    getH2(){\n      var h2 = this.translate.instant('RENT_AT_BEST_PRICE')+ ' ';\n\n      if(this.filter.category && this.filter.category.selectedCategoryName && !this.filter.category.selectedSubCategoryName){\n        h2 += this.filter.category.selectedCategoryName;\n      }else if(this.filter.category && this.filter.category.selectedSubCategoryName){\n        h2 += this.filter.category.selectedSubCategoryName;\n      }\n\n      var placeName =this.filter.glCity;\n      if(placeName){\n         h2 += this.translate.instant('IN')+' '+placeName.split(',')[0]; \n      } \n      return h2;\n    }\n    \n    getCategoriesUrl(categoryName, subcategoryName) {\n      return this.Filters.getCategoriesUrl(categoryName, subcategoryName, this.rootScope.isTryAndBuy, this.translate.use());\n    }\n\n\n    removeSubCategory(){      \n      this.filter.category.selectedSubCategoryId = null;\n      this.filter.category.selectedSubCategoryDesc =null;  \n      this.filter.category.selectedSubCategoryName =null;  \n      this.filter.category.selectedSubCategoryImagePath = null;\n      this.filter.category.selectedSubCategoryBannerImage = null;\n    }\n\n    switchMainCategory(){      \n      //here when sub category is implemented make it defaut so only main category will be seen\n      this.removeSubCategory();\n      this.refreshProducts();\n    }\n    switchSubCategory(){\n      this.refreshProducts();\n    }\n    /*goBack(){\n      console.log('GO BACK CLICKED')\n      console.log(this.translate.proposedLanguage())\n      //this.location.url('/');\n      //this.refreshProducts();\n    }*/\n\n  },\n  templateUrl:'./views/templates/products.tpl.html'\n})\n\n;\nangular.module('paladinApp')\n.directive('userAvatar',[function () {\n    return {\n        restrict:'E',\n        scope: {\n            user: '<?',\n            userId: '<?',\n            picSize: '<?',\n            userImage: '<?',\n        },\n        templateUrl:'./views/templates/userAvatar.tpl.html',\n        link: function ($scope, elem, attr) {\n        // <img class=\"userAvatarImage\" ng-if=\"user != null\" ng-src=\"{{user.User_DisplayPicturePath =! null ? (imgServerPath +  user.User_DisplayPicturePath) : '/assets/profile.png'}}\" alt=\"{{::user.User_UserName}}\"/>\n\n            const init = () => {\n                $scope.picSize = $scope.picSize || 30;\n                $scope.picSizeParsed = $scope.picSize + \"px\";\n                $scope.sizeStyle = `width: ${$scope.picSize}px; height: ${$scope.picSize}px;`;\n                $scope.imgServerPath = window.globals.PROFILE_IMAGE_URL;\n                const temp = $scope.userImage;\n                    $scope.userImage = '';\n                    if ($scope.user) {\n                        $scope.userImage = $scope.user.User_DisplayPicturePath;\n                    } else if (temp) {\n                        $scope.userImage = temp;\n                    }\n            };\n\n            init();\n\n\n\n            let deregs = [];\n            deregs.push($scope.$watch('userImage',() => {\n                init();\n            }));\n\n            deregs.push($scope.$watch('user',() => {\n\n                init();\n            }));\n\n            $scope.$on('destroy',() => {\n                while (deregs.length)\n                    deregs.pop()();\n            });\n        }\n    }\n}]);\nangular.module('paladinApp')\n.directive('loaderContainer',[\n    function () {\n        return {\n            restrict: 'E',\n            transclude: true,\n            // scope: {\n            //     isLoading: '=',\n            //     loaderSize: '=?',\n            // },\n            templateUrl:'./views/templates/loaderContainer.tpl.html',\n            link: function ($scope, elem, attr) {\n                $scope.loaderSize = $scope.loaderSize || 50;\n            }\n        }\n    }]);\nangular.module('paladinApp')\n.directive('homeStepsTutorial',['$rootScope','$sce',function ($rootScope,$sce) {\n    return {\n        restrict: 'E',\n        scope: {\n            stepsList: '<', /* strings[]*/\n            imgUrl: '<',\n            tutorialTitle: '<',\n            tutorialDescription:'<',\n        },\n        templateUrl:'./views/templates/homeStepsTutorial.tpl.html',\n        link: function ($scope, elem, attt) {\n            $scope.tutorialTitle = $sce.trustAsHtml($scope.tutorialTitle);\n        }\n    }\n}]);\n// /views/templates/homeStepsTutorial.tpl.html\nangular.module('paladinApp')\n    .directive('productsTeaser',[\n        '$rootScope',\n        'apiService',\n        'enums',\n        'dataService',\n        'appStateManager',\n        'toastService',\n        '$timeout',\n        function (\n            $rootScope,\n            apiService,\n            enums,\n            dataService,\n            appStateManager,\n            toastService,\n            $timeout\n        ) {\n            return {\n                restrict:'E',\n                templateUrl:'./views/templates/productsTeaser.tpl.html',\n                scope: {\n                    customTitle: '<?',\n                    categoryId: '<?',\n                    categoryName: '<?',\n                    subCategoryId: '<?',\n                    categoryDescription: '<?',\n                    descriptionLink:'<?',\n                    isPopularItems:'<?',\n                    isRecentItems: '<?',\n                    isTryAndBuy: '<?',\n                    productIds: '<?',\n                    userId: '<?',\n                    products: '<?',\n                    currentProductId: '<?',\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.isLoading = true;\n                    $scope.isPopularItems = $scope.isPopularItems || false;\n                    $scope.isRecentItems = $scope.isRecentItems || false;\n                    $scope.category = null;\n                    $scope.products = $scope.products || [];\n                    $scope.scrollArrows = { isRightVisible: false,  isLeftVisible: false };\n\n                    const init = () => {\n\n                        if ($scope.products) {\n                            $scope.isLoading = false;\n                            $timeout( () => {\n                                $scope.validateScrollingArrows();\n                            },300);\n                            return;\n                        }\n                            \n\n                        if ($scope.categoryId) {                      \n                            if (!appStateManager.categoriesDict) {\n                                return dataService.getCategories()\n                            }\n                            $scope.category = appStateManager.categoriesDict[$scope.categoryId];\n                        }\n\n                        fetchProducts();\n                    };\n\n                    const getData = () => {\n                        //get products via productID list\n                        if ($scope.products) {\n                            return \n                        }\n                        if ($scope.productIds) {\n                            return apiService.products.getSearchedProducts({\n                                productPerPage: 20,\n                                sortBy: enums.productsSortOptions.bestProduct,\n                                productIDs: $scope.productIds,\n                            });\n                        }\n\n                        if ($scope.isTryAndBuy) {\n                               return apiService.products.getPopularTryAndBuy();\n                        } else if ($scope.userId) {\n                                let requestParams = {\n                                    userId: $scope.userId,\n                                    productsFilter: enums.userProductsFilter.myProductsToBorrow,\n                                };\n                                return apiService.products.getUserProducts(requestParams)\n                                    .then((res) => {\n                                        return {Data:[res.Data.User_AllProducts]}\n                                    })\n                        } else {\n                            \n                            let requestParams = {\n                                productPerPage: 20,\n                            };\n\n                            if ($scope.categoryId) {\n                                requestParams.categoryId = $scope.categoryId;\n                                requestParams.sortBy = enums.productsSortOptions.bestProduct;\n                                if ($scope.subCategoryId) {\n                                    requestParams.subCategoryId = $scope.subCategoryId;\n                                }\n                            } else if ($scope.isPopularItems) {\n                                requestParams.sortBy = enums.productsSortOptions.popularity;\n                            } else if ($scope.isRecentItems) {\n                                requestParams.sortBy = enums.productsSortOptions.recent;\n                            }\n                            return apiService.products.getSearchedProducts(requestParams);\n                        }\n                        // return new Promise((resolve,reject)=> reject('Method not implemented'))\n                    };\n                    const fetchProducts = () => {\n                        $scope.isLoading = true;\n                        getData()\n                            .then((response) => {\n                                $scope.isLoading = false;\n                                $scope.products = response.Data[0].filter((product) => product.Product_Id != $scope.currentProductId);\n                                $timeout( () => {\n                                    $scope.validateScrollingArrows();\n                                },300);\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                                $scope.products = [];\n                            })\n                    };\n\n\n\n                    $scope.onSwipe = (isLeft, $event, $target) => {\n                        // button-overlay -> products-teaser-list-item -> products-teaser-list -> div#productsTeaserList + categoryId\n                        let objToScroll = $target.current.parentElement.parentElement.parentElement;\n                        if (objToScroll) {\n\n\n                            const minScrollOffset = 0,\n                                visibleWidth = objToScroll.clientWidth,\n                                maxScrollOffset = objToScroll.scrollWidth - visibleWidth,\n                                currentOffset = objToScroll.scrollLeft,\n                                itemWidth = $target.current.clientWidth,\n                                itemsInPage = visibleWidth / itemWidth;\n\n\n                            let newScrollTo = isLeft ? currentOffset + (visibleWidth - (itemWidth / itemsInPage) ): currentOffset - (visibleWidth - (itemWidth / itemsInPage) );\n                            if (newScrollTo > maxScrollOffset)\n                                newScrollTo = maxScrollOffset;\n                            else if (newScrollTo < minScrollOffset)\n                                newScrollTo = minScrollOffset;\n\n                            let initialTimes = 30;\n                            let times = 0;\n                            let offset = currentOffset > newScrollTo ? currentOffset - newScrollTo : newScrollTo - currentOffset;\n                            let step = offset / initialTimes;\n                            let lastOffset = currentOffset < newScrollTo ? currentOffset + step : currentOffset - step;\n                            // objToScroll.scrollTo(newScrollTo, objToScroll.scrollTop);\n\n\n                            const id = setInterval(() => {\n                                lastOffset = currentOffset < newScrollTo ? lastOffset + step : lastOffset - step;\n                                objToScroll.scrollTo(lastOffset, objToScroll.scrollTop);\n                                if (times == initialTimes) {\n                                    clearInterval(id);\n                                    $scope.validateScrollingArrows();\n                                }\n                                times++\n                            }, step*0.4);\n\n                        }\n\n\n                    };\n\n                    $scope.onArrowClick = (isLeft) => {\n                        // 'productTeaserItem-' + $scope.products[0].Product_Id\n                        const firstItem = angular.element(document.querySelector(`#productTeaserItem-${$scope.products[0].Product_Id} .products-teaser-list-item-v2 .button-overlay`))[0];\n                        $scope.onSwipe(isLeft,null,{current: firstItem});\n                    };\n\n                    $scope.validateScrollingArrows = () => {\n                        $scope.instantiateScroller();\n                        if ($scope.products.length > 0) {\n                            const firstItem = angular.element(document.querySelector(`#productTeaserItem-${$scope.products[0].Product_Id} .products-teaser-list-item-v2 .button-overlay`))[0];\n                                // if (firstItem) {\n                                    const scroller = angular.element(document.getElementById('productsTeaserList' + ( $scope.categoryId || ($scope.isRecentItems ? 'Recent' : $scope.isPopularItems ? 'Popular' : ''))));\n                                    if (scroller[0]) {\n                                        const visibleWidth = scroller[0].clientWidth,\n                                            maxScrollOffset = scroller[0].scrollWidth - visibleWidth,\n                                            currentOffset = scroller[0].scrollLeft;\n                                        $scope.$evalAsync(() => {\n                                            $scope.scrollArrows.isLeftVisible = Math.round(currentOffset) != 0;\n                                            $scope.scrollArrows.isRightVisible = Math.round(currentOffset) != maxScrollOffset;\n                                        })\n                                    }\n\n                                // }\n\n                        } else {\n                            $scope.$evalAsync(() => {\n                                $scope.scrollArrows.isLeftVisible = false;\n                                $scope.scrollArrows.isRightVisible = false;\n                            })\n                        }\n                    };\n                    $scope.seeAll = () => {\n                        if ($scope.categoryId) {\n                            $rootScope.$emit(enums.busNavigation.browseCategory, {categoryName: $scope.categoryName});\n                        }\n                        else if ($scope.isPopularItems || $scope.isRecentItems)\n                            $rootScope.$emit(enums.busNavigation.browseSort,{sortBy: $scope.isRecentItems ? enums.productsSortOptions.recent : enums.productsSortOptions.popularity});\n                        else if ($scope.userId) {\n                            $rootScope.$emit(enums.busNavigation.userProfile,{userId:$scope.userId})\n                        } else if ($scope.isTryAndBuy != undefined) {\n                            $rootScope.$emit(enums.busNavigation.switchBrowseMode, {isTryAndBuy: $scope.isTryAndBuy})  \n                        }\n\n                    };\n\n                    $scope.getHrefLink = () => {\n                        let href='';\n                \n                        if ($scope.categoryId) {\n                            href = window.globals.ROOT_PATH + appStateManager.currentLang + \"/categorie/\"+ $scope.categoryName;\n                        \n                            // $rootScope.$emit(enums.busNavigation.userProfile,{userId:$scope.userId})\n                        } else if ($scope.isTryAndBuy != undefined) {\n                            href = window.globals.ROOT_PATH + appStateManager.currentLang + \"/categorie/\"+ \n                                    ($scope.isTryAndBuy ? '' : \"privato/\") +\n                                    (appStateManager.currentLang == 'it'? \"Tutte-le-Categorie\" : \"All-Categories\")+ \"?sortBy=SortByBestProduct&pageIndex=1\";\n                        } else if ($scope.userId) {\n\n                        }\n\n                        return href.length > 0 ? href.split(' ').join('-') : \"javascript:void(0);\";\n                    }\n\n                    $scope.instantiateScroller = () => {\n                        if (!$scope.scroller) {\n                            $scope.scroller = angular.element(document.getElementById('productsTeaserList' + ( $scope.categoryId || ($scope.isRecentItems ? 'Recent' : $scope.isPopularItems ? 'Popular' : ''))));\n\n                            $scope.scroller.bind('resize',function () {\n                                $scope.validateScrollingArrows();\n                            });\n                        }\n                    };\n\n                    let deregs = [];\n\n\n                    deregs.push($rootScope.$on(enums.busEvents.categoriesUpdate,(event,data) => {\n                        init();\n                    }));\n\n\n                    $scope.$on('$destroy',function () {\n                        if ($scope.scroller)\n                            $scope.scroller.unbind('resize');\n                        while (deregs.length)\n                            deregs.pop()();\n                    });\n                    init();\n                }\n            }\n        }]);\nangular.module('paladinApp')\n.directive('lazyLoading',[function () {\n    return {\n        restrict:'A',\n        link: function ($scope, elem, attr) {\n\n            /*We build sourceSet based on sizes: \n                Product: 100w,200w,300w,400w,500w\n                Profile: 100w,300w,500w\n                */\n            const buildSourceSet = (imagePath, isProfile) => {\n                let sourceSet = '';\n                for (var index = 1; index <= 5; index++) {\n                    if (isProfile && index%2 == 0) continue;  \n                    sourceSet = sourceSet + imagePath + attr.lazyLoading + \"_\"+index+\"00 \"+index+\"00w, \";   \n                }\n                if (sourceSet.length > 0)\n                    sourceSet = sourceSet + imagePath + attr.lazyLoading + \" 600w\";\n                    \n                return sourceSet;           \n            }\n            angular.element(elem)[0].src = '/assets/empty-image.png';\n\n            const getImagePath = () => {\n                let imagePath = '';\n                if (attr.imageType) {\n                    if  (attr.imageType == \"product\") {\n                        imagePath = window.globals.PRODUCT_IMAGE_URL;\n                    } else if (attr.imageType == \"profile\") {\n                        if (attr.lazyLoading.length > 0) \n                            imagePath = window.globals.PROFILE_IMAGE_URL;\n                        else imagePath = '/assets/profile.png';\n                    }\n                }\n                return imagePath;\n            }\n            \n            \n            function loadImg(changes){\n                changes.forEach(change => {\n                    if(change.intersectionRatio > 0){\n                        const imagePath = getImagePath();\n                        change.target.src = imagePath + attr.lazyLoading;\n                        if (attr.imageType && (attr.imageType == \"product\" \n                        || attr.imageType == \"profile\" && attr.lazyLoading.length > 0)) {\n                            change.target.srcset= buildSourceSet(imagePath, attr.imageType == \"profile\"); \n                        }\n                    }   \n                })\n            }    \n\n            const observer = new IntersectionObserver(loadImg)\n            const img = angular.element(elem)[0];\n            observer.observe(img)\n\n        }\n    }\n}]);\nangular.module('paladinApp')\n    .directive('profileImage',[function () {\n        return {\n            restrict:'A',\n            link: function ($scope, elem, attr) {\n                const update = () => {\n                    if (elem && elem[0]) {\n                        if (attr.profileImage == '')\n                            elem[0].src = '/assets/profile.png';\n                        else\n                            elem[0].src = window.globals.PROFILE_IMAGE_URL + attr.profileImage;\n                    }\n                };\n\n                update();\n\n\n                let deregs = [];\n\n                deregs.push($scope.$watch('profileImage',() => {\n                    update();\n                }));\n\n                $scope.$on('$destroy',() => {\n                    while (deregs.length)\n                        deregs.pop()();\n                })\n\n            }\n        }\n    }]);\nangular.module('paladinApp')\n.directive('productTeaserListItem',['$rootScope','enums','ptUtils', function ($rootScope,enums, ptUtils) {\n    return {\n        restrict:'E',\n        scope: {\n            product:'<',\n            onSwipe: '&',\n        },\n        templateUrl:'./views/templates/productTeaserListItem.tpl.html',\n        link: function ($scope, elem, attr) {\n            $scope.onItemClick = () => {\n                $rootScope.$emit(enums.busNavigation.productDetailed,{product: $scope.product})\n            };\n\n            $scope.getProductUrl = () => {\n                if ($scope.product)\n                    return ptUtils.getProductDetailUrl($scope.product);\n                return \"#\";\n            }\n\n            \n            $scope.onItemSwipe = (isLeft,$event,$target) => {\n              if ($scope.onSwipe)\n                  $scope.onSwipe()(isLeft,$event,$target);\n            }\n        }\n    }\n}]);\nangular.module('paladinApp')\n    .directive('ratingView', [function () {\n        return {\n            restrict: 'E',\n            scope: {\n                rating: '=',\n                count: '<?',\n                readOnly: '<?',\n                onRating: '&'\n            },\n            templateUrl: './views/templates/ratingView.tpl.html',\n            link: function ($scope, elem, attrs) {\n                \n                $scope.onRatingSet = (rating) => {\n                    if ($scope.onRating)\n                        $scope.onRating({rating: rating});\n                }\n            }\n        }\n    }]);\nangular.module('paladinApp')\n    .directive('userItem',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        function (\n            $rootScope,\n            enums,\n            appStateManager) {\n\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/userItem.tpl.html',\n                scope: {\n                    userId: '=?',\n                    userName:'=?',\n                    userImage: '=?',\n                    reviews: '=?',\n                    stars: '=?',\n                    picSize: '=?',\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.picSize = $scope.picSize || 50;\n                    $scope.goToProfile = () => {\n                        if ($scope.userId)\n                            $rootScope.$emit(enums.busNavigation.userProfile,{userId: $scope.userId})\n                    }\n                }\n            }\n\n        }]);\nangular.module('paladinApp')\n.directive('reviewsList',[\n    '$rootScope',\n    'appStateManager',\n    function ($rootScope,\n              appStateManager) {\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/reviewsList.tpl.html',\n                scope: {\n                    reviews:'=',\n                },\n                link: function ($scope, elem, attr) {\n                }\n            }\n    }]);\nangular.module('paladinApp')\n.directive('reviewsListItem',[\n    '$rootScope',\n    function ($rootScope) {\n        return {\n            restrict: 'E',\n            templateUrl:'./views/templates/reviewsListItem.tpl.html',\n            scope: {\n                review:'=',\n            },\n            link: function ($scope, elem, attr) {\n\n            }\n        }\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('rentalRequestPicker', [\n        '$rootScope',\n        'appStateManager',\n        'enums',\n        'apiService',\n        'moment',\n        '$translate',\n        'ptUtils',\n        'gtmService',\n        function (\n            $rootScope,\n            appStateManager,\n            enums,\n            apiService,\n            moment,\n            $translate,\n            ptUtils,\n            gtmService,\n        ) {\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/rentalRequestPicker.tpl.html',\n                scope: {\n                    product: '=',\n                    productBookingDetails: '=',\n                    onRequestRent: '&',\n                    onDatesUpdated: '&',\n                },\n                link: function ($scope, elem, attr) {\n                    console.log('rentalRequestPicker: ', elem[0].id);\n\n                    $scope.userCredit = null;\n\n                    $scope.calculatePrice = (isShowErrorOnFaiure = true) => {\n                        $scope.statusError = undefined;\n\n                        let calculateTransactionPrice = () => {\n                            ptUtils.calculatePricingListForProduct(\n                                $scope.startDate,\n                                $scope.endDate,\n                                $scope.product,\n                                $scope.productBookingDetails,\n                                true,\n                                $scope.userCredit\n                            )\n                                .then((prices) => {\n                                    $scope.$evalAsync(() => {\n                                        $scope.statusError = undefined;\n                                        $scope.prices = prices\n                                    })\n                                })\n                                .catch((err) => {\n                                    $scope.$evalAsync(() => {\n                                        $scope.prices = [];\n                                        if (isShowErrorOnFaiure) {\n                                            if (err && err.message) {\n                                                $scope.statusError = err.message;\n                                            }\n                                        }\n                                    })\n                                })\n                        };\n\n                        // TODO: Refactor this and make sure credit is not requested more than necessary\n                        // maybe move the credit object to appStateManager\n\n                        let userId = appStateManager.getUserId();\n                        if (userId) {\n                            apiService.users.getUserCredit({userId})\n                                .then((result) => {\n                                    $scope.userCredit = result.Data;\n                                    calculateTransactionPrice();\n                                })\n                                .catch((err) => {\n                                    console.error('getuserCredit failed ', err)\n                                })\n                        }\n                    };\n                    $scope.bookingPickerId = attr.id + '-bookingPicker';\n\n                    $scope.init = () => {\n                        // const dates = ptUtils.getProductFirstAvailableDatesToRent($scope.productBookingDetails);\n                        $scope.statusError = undefined;\n                        $scope.startDate = undefined; //dates.startDate;\n                        $scope.endDate = undefined; //dates.endDate;\n                        $scope.calculatePrice(false);\n                    };\n                    // scope.validateDates = () => {\n                    //\n                    // };\n                    $scope.onDatesSelected = ({startDate, endDate}) => {\n                        if ($scope.startDate != startDate || $scope.endDate != endDate) {\n                            $scope.startDate = startDate;\n                            $scope.endDate = endDate;\n                            $scope.calculatePrice();\n\n                            if ($scope.onDatesUpdated)\n                                $scope.onDatesUpdated()\n                                ({\n                                    startDate: $scope.startDate,\n                                    endDate: $scope.endDate,\n                                    componentId: elem[0].id,\n                                })\n                        }\n                    };\n\n                    $scope.onBuyBtnClicked = () => {\n                        $rootScope.$emit(enums.busNavigation.paymentDetailed,{\n                            productId: $scope.product.Product_Id,\n                            purchase: true\n                        })                    \n                    }\n\n                    $scope.onRequestRentBtnClicked = () => {\n                        if ($scope.prices == undefined || $scope.prices.length == 0) {\n                            $scope.$$postDigest(() => {\n                                angular.element(document.querySelector(`#${elem[0].id} #desktopPicker span.md-select-value`))[0].click();\n                            })\n                            return;\n                        }\n                        $scope.onRequestRent()\n                        ({\n                            startDate: $scope.startDate,\n                            endDate: $scope.endDate,\n                            componentId: elem[0].id,\n                        });\n\n                        gtmService.trackEvent('booking', 'request-now-button-post-calendar', 'productDetailpage', 'value');\n\n                    };\n\n                    $scope.init();\n\n                    let deregs = [];\n\n                    deregs.push($rootScope.$on(enums.busEvents.rentalRequestPickerUpdateDates, (event, data) => {\n                        if (data && data.startDate && data.endDate && data.componentId == elem[0].id) {\n                            $scope.onDatesSelected(data);\n                        }\n                    }));\n\n                    $scope.$on('$destroy', () => {\n                        while (deregs.length)\n                            deregs.pop()();\n                    })\n                }\n            }\n        }]);\n\nangular.module('paladinApp')\n.directive('rentalRequestHowTo',[function () {\n    return {\n        restrict: 'E',\n        templateUrl: './views/templates/rentalRequestHowTo.tpl.html',\n        scope: {\n            isTryAndBuy: '=?',\n            isBuy: '=?',\n        },\n        link: function ($scope, elem, attr) {\n\n        }\n    }\n}]);\nangular.module('paladinApp')\n    .directive('bookingDatePicker',[\n        '$rootScope',\n        'moment',\n        'popupService',\n        'ptUtils',\n        '$mdMedia',\n        function ($rootScope,moment,popupService,ptUtils,$mdMedia) {\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/bookingDatePicker.tpl.html',\n                scope: {\n                    resultCallback: '&',\n                    defaultValue: '=?',\n                    startDate: '=?',\n                    endDate:'=?',\n                    dateRange: '=?',\n                    productBookingDetails: '=?',\n                    product:'=?'\n                },\n                link: function ($scope, elem, attr) {\n                    // const dates = ptUtils.getProductFirstAvailableDatesToRent($scope.productBookingDetails);\n                    \n                    const updateDateRanges = () => {\n                        if ($scope.productBookingDetails != null) {\n                            dateRanges = ptUtils.getBookedDateRanges($scope.productBookingDetails);\n                        } \n                    }\n                    \n                    let dateRanges = []; \n                    updateDateRanges();\n\n                    $scope.isDateAvailable = ($date) => {\n                        const momentDate = moment($date);\n                        for (let i = 0; i < dateRanges.length ; i++)\n                            if (momentDate.isBetween(dateRanges[i].startDate,dateRanges[i].endDate) ||\n                                momentDate.isSame(dateRanges[i].startDate) ||\n                                momentDate.isSame(dateRanges[i].endDate))\n                                return true;\n\n                        if (moment().isBefore($date)) return false; // TODO: - Check if product available for rent at dates\n\n                        return true;\n                    };\n                    $scope.startDate = $scope.startDate || undefined;\n                    $scope.endDate = $scope.endDate || undefined;\n                    $scope.dateRange = {};\n\n                    $scope.advancedModel = { selectedTemplate: 'Last 3 Days' };\n                    $scope.pickerModel = {\n                        selectedTemplate:\tfalse,\n                        dateStart: $scope.startDate,\n                        dateEnd: undefined,\n                    };\n\n                    $scope.pickerTranslations = ptUtils.getTranslationDictForDatePicker();\n\n                    $scope.selectDate = () => {\n                        if (!$mdMedia('gt-sm')) {\n                            popupService.showDateRangePicker($scope.productBookingDetails, $scope.product)\n                                .then((data) => {\n                                    if ($scope.resultCallback) {\n                                        $scope.resultCallback()({\n                                            startDate: moment(data.dateStart),\n                                            endDate: moment(data.dateEnd),\n                                        });\n                                    }\n                                })\n                                .catch(() => console.log('canceled date picking'))\n                        } else {\n                            $scope.$$postDigest(() => {\n                                angular.element(document.querySelector(`#${elem[0].id} #desktopPicker span.md-select-value`))[0].click();\n                            })\n                        }\n                    };\n                    $scope.onDesktopSelect = ($dates) => {\n                        if ($dates && $dates.length > 0) {\n                            const dateStart = moment($dates[0]);\n                            const dateEnd = moment($dates[$dates.length - 1]);\n                            $scope.pickerModel.dateStart = undefined;\n                            $scope.pickerModel.dateEnd = undefined;\n                            if ($scope.resultCallback) {\n                                $scope.resultCallback()({\n                                    startDate:moment(dateStart),\n                                    endDate: moment(dateEnd),\n                                });\n                            }\n                        }\n                    }\n\n\n                    // deregs.push($scope.$watchGroup([\n                    //     'startDate',\n                    //     'endDate'\n                    // ],function () {\n                    //     // $scope.pickerModel.dateStart = undefined;\n                    //     // $scope.pickerModel.dateEnd = undefined;\n                    // }));\n                    let deregs = [];\n\n                    deregs.push($scope.$watch('productBookingDetails',() => {\n                        updateDateRanges();\n                    }));\n\n                    $scope.$on('$destroy', () => {\n                        while (deregs.length)\n                            deregs.pop()();\n                    })\n                }\n            }\n        }]);\nangular.module('paladinApp')\n    .directive('userListingsListItem',[\n        '$rootScope',\n        'enums',\n        function (\n            $rootScope,\n            enums) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/userListingsListItem.tpl.html',\n                scope: {\n                    product: '<',\n                    isMinified: '=?'\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.isMinified = $scope.isMinified || false;\n                }\n            }\n        }]);\nangular.module('paladinApp')\n    .directive('userListingsList',[\n        '$rootScope',\n        'enums',\n        'apiService',\n        function ($rootScope,\n                  enums,\n                  apiService) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/userListingsList.tpl.html',\n                scope: {\n                    userId: '=',\n                    isMinified: '=?',\n                },\n                link: function ($scope, elem, att) {\n                    $scope.isMinified = $scope.isMinified || false;\n                    $scope.isLoading = false;\n                    $scope.userProducts = [];\n                    $scope.fetchUserListings = () => {\n                        $scope.isLoading = true;\n                        apiService.products.getUserProducts({\n                            productsFilter: enums.userProductsFilter.lentProduct,\n                            userId: $scope.userId,\n                        })\n                            .then((res) => {\n                                $scope.userProducts = res.Data.User_AllProducts;\n                                $scope.isLoading = false;\n                            })\n                    };\n\n                    $scope.listItemClick = (product) => {\n                        $rootScope.$emit(enums.busNavigation.productDetailed,{ product })\n                    };\n\n                    $scope.fetchUserListings();\n                }\n            }\n        }]);\nangular.module('paladinApp')\n    .directive('productStatusLabel',[\n        '$rootScope',\n        'enums',\n        'ptUtils',\n        function (\n            $rootScope,\n            enums,\n            ptUtils) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/productStatusLabel.tpl.html',\n                scope: {\n                    statusId: '=',\n                },\n                link: function ($scope, elem, attr) {\n                    /*\n                      \"PRODUCT_STATUS_REQUESTED\": \"Requested\",\n                      \"PRODUCT_STATUS_ACCEPTED\": \"Accepted\",\n                      \"PRODUCT_STATUS_CANCELED\": \"Canceled\",\n                      \"PRODUCT_STATUS_DECLINED\": \"Declined\",\n                      \"PRODUCT_STATUS_TIMEOUT\": \"Timeout\",\n                      \"PRODUCT_STATUS_STARTED\": \"Started\",\n                      \"PRODUCT_STATUS_ENDED\": \"Ended\"\n\n                '50': '#69C187', //available,\n                '100': '#fb814a', // requested\n                '200': '#ee4e4a', // timeout / canceled (pre accept) / canceled by lender / canceled by borrower / declined\n                '300': '#4ec07e', // accepted\n                '400': '#0d87f6', // started\n                '500': '#8d72f4', // ended\n                'A100': '#fff', // not in use (must have for palette definition)\n                'A200': '#fff', // not in use (must have for palette definition)\n                'A400': '#fff', // not in use (must have for palette definition)\n                'A700': '#fff', // not in use (must have for palette definition)\n                    */\n                    $scope.setDataForStatusId = () => {\n                        let {\n                            text,\n                            color\n                        } = ptUtils.getDisplayDataForTransactionStatus($scope.statusId);\n                        $scope.mainColor = color;\n                        $scope.statusLabel = text;\n                    };\n\n                    $scope.setDataForStatusId();\n\n                }\n            }\n        }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('bookingListItem',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        function ($rootScope,\n                  enums,\n                  appStateManager) {\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/bookingsListItem.tpl.html',\n                scope: {\n                    booking: '=',\n                    isLent: '=?',\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.isLent = appStateManager.getUserId() == $scope.booking.Lender_Id;\n                }\n            }\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('bookingTrackerInfo',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        'ptUtils',\n        '$sce',\n        '$translate',\n        'productReviewService',\n        function (\n            $rootScope,\n            enums,\n            appStateManager,\n            apiService,\n            ptUtils,\n            $sce,\n            $translate,\n            productReviewService) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/bookingTrackerInfo.tpl.html',\n                scope: {\n                    booking:'=',\n                },\n                link: function ($scope, elem, attr) {\n\n                    const getTutorialHTMLTemplate = (translationId) => {\n                        return ptUtils.parseBookingStepTutorialHTMLTemplateForTranslationId(translationId);\n                    };\n\n                    $scope.getStaticBookingStepsP2P = (isLender) => {\n\n                        if (isLender) {\n                            return [\n                                {\n                                    label:'BOOKING_TRACK_INFO_REQUEST_RECEIVED',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusRequested_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.requested]\n                                },\n                                {\n                                    label : 'BOOKING_TRACK_INFO_REQUEST_ACCEPTED',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusAccepted_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.accepted]\n                                },\n                                {\n                                    label: 'BOOKING_TRACK_INFO_START',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusStarted_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.started]\n                                },\n                                {\n                                    label: 'BOOKING_TRACK_INFO_END',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusEnded_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.ended]\n                                }\n                            ]\n                        } else {\n\n                          return [\n                              {\n                                  label:'BOOKING_TRACK_INFO_CARD_VERIFICATION',\n                                  status: enums.trackingStep.failure,\n                                  description: getTutorialHTMLTemplate('BookingStatusNotVerified_Borrower'),\n                                  date: undefined,\n                                  isCurrent: true,\n                                  rentalStatus: [enums.productRentalStatus.verified, enums.productRentalStatus.verifying]\n                              },\n                              {\n                                  label:'BOOKING_TRACK_INFO_REQUEST_SENT',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusRequested_Borrower'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.requested]\n                              },\n                              {\n                                  label:'BOOKING_TRACK_INFO_AWAIT_ACCEPT',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusAccepted_Borrower'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.accepted]\n                              },\n                              {\n                                  label: 'BOOKING_TRACK_INFO_START',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusStarted_Borrower'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.started]\n                              },\n                              {\n                                  label: 'BOOKING_TRACK_INFO_END',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusEnded_Borrower'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.ended]\n                              }\n                          ]\n                        }\n                    };\n\n                    $scope.getStaticBookingStepsTnB = (isLender) => {\n                        //lender steps\n                        if (isLender) {\n                            return [\n                                {\n                                    label:'BOOKING_TRACK_INFO_BOOKED',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusBooked_Borrower'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.booked]\n                                },\n                                {\n                                    label: 'BOOKING_TRACK_INFO_START',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusStarted_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.started]\n                                },\n                                {\n                                    label: 'BOOKING_TRACK_INFO_END',\n                                    status: enums.trackingStep.pending,\n                                    description: getTutorialHTMLTemplate('BookingStatusEnded_Lender'),\n                                    date: undefined,\n                                    isCurrent: false,\n                                    rentalStatus: [enums.productRentalStatus.ended]\n                                }\n                            ]\n                        //borrower steps    \n                        } else {\n\n                          return [\n                              {\n                                  label:'BOOKING_TRACK_INFO_CARD_VERIFICATION',\n                                  status: enums.trackingStep.failure,\n                                  description: getTutorialHTMLTemplate('BookingStatusNotVerified_Borrower_TnB'),\n                                  date: undefined,\n                                  isCurrent: true,\n                                  rentalStatus: [enums.productRentalStatus.verified, enums.productRentalStatus.verifying]\n                              },\n                              {\n                                label:'BOOKING_TRACK_INFO_BOOKED',\n                                status: enums.trackingStep.pending,\n                                description: getTutorialHTMLTemplate('BookingStatusBooked_Borrower'),\n                                date: undefined,\n                                isCurrent: false,\n                                rentalStatus: [enums.productRentalStatus.booked]\n                              },\n                              {\n                                  label: 'BOOKING_TRACK_INFO_START',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusStarted_Borrower_TnB'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.started]\n                              },\n                              {\n                                  label: 'BOOKING_TRACK_INFO_END',\n                                  status: enums.trackingStep.pending,\n                                  description: getTutorialHTMLTemplate('BookingStatusEnded_Borrower_TnB'),\n                                  date: undefined,\n                                  isCurrent: false,\n                                  rentalStatus: [enums.productRentalStatus.ended]\n                              }\n                          ]\n                        }\n                    };\n                    // Lender steps\n                    // Request received\n                    // Request Accepted\n                    // Start Rental (chat)\n                    // End Rental (chat)\n\n\n                    // Borrower steps\n                    // Card Verification\n                    // ID Verification\n                    // Request sent\n                    // await accept\n                    // Start Rental (chat)\n                    // End Rental (chat)\n\n                    let trackId = null;\n                    let cases = [\n                        enums.productRentalStatus.timeout,\n                        enums.productRentalStatus.denied,\n                        enums.productRentalStatus.canceled,\n                        enums.productRentalStatus.criticalCancel,\n                        enums.productRentalStatus.moderateCancel\n                    ];\n\n                    $scope.setStaticStepAtIndexAsCurrent = (staticSteps,atIndex) => {\n                        staticSteps.forEach((step,index) => {\n                            step.isCurrent = index === atIndex;\n                        })\n                    };\n                    $scope.getCurrentStep = () => {\n                        return $scope.steps.find((item) => item.isCurrent == true)\n                    };\n                    $scope.updateSteps = (staticSteps) => {\n                        let statuses = $scope.booking.BookingStatus;\n                        //special handling for Verifying status\n                        if (statuses[statuses.length-1].Status_TrackId == enums.productRentalStatus.verifying) {\n                            let currentStatus = statuses[statuses.length-1];\n                            staticSteps[0].status = enums.trackingStep.pending;\n                            staticSteps[0].date = ptUtils.stringToDate(`${currentStatus.CreatedDate} ${currentStatus.CreatedTime}`);\n                            staticSteps[0].label = 'BOOKING_TRACK_INFO_ID_VERIFICATION';\n                            staticSteps[0].description = getTutorialHTMLTemplate('BookingStatusVerifying_Borrower');\n                            $scope.setStaticStepAtIndexAsCurrent(staticSteps,0);\n                            return staticSteps;\n                        }\n                        for (let i = 0; i < statuses.length; i++) {\n                            let currentStatus = statuses[i];\n                            //lookup static step matching the status and update date and status\n                            for (let j = 0; j < staticSteps.length; j++) {\n                                if (staticSteps[j].rentalStatus.includes(currentStatus.Status_TrackId)) {\n                                    staticSteps[j].status = enums.trackingStep.success;\n                                    staticSteps[j].date = ptUtils.stringToDate(`${currentStatus.CreatedDate} ${currentStatus.CreatedTime}`);\n                                    //if its the last status, show description\n                                    if (i == statuses.length-1) {\n                                        $scope.setStaticStepAtIndexAsCurrent(staticSteps, j);\n                                    }\n                                    break;\n                                }\n                            }\n                        }\n\n                        return staticSteps\n                    };\n\n                    $scope.init = () => {\n                        $scope.userId = appStateManager.getUserId();\n                        $scope.isLender = $scope.userId == $scope.booking.Lender_Id;\n                        $scope.isTryAndBuy = $scope.booking.IsTryAndBuy;\n                        let steps = angular.copy($scope.booking.IsTryAndBuy \n                            ? $scope.getStaticBookingStepsTnB($scope.isLender)\n                            : $scope.getStaticBookingStepsP2P($scope.isLender) \n                        );\n                        $scope.steps = $scope.updateSteps(steps);\n                    };\n\n                    $scope.init();\n                }\n            }\n        }\n    ]);\n\n'use strict';\nangular.module('paladinApp')\n    .directive('bookingDetailedStatus',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        'ptUtils',\n        function ($rootScope,\n                  enums,\n                  appStateManager,\n                  apiService,\n                  ptUtils) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/bookingDetailedStatus.tpl.html',\n                scope: {\n                    booking: '=',\n                    // productBookingDetails: '=',\n                    // product: '='\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.prices = [];\n                    $scope.youWontBeChargedText = undefined;\n\n                    const init = () => {\n\n                        if ($scope.booking && $scope.booking.BookingStatus && $scope.booking.BookingStatus.length > 0)\n                            $scope.youWontBeChargedText =\n                                $scope.booking.BookingStatus[$scope.booking.BookingStatus.length - 1].Status_TrackId == enums.productRentalStatus.requested ?\n                                'YOU_WONT_BE_CHARGED_MSG':\n                                undefined;\n\n                        // Booking_PickupProduct\n                        // FullEndDate\n                        // FullStartDate\n                        // Discount\n                        // ptUtils.calculatePricingListForProduct($scop)\n\n                        ptUtils.calculatePriceingListForBooking($scope.booking)\n                            .then((prices) => {\n                                $scope.$evalAsync(() => {\n                                    $scope.prices = prices;\n                                })\n                            })\n                    };\n\n                    init();\n                }\n            }\n        }\n    ])\n'use strict';\nangular.module('paladinApp')\n    .directive('bookingDetailedCtaButton',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        'ptUtils',\n        'toastService',\n        'ptLog',\n        'transactionService',\n        'productReviewService',\n        function ($rootScope,\n                  enums,\n                  appStateManager,\n                  apiService,\n                  ptUtils,\n                  toastService,\n                  ptLog,\n                  transactionService,\n                  productReviewService) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/bookingDetailedCTAButton.tpl.html',\n                scope: {\n                    booking: '='\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.btns = [];\n\n                    const getTextAndCTAforTransactionStatus = (status,isLender,booking,isTryAndBuy) => {\n                        $scope.btns = [];\n                        switch (status) {\n                            case enums.productRentalStatus.notVerified: {\n                                if (!isLender) {\n                                    $scope.btns.push({ // Verify ID\n                                        text: 'VERIFY_ID',\n                                        BL: (booking) => {\n                                            $rootScope.$emit(enums.busNavigation.idVerification,{bookingId:booking.Booking_Id});\n                                        },\n                                        isEnabled: true,\n                                    })\n                                }\n                                break;\n                            }\n                            case enums.productRentalStatus.requested: {\n                                if (!isLender) {\n                                    $scope.btns.push({ // Cancel Request\n                                        text: 'CANCEL_REQUEST',\n                                        BL: (booking) => transactionService.rejectRental(booking,false) ,\n                                        isEnabled: true,\n                                        isDestructive: true,\n                                    })\n                                } else {\n                                    $scope.btns.push({\n                                        text: 'DECLINE_REQUEST',\n                                        BL: (booking) => transactionService.rejectRental(booking,true),\n                                        isEnabled: true,\n                                        isDestructive: true,\n                                    });\n                                    $scope.btns.push({\n                                        text: 'ACCEPT_REQUEST',\n                                        BL: (booking) => transactionService.acceptRental(booking),\n                                        isEnabled: true,\n                                    });\n\n                                }\n                                break;\n                            }\n\n                            case enums.productRentalStatus.canceled: {\n                                if (!isLender) {\n                                    $scope.btns.push({\n                                        text: 'REQUEST_AGAIN',\n                                        BL: (booking) => $rootScope.$emit(enums.busNavigation.productDetailed,{product: booking}),\n                                        isEnabled: true,\n                                    })\n                                }\n                                break;\n                            }\n                            case enums.productRentalStatus.accepted: {\n                                if (!isLender) {\n                                    $scope.btns.push({\n                                        text: 'CANCEL_BOOKING',\n                                        BL:(booking) => transactionService.cancelRental(booking,false),\n                                        isEnabled: true,\n                                        isDestructive: true,\n                                    });\n                                    $scope.btns.push({\n                                        text: 'START_RENTAL',\n                                        BL:(booking) => transactionService.startRental(booking),\n                                        isEnabled: true,\n                                    });\n                                } else {\n                                    $scope.btns.push({\n                                        text: 'CANCEL_BOOKING',\n                                        BL:(booking) => transactionService.cancelRental(booking,true),\n                                        isEnabled: true,\n                                        isDestructive: true,\n                                    });\n                                }\n                                break;\n                            }\n\n                            case enums.productRentalStatus.timeout: {\n                                if (!isLender) {\n                                    if (booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByBorrower &&\n                                        booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByBoth) {\n                                        $scope.btns.push({\n                                            text: 'REVIEW_LENDER',\n                                            BL: (booking) => productReviewService.startReviewFlow(booking, true),\n                                            isEnabled: true,\n                                        });\n                                    } else {\n\n                                        $scope.btns.push({\n                                            text: 'REQUEST_AGAIN',\n                                            BL: (booking) => $rootScope.$emit(enums.busNavigation.productDetailed,{product: booking}),\n                                            isEnabled: true,\n                                        });\n                                    }   \n                                }\n                                break;\n                            }\n\n                            case enums.productRentalStatus.denied: {\n                                $scope.btns.push({\n                                    text: 'REQUEST_AGAIN',\n                                    BL: (booking) => $rootScope.$emit(enums.busNavigation.productDetailed,{product: booking}),\n                                    isEnabled: true,\n                                });\n                             \n                                break;\n                            }\n                            case enums.productRentalStatus.canceledByLender: {\n                                if (!isLender && !isTryAndBuy) {\n                                    $scope.btns.push({\n                                        text: 'REVIEW_LENDER',\n                                        BL: (booking) => productReviewService.startReviewFlow(booking, true),\n                                        isEnabled: true,\n                                    });\n                                }\n                                break;\n                            }\n                            case enums.productRentalStatus.criticalCancel:\n                            case enums.productRentalStatus.moderateCancel: {\n                                if (isLender) {\n                                    $scope.btns.push({\n                                        text: 'REVIEW_BORROWER',\n                                        BL: (booking) => productReviewService.startReviewFlow(booking, false),\n                                        isEnabled: true,\n                                    });\n                                }\n                                break;\n                            }\n                            case enums.productRentalStatus.started: {\n                                if (isLender) {\n                                    $scope.btns.push({\n                                        text: 'END_RENTAL',\n                                        BL: (booking) => transactionService.endRental(booking),\n                                        isEnabled: true,\n                                    })\n                                } else if (isTryAndBuy) {\n                                    $scope.btns.push({\n                                        text: 'BUY_NOW',\n                                        BL: (booking) => $rootScope.$emit(enums.busNavigation.paymentDetailed,{productId: booking.Product_Id,  purchase: true, bookingId: booking.Booking_Id}),\n                                        isEnabled: true,\n                                    })\n                                }\n                                break;\n                            }\n                            case enums.productRentalStatus.ended: {\n                                    if (!isLender) {\n                                        if (booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByBorrower &&\n                                            booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByBoth) {\n                                                $scope.btns.push({\n                                                    text: 'REVIEW_LENDER',\n                                                    BL: (booking) => productReviewService.startReviewFlow(booking, true),\n                                                    isEnabled: true,\n                                                });\n                                        } else {     \n                                            $scope.btns.push({\n                                                text: 'REQUEST_AGAIN',\n                                                BL: (booking) => $rootScope.$emit(enums.busNavigation.productDetailed,{product: booking}),\n                                                isEnabled: true,\n                                            });\n                                        }\n                                        if (isTryAndBuy) {\n                                            $scope.btns.push({\n                                                text: 'BUY_NOW',\n                                                BL: (booking) => $rootScope.$emit(enums.busNavigation.paymentDetailed,{ productId: booking.Product_Id, purchase: true, bookingId: booking.Booking_Id}),\n                                                isEnabled: true,\n                                            })\n                                        }\n                                    } else {\n                                        if (booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByLender &&\n                                            booking.Booking_ReviewStatus != enums.bookingReviewStatus.reviewByBoth) {\n                                                $scope.btns.push({\n                                                    text: 'REVIEW_BORROWER',\n                                                    BL: (booking) => productReviewService.startReviewFlow(booking, false),\n                                                    isEnabled: true,\n                                                });\n                                        }\n\n                                        if (!booking.Lender_StripeAccount) {\n                                            $scope.btns.push({\n                                                text:'CREATE_STRIPE_ACCOUNT',\n                                                BL:(booking) => transactionService.endRentalForStripeAccountOnly(booking),\n                                                isEnabled: true,\n                                            })\n                                        }\n                                    }\n                                break;\n                            }\n                            case enums.productRentalStatus.timeoutByBorrower: {\n                                if (isLender) {\n                                        $scope.btns.push({\n                                            text: 'REVIEW_BORROWER',\n                                            BL: () => productReviewService.startReviewFlow(booking, false),\n                                            isEnabled: true,\n                                        })\n                                }\n                                break;\n                            }\n                        }\n                    };\n                    $scope.init = () => {\n                        const userId = appStateManager.getUserId();\n                        const isUserLender = $scope.booking.Lender_Id == userId;\n                        const bookingStatus = $scope.booking.BookingStatus[$scope.booking.BookingStatus.length - 1].Status_TrackId;\n                        let { color, text } = ptUtils.getDisplayDataForTransactionStatus(bookingStatus);\n                        $scope.mainColor = color;\n                        getTextAndCTAforTransactionStatus(bookingStatus,isUserLender,$scope.booking, $scope.booking.IsTryAndBuy);\n                    };\n                    $scope.ctaClicked = () => {\n\n                    };\n\n                    $scope.init()\n                }\n            }}]);\n'use strict';\nangular.module('paladinApp')\n    .directive('chatCtaButton',[\n        '$rootScope',\n        'enums',\n        'apiService',\n        'appStateManager',\n        'toastService',\n        'chatService',\n        '$translate',\n        function (\n            $rootScope,\n            enums,\n            apiService,\n            appStateManager,\n            toastService,\n            chatService,\n            $translate) {\n\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/chatCTAButton.tpl.html',\n                scope: {\n                    product:'=',\n                    productBookingDetails: '=',\n                    booking: '=?',\n                },\n                link: function ($scope, elem, attr) {\n                    $scope.userId = appStateManager.getUserId();\n                    $scope.startChat = () => {\n                        $scope.isLoading = true;\n                        const  {\n                            Chat_QBRoomId,\n                            Lender_UserId,\n                            Product_Id,\n                            Product_Title,\n                        } = $scope.product;\n                        // toastService.simpleToast(`Start Chat between lenderID: ${$scope.lenderQbId} and borrowerId: ${$scope.borrowerQbId} for productId: ${$scope.productId}`);\n                        const {\n                            Borrower_QBId,\n                            Lender_QBId\n                        } = $scope.productBookingDetails;\n\n                        let borrowerId = $scope.userId;\n                        let bookingId = undefined;\n                        if ($scope.booking) {\n                            bookingId = $scope.booking.Booking_Id;\n                            borrowerId = $scope.booking.Borrower_Id;\n                        }\n\n                        chatService.createOrStartChat({\n                            lenderId: Lender_UserId,\n                            borrowerId: borrowerId,\n                            lenderQBId: Lender_QBId,\n                            borrowerQBId: Borrower_QBId,\n                            chatRoomId: Chat_QBRoomId,\n                            bookingId: bookingId,\n                            productId: Product_Id,\n                            productName: Product_Title,\n                        })\n                            .then((res) => {\n                                $scope.isLoading = false;\n                            //     nav to chat\n                                console.log(res);\n                                $rootScope.$emit(enums.busNavigation.chat,{chatId: res.Chat_QBRoomId})\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                                 console.error(err);\n                                toastService.simpleToast($translate.instant('DEFAULT_ERROR'))\n                            });\n\n                    }\n                }\n            }\n\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('bookingCoupon',[\n        '$rootScope',\n        'enums',\n        'apiService',\n        'appStateManager',\n        'ptUtils',\n        function (\n            $rootScope,\n            enums,\n            apiService,\n            appStateManager,\n            ptUtils\n            ) {\n\n                return {\n                    restrict: 'E',\n                    templateUrl: './views/templates/bookingCoupon.tpl.html',\n                    scope: {\n                        onCouponValidation: '&',\n                    },\n                    link: function ($scope, elem, attr) {\n                        $scope.isAddingCoupon = false;\n                        $scope.isLoading = false;\n                        $scope.error = null;\n                        $scope.coupon = { code:'' };\n                        $scope.addCoupon = () => {\n                            $scope.isAddingCoupon = true;\n                        };\n                        $scope.cancel = () => {\n                            $scope.isAddingCoupon = false;\n                        };\n\n                        $scope.validateCoupon = () => {\n                            // if (!ptUtils.regexPatterns.numbersOnly.test($scope.coupon.code)) {\n                            //     return $scope.error = 'Please insert a valid coupon'\n                            // }\n                            $scope.isLoading = true;\n                            const userId = appStateManager.getUserId();\n                            const coupon = $scope.coupon.code;\n                            apiService.payments.verifyCoupon({\n                                userId,\n                                coupon\n                            })\n                                .then((res) => {\n                                    $scope.isLoading = false;\n                                    $scope.onCouponValidation()(res.Data);\n                                    $scope.isAddingCoupon = false;\n                                    $scope.coupon.code = '';\n\n                                })\n                                .catch((err) => {\n                                    $scope.isLoading = false;\n                                    $scope.error = err.data.Message || 'PLEASE_INSERT_VALID_COUPON';\n                                    // console.error(JSON.stringify(err))\n                                })\n                        }\n\n                    }\n                }\n        }]);\n\n'use strict';\nangular.module('paladinApp')\n    .directive('chatsList',[\n        '$rootScope',\n        'enums',\n        'chatService',\n        'appStateManager',\n        function (\n            $rootScope,\n            enums,\n            chatService,\n            appStateManager) {\n\n            return {\n                restrict: 'E',\n                templateUrl: './views/templates/chatsList.tpl.html',\n                link: function ($scope, attr, elem) {\n                    $scope.currentPage = 0;\n                    $scope.isLoading = true;\n                    $scope.canLoadMore = true;\n                    let isLoadingMore = false;\n                    $scope.chats = [];\n                    $scope.unreadDict = {};\n                    $scope.selectedChatId = null;\n                    $scope.loadChatsList = (isReplace = true) => {\n                        $scope.isLoading = true;\n                        chatService.getChatList(appStateManager.getUserId(),$scope.currentPage)\n                            .then((list) => {\n                                $scope.$evalAsync(() => {\n                                    $scope.isLoading = false;\n                                    isLoadingMore = false;\n                                    if (isReplace) {\n                                        $scope.chats = list;\n                                        $scope.currentPage = 0;\n                                        $scope.canLoadMore = true;\n                                    } else {\n                                        if (list.length > 0) {\n                                            $scope.chats = $scope.chats.concat(list);\n                                            $scope.currentPage++;\n                                        } else {\n                                            $scope.canLoadMore = false;\n                                        }\n                                    }\n                                });\n                                chatService.getUnreadMessage()\n                                    .then((dialogsDict) => {\n                                        $scope.unreadDict = dialogsDict || {};\n                                    })\n                                    .catch(() => $scope.unreadDict = {});\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                            })\n                    };\n\n                    $scope.onChatListItemClicked = (chatItem) => {\n                        console.log(chatItem);\n                        if ($scope.selectedChatId != chatItem.Chat_QBRoomId) {\n                            $scope.selectedChatId = chatItem.Chat_QBRoomId;\n                            $rootScope.$emit(enums.busChatEvents.detailedChatSelected, {chatId: chatItem.Chat_QBRoomId})\n                        }\n                    };\n                    $rootScope.$on(enums.busChatEvents.updateUnreadCount, (event,data) => {\n                           $scope.unreadDict = data.detailedDict || {}\n                    });\n\n                    let deregs = [];\n\n                    deregs.push($rootScope.$on(enums.busChatEvents.selectPendingChat,(event,data) => {\n                            $scope.selectedChatId = data.chatId;\n                    }));\n\n                    $scope.loadMore = () => {\n                        if ($scope.canLoadMore) {\n                            if (!isLoadingMore) {\n                                isLoadingMore = true;\n                                console.log('$scope.canLoadMore');\n                                $scope.loadChatsList(false);\n                            }\n                        }\n                    };\n\n                    $scope.loadChatsList(true);\n\n                    $scope.$on('$destroy',function () {\n                        while (deregs.length > 0)\n                            deregs.pop()()\n                    })\n                }\n            }\n\n        }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('chatDetailed',[\n        '$rootScope',\n        'apiService',\n        'appStateManager',\n        'enums',\n        'chatService',\n        '$mdSidenav',\n        'toastService',\n        'ptUtils',\n        function (\n            $rootScope,\n            apiService,\n            appStateManager,\n            enums,\n            chatService,\n            $mdSidenav,\n            toastService,\n            ptUtils) {\n\n            return {\n                restrict:'E',\n                templateUrl:'./views/templates/chatDetailed.tpl.html',\n                scope: {\n                    chatId: '=?'\n                },\n                link: function ($scope, elem, attr) {\n                    // if ($stateParams.chatId) {\n                    //     $scope.chatId = $stateParams.chatId;\n                    // }\n                    $scope.chat = null;\n                    $scope.bookingId = null;\n                    $scope.messages = [];\n                    $scope.compose = {text:'',img:null};\n                    $scope.isUploadingMedia = false;\n                    $scope.userImages = {\n                        me: undefined,\n                        recipient: undefined,\n                    };\n                    $scope.canLoadMoreMsgs = true;\n                    let deregs = [];\n\n                    $scope.setSelectedChat = (chatId, force = false) => {\n                        if (chatId) {\n                            if (chatId != $scope.chatId || force) {\n                                $scope.chatId = chatId;\n                                if ($scope.chat && $scope.chat.Chat_QBRoomId)\n                                    chatService.leaveChat($scope.chat.Chat_QBRoomId);\n                                $scope.getDetailedChat()\n                            }\n                        } else {\n                            // deselect chat\n                            if ($scope.chat && $scope.chat.Chat_QBRoomId)\n                                chatService.leaveChat($scope.chat.Chat_QBRoomId)\n                        }\n                    };\n                    $scope.goToProduct = () => {\n                        $rootScope.$emit(enums.busNavigation.productDetailed,{product: $scope.product})\n                    };\n                    $scope.goToRental = () => {\n                        $rootScope.$emit(enums.busNavigation.transactionDetailed,{bookingId: $scope.bookingId})\n                    };\n\n                    $scope.getDetailedChat = () => {\n                        $scope.bookingId = null;\n                        $scope.isLoading = true;\n                        chatService.getChatDetailed($scope.chatId)\n                            .then((chat) => {\n                                $scope.chat = chat;\n                                if (chat.BookingList && chat.BookingList.length>0 && chat.BookingList[0].BookingId) {\n                                    $scope.bookingId = chat.BookingList[0].BookingId\n                                }\n                                $scope.userImages.me = appStateManager.user.User_DisplayPicturePath;\n                                $scope.userImages.recipient = chat.Lender_UserId == appStateManager.user.User_Id ?  chat.Borrower_ProfileImage : chat.Lender_ProfileImage;\n                                chatService.joinChat($scope.chat.Chat_QBRoomId)\n                                    .then(() => {\n                                        $scope.getDetailedProduct();\n                                    })\n                                    .catch((err) => {\n                                        console.log('Failed to join chat', err);\n                                        $scope.chat = null;\n                                        $scope.chatId = null;\n                                        $scope.isLoading = false;\n                                        toastService.simpleToast($translate.instant('FAILED_JOIN_CHAT'));\n                                    })\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                                $scope.chatId = null;\n                            })\n                    };\n\n                    $scope.getDetailedProduct = () => {\n                        const { Product_Id } = $scope.chat;\n                        apiService.products.getDetailedProduct(Product_Id)\n                            .then((res) => {\n                                $scope.product = res.Data;\n                                $scope.getChatHistory();\n                            })\n                            .catch((err) => {\n                                $scope.chat = null;\n                                $scope.isLoading = false;\n                            })\n                    };\n\n                    $scope.getChatHistory = () => {\n                        chatService.getChatHistory($scope.chat.Chat_QBRoomId,0)\n                            .then((msgs) => {\n                                chatService.clearUnreadBadgesForDialog($scope.chat.Chat_QBRoomId);\n                                $scope.$evalAsync(() => {\n                                    $scope.canLoadMoreMsgs = true;\n                                    $scope.messages = msgs;\n                                    $scope.isLoading = false;\n                                    // document.getElementById('composeTextMessage').focus();\n                                })\n                            })\n                            .catch((err) => {\n                                $scope.$evalAsync(() => {\n                                    $scope.messages = [];\n                                    $scope.isLoading = false;\n                                })\n                            })\n                    };\n\n                    $scope.loadMoreMessages = () => {\n                        if (!$scope.isGettingMoreMsgs && $scope.canLoadMoreMsgs) {\n                            $scope.isGettingMoreMsgs = true;\n                            console.log('loadMoreMessages');\n                            chatService.getChatHistory($scope.chat.Chat_QBRoomId,$scope.messages.length)\n                                .then((msgs) => {\n                                    if (msgs.length == 0) {\n                                        $scope.canLoadMoreMsgs = false;\n                                    }\n                                    $scope.isGettingMoreMsgs = false;\n                                    $scope.messages = msgs.concat($scope.messages);\n\n\n                                })\n                                .catch((err) => {\n                                    $scope.isGettingMoreMsgs = false;\n                                })\n                        }\n                    };\n\n                    $scope.toggleNav = () => {\n                        $mdSidenav(enums.inAppSideNavsIds.chatSideNav).toggle();\n                    };\n\n                    $scope.sendMessage = () => {\n                        chatService.sendMessage({\n                            dialogId: $scope.chat.Chat_QBRoomId,\n                            text: $scope.compose.text,\n                            productId: $scope.chat.Product_Id,\n                            input: null\n                        });\n                        $scope.compose.text = '';\n                    };\n\n                    $scope.keyPress = ($event) => {\n                        if ($event.which == 13 && !$event.shiftKey) {\n                            $event.preventDefault();\n                            if ($scope.compose.text != '')\n                                $scope.sendMessage();\n                            else\n                                ptUtils.playErrorSound();\n                        }\n                    };\n\n                    $scope.uploadMedia = () => {\n                        $scope.$$postDigest(() => {\n                            angular.element(document.getElementById('chatMediaUpload'))[0].click();\n                        })\n                    };\n                    $scope.onUploaded = (inputElement) => {\n                        $scope.$evalAsync(() => {\n                            $scope.isUploadingMedia = true;\n                            if (inputElement && inputElement.files && inputElement.files.length > 0) {\n                                chatService.sendMessage({\n                                    dialogId: $scope.chat.Chat_QBRoomId,\n                                    text: null,\n                                    input: inputElement\n\n                                })\n                                    .then(() => {\n                                        $scope.$evalAsync(() => {\n                                            $scope.isUploadingMedia = false;\n                                        });\n                                    })\n                                    .catch((err) => {\n                                        $scope.$evalAsync(() => {\n                                            $scope.isUploadingMedia = false;\n                                        });\n                                        alert('error! upload again!')\n                                    })\n                            }\n                        })\n                    };\n                    deregs.push($rootScope.$on(enums.busChatEvents.detailedChatSelected,(event,data) => {\n                        $scope.toggleNav();\n                        if (data && data.chatId) {\n                            $scope.setSelectedChat(data.chatId);\n                        } else\n                            $scope.setSelectedChat(null);\n                    }));\n\n\n                    deregs.push($rootScope.$on(enums.busChatEvents.newMessage,(event,data) => {\n                            $scope.messages.push(data);\n                            chatService.clearUnreadBadgesForDialog($scope.chat.Chat_QBRoomId);\n                            $scope.$apply();\n                    }));\n\n                    deregs.push($rootScope.$on(enums.busChatEvents.selectPendingChat,(event,data) => {\n                        $scope.setSelectedChat(data.chatId,true);\n                    }));\n\n\n                    $scope.$on('$destroy',function () {\n                        while (deregs.length > 0)\n                            deregs.pop()()\n                    })\n                }\n            }\n        }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('chatListMessageItem',[function () {\n        return {\n            restrict: 'E',\n            templateUrl: './views/templates/chatListMessageItem.tpl.html',\n            scope: {\n                myImage:'=?',\n                recipientImage: '=?',\n                message: '=',\n            },\n            link: function ($scope, elem, attr) {\n                \n            }\n        }\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('whenScrolled', function() {\n        let threshold = 10;\n        return function(scope, elm, attr) {\n            var raw = elm[0];\n\n            elm.bind('scroll', function() {\n                if (Math.ceil(raw.scrollTop + raw.offsetHeight) >= raw.scrollHeight - threshold) {\n                    var t = setTimeout(() => {\n                        scope.$apply(attr.whenScrolled);\n                        clearTimeout(t);\n                        t = null;\n                    },10)\n                }\n            });\n        }\n    });\n'use strict';\nangular.module('paladinApp')\n    .directive('contactLenderOrBorrower',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        function (\n            $rootScope,\n            enums,\n            appStateManager) {\n            return {\n                restrict: 'E',\n                templateUrl:'./views/templates/contactLenderOrBorrower.tpl.html',\n                scope: {\n                    isTitleHidden: '=?',\n                    isDescriptionHidden: '=?',\n                    product: '=?',\n                    productBookingDetails: '=?',\n                    booking: '=?',\n                },\n                link: function ($scope, elem, att) {\n                    $scope.isTitleHidden = $scope.isTitleHidden || false;\n                    $scope.isDescriptionHidden = $scope.isDescriptionHidden || false;\n\n                    $scope.displayedUser = {\n                        username: null,\n                        profilePic: null,\n                        id: null,\n                        stars: undefined,\n                        reviews: undefined,\n                    };\n                    const init = () => {\n                        const product = $scope.product || {};\n                        $scope.isMyProduct = product.Lender_UserId == appStateManager.getUserId();\n                        $scope.isCanStartChat = !$scope.isMyProduct || $scope.booking != null;\n                        $scope.titleText = $scope.isMyProduct ? 'CONTACT_BORROWER' : 'CONTACT_LENDER';\n\n                        if ($scope.isMyProduct) {\n                            if ($scope.booking) { // if null, can't start chat anyways, so directive will be hidden\n                                $scope.displayedUser.username = $scope.booking.Borrower_Name;\n                                $scope.displayedUser.profilePic = $scope.booking.Borrower_Image;\n                                $scope.displayedUser.id = $scope.booking.Borrower_Id;\n                                $scope.displayedUser.stars = $scope.booking.Borrower_ReviewScore;\n                                $scope.displayedUser.reviews = $scope.booking.Borrower_ReviewCount;\n                            } else {\n                                $scope.isCanStartChat = false;\n                            }\n                        } else {\n                            if ($scope.product) {\n                                $scope.displayedUser.username = product.Lender_FullName;\n                                $scope.displayedUser.profilePic = product.Lender_User_DisplayPicturePath;\n                                $scope.displayedUser.id = product.Lender_UserId;\n                                $scope.displayedUser.stars = product.User_ReviewAsLender;\n                                $scope.displayedUser.reviews = product.User_ReviewCountAsLender;\n                            } else {\n                                $scope.isCanStartChat = false;\n                            }\n                        }\n                    };\n\n                    let deregs = [];\n                    deregs.push($scope.$watch('product',() => {\n                        init();\n                    }));\n\n                    deregs.push($scope.$watch('productBookingDetails',() => {\n                        init();\n                    }));\n\n                    deregs.push($scope.$watch('booking',() => {\n                        init();\n                    }));\n\n                    init();\n\n                    $scope.$on('$destroy',function () {\n                        while (deregs.length)\n                            deregs.pop()();\n                    })\n                }\n            }\n    }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('authedAction',[\n        '$rootScope',\n        'enums',\n        'appStateManager',\n        'popupService',\n        function ($rootScope,\n                  enums,\n                  appStateManager,\n                  popupService) {\n\n                return {\n                    restrict: 'A',\n                    link: function ($scope, elem, attr) {\n\n\n                        const deAuthedLoginDiv = document.createElement('div');\n                        deAuthedLoginDiv.style.position = 'absolute';\n                        deAuthedLoginDiv.style.top = '0';\n                        deAuthedLoginDiv.style.left = '0';\n                        deAuthedLoginDiv.style.height = '100%';\n                        deAuthedLoginDiv.style.width = '100%';\n                        // deAuthedLoginDiv.style.backgroundColor = 'red';\n                        // deAuthedLoginDiv.style.opacity = '0.5';\n                        deAuthedLoginDiv.style.cursor = 'pointer';\n\n                        // deAuthedLoginDiv.style.zIndex = '200';\n                        deAuthedLoginDiv.onclick = () => {\n                            // deAuthedLoginDiv.style.zIndex = 'auto';\n                            popupService.showLoginSignupPopup(false)\n                                .finally(() => {\n                                });\n                            isReloadPage = true;\n                        };\n\n                        elem[0].classList.add('forceRelativePosition');\n                        let isAdded = false;\n                        let isReloadPage = false;\n\n                        const validateAuth = () => {\n                            if (appStateManager.getUserId()) {\n                                if (isAdded) {\n                                    isAdded = false;\n                                    elem[0].removeChild(deAuthedLoginDiv);\n                                    if (isReloadPage) {\n                                        location.reload();\n                                    }\n                                }\n                            } else {\n                                if (!isAdded) {\n                                    isAdded = true;\n                                    elem[0].appendChild(deAuthedLoginDiv)\n                                }\n                            }\n                        };\n\n\n                        validateAuth();\n\n\n                        let deregs = [];\n\n                        deregs.push($rootScope.$on(enums.busEvents.updatedUser, (event, data) => {\n                            validateAuth()\n                        }));\n\n                        $scope.$on('$destroy', () => {\n                            while (deregs.length)\n                                deregs.pop()();\n                        });\n\n                    }\n                }\n        }]);\n'use strict';\nangular.module('paladinApp')\n    .directive('focusMe',['$timeout',function ($timeout) {\n        return {\n            restrict: 'A',\n            link: function ($scope, elem, attr) {\n                $timeout(() => {\n                    if (!elem[0].disabled) {\n                        elem[0].focus();\n                    }\n                },300)\n\n            }\n        }\n    }]);\nangular.module('paladinApp')\n    .directive('copyTextToClipboard', [\n        '$mdToast',\n        function ($mdToast) {\n            return {\n                restrict:'A',\n                link: function ($scope, elem, attr) {\n\n                    // requires an element with an ID to be present on page\n                    // TODO: generalize for other uses\n\n                    $(elem).click(()=>{\n\n                        let containerId = attr.copyTextToClipboard;\n\n                        if (document.selection) {\n                            var range = document.body.createTextRange();\n                            range.moveToElementText(document.getElementById(containerId));\n                            range.select().createTextRange();\n                            document.execCommand(\"copy\");\n                            $mdToast.showSimple('Text copied to clipboard');\n                        } else if (window.getSelection) {\n                            var range = document.createRange();\n                            range.selectNode(document.getElementById(containerId));\n                            window.getSelection().addRange(range);\n                            document.execCommand(\"copy\");\n                            console.info(\"text copied\");\n                            $mdToast.showSimple('Text copied to clipboard');\n                        }\n\n                    })\n                }\n            };\n        }]\n    )\n\nangular.module('paladinPopups')\n    .controller('confirmPopup',['$scope','$mdDialog','locals',function ($scope,$mdDialog,locals) {\n        $scope.title = locals.title;\n        $scope.message = locals.message;\n        $scope.isConfirm = locals.isConfirm;\n        if ($scope.isConfirm) {\n            $scope.yesButton = locals.yesButton;\n            $scope.noButton = locals.noButton;\n        } else {\n            $scope.okBtn = locals.okBtn || 'POPUP_OK';\n        }\n\n        $scope.closeDialog = (isConfirm) => {\n            if (isConfirm)\n                $mdDialog.hide();\n            else\n                $mdDialog.cancel();\n        }\n    }]);\nangular.module('paladinPopups')\n    .controller('loginSignUpPopup',\n        [\n            '$scope',\n            '$rootScope',\n            '$mdDialog',\n            'enums',\n            'apiService',\n            '$translate',\n            'ptLog',\n            'appStateManager',\n            'popupService',\n            '$timeout',\n            'locals',\n            'ptUtils',\n            'gtmService',\n            'referralsService',\n            function ($scope,\n                $rootScope,\n                $mdDialog,\n                enums,\n                apiService,\n                $translate,\n                ptLog,\n                appStateManager,\n                popupService,\n                $timeout,\n                locals,\n                ptUtils,\n                gtmService,\n                referralsService\n            ) {\n                $scope.selectedTab = locals.selectedTab;\n                $scope.currentLang = $translate.proposedLanguage() ? $translate.proposedLanguage() : $translate.preferredLanguage();\n                if ($rootScope.currentLang)\n                    $scope.currentLang = $rootScope.currentLang;\n                $scope.loginMessage = '';\n                $scope.loginFacebookMessage = '';\n                $scope.signupFacebookMessage = '';\n                $scope.signupFacebookStatus = '';\n                $scope.signupMessage = '';\n                $scope.signupStatus = '';\n                $scope.registerFacebookStatus = '';\n                $scope.btnStatus = 10;\n                $scope.isLoading = false;\n                $scope.isFacebookApiLoaded = $rootScope.facebookApiLoaded;\n\n                // if referralsService.referralCode is defined, it has alredy been validated\n                let referralData = referralsService.getReferralData();\n                let referralCode = referralData.code;\n\n                $scope.promoMessage = referralsService.getReferralData().code\n                    ? $translate.instant('PROMO_MESSAGE_REGISTER_REFERRED', {ambassadorUserName: referralData.userName})\n                    : window.globals.IS_PROMO ? $translate.instant('PROMO_MESSAGE_REGISTER_PROMO', {startDate: window.globals.START_DATE, endDate: window.globals.END_DATE, couponValue: window.globals.COUPON_VALUE}) \n                    : $translate.instant('PROMO_MESSAGE_REGISTER');\n\n\n                $scope.register = (username, password, email, location) => {\n                    const currentLang = appStateManager.currentLang === 'it' ? 'it-IT' : appStateManager.currentLang;\n                    if (!ptUtils.regexPatterns.minMaxLength(6).test(password)) {\n                        $scope.signupStatus = 'error';\n                        $scope.signupMessage = 'SIGN_UP_ERROR_PASSWORD_RESTRICTION';\n                        return\n                    }\n                    $scope.btnStatus = 1;\n\n                    apiService.users.signUp({\n                        email,\n                        username,\n                        password,\n                        location,\n                        currentLang,\n                        referralCode\n                    })\n                        .then((response) => {\n                            $scope.btnStatus = 10;\n                            $scope.signupMessage = response.Message;\n                            $scope.signupStatus = response.Status;\n                            popupService.showAlert('ACTIVATION_EMAIL_SENT_TITLE','ACTIVATION_EMAIL_SENT_DESCR');\n                            ptLog.log(JSON.stringify(response));\n                            gtmService.trackEvent('registration', 'click-on-sign-up-button', 'email signup');\n                        })\n                        .catch((err) => {\n                            $scope.btnStatus = 10;\n                            $scope.signupMessage = err.data.Message;\n                            $scope.signupStatus = err.data.Status;\n                            ptLog.error(JSON.stringify(err));\n                        })\n                };\n\n                $scope.login = (username,password) => {\n                    const currentLang = appStateManager.currentLang === 'it' ? 'it-IT' : appStateManager.currentLang;\n                    $scope.isLoading = true;\n                    let loginObj = {username,password,currentLang};\n                    if (ptUtils.regexPatterns.email.test(username)) {\n                        //    username is actually email address, edit loginObj\n                        delete loginObj.username;\n                        loginObj.email = username\n                    }\n                    apiService.users.login(loginObj)\n                        .then((response) => {\n                            $scope.isLoading = false;\n                            ptLog.log(JSON.stringify(response));\n                            $rootScope.$emit(enums.busEvents.userLogin,response.Data);\n                            $mdDialog.hide();\n                        })\n                        .catch((err) => {\n                            $scope.isLoading = false;\n                            $scope.loginStatus = err.data.Status;\n                            $scope.loginMessage = err.data.Message;\n                            ptLog.error(JSON.stringify(err))\n                        })\n                };\n\n                $scope.registerFacebook = () => {\n                    if($rootScope.facebookApiLoaded) {\n\n                        $scope.btnStatus = 1;\n\n                        apiService.users.signupFacebook({\n                            facebookName:$rootScope.facebook_user.name,\n                            email: $rootScope.facebook_user.email,\n                            address: $rootScope.facebook_user.address,\n                            currentLang:appStateManager.getCurrentLang(),\n                            facebookUserId: $rootScope.facebook_user.id,\n                            referralCode: referralCode\n                        })\n                            .then((response) => {\n                                $scope.btnStatus = 10;\n                                $scope.signupFacebookStatus = response.Status;\n                                ptLog.log(JSON.stringify(response));\n                                $rootScope.$emit(enums.busEvents.userLogin,response.Data);\n                                $mdDialog.hide();\n                                //only track event if its the first facebook signup and not login\n                                if (response.Data.FbSignup && response.Data.FbSignup == true) {\n                                    gtmService.trackEvent('registration', 'click-on-facebook-signup', 'facebook signup');\n                                }\n                            })\n                            .catch((err) => {\n                                $scope.btnStatus = 10;\n                                $scope.signupFacebookStatus = err.data.Status;\n                                $scope.signupFacebookMessage = err.data.Message;\n\n                            });\n                    } else {\n                        $scope.signupFacebookStatus = 'error';\n                        $scope.signupFacebookMessage =  $translate.instant('FACEBOOK_LOADING');\n                        $timeout( () => {\n                            $scope.registerFacebook();\n                        }, 2000 );\n                    }\n                };\n\n                $scope.cancel = () => {\n                    $mdDialog.hide();\n                };\n\n                $scope.showTabDialogForgotPassword = () => {\n                    popupService.showForgotPassword();\n                };\n\n                let deregs = [];\n\n                deregs.push($rootScope.$on(enums.busEvents.facebookApiLoad),(event,data) => {\n                    // $scope.isFacebookApiLoaded = data.isLoaded;\n                });\n\n                $scope.$on('$destroy', function() {\n                    while (deregs.length)\n                        deregs.pop()();\n                });\n\n                // $scope.\n            }]);\n\nangular.module('paladinPopups')\n    .controller('forgotPasswordPopup',['$scope', '$rootScope', '$mdDialog', 'enums','apiService','$translate','ptLog','appStateManager',\n        function ($scope,$rootScope,$mdDialog,enums,apiService,$translate,ptLog,appStateManager) {\n            $scope.forgotPasswordMessage = '';\n            $scope.forgotpasswordStatus = '';\n            $scope.btnForgotPasswordStatus = 10;\n\n\n            $scope.forgotPassword = (email) => {\n                $scope.btnForgotPasswordStatus = 1;\n\n                apiService.users.forgotPassword({email,currentLang: appStateManager.getCurrentLang()})\n                    .then((response) => {\n                        $scope.btnForgotPasswordStatus = 10;\n                        $scope.forgotpasswordStatus = response.Status;\n                        $scope.forgotPasswordMessage = response.Message;\n                        ptLog.log(JSON.stringify(response))\n                    })\n                    .catch((err) => {\n                        $scope.btnForgotPasswordStatus = 10;\n                        $scope.forgotpasswordStatus = err.data.Status;\n                        $scope.forgotPasswordMessage = err.data.Message;\n                        ptLog.error(JSON.stringify(err))\n\n                    })\n            };\n\n            $scope.cancel = () => {\n                $mdDialog.cancel();\n            };\n        }]);\n'use strict';\nangular.module('paladinPopups')\n    .controller('shareToSocialMediaPopup', [\n        '$scope',\n        '$mdDialog',\n        'locals',\n        'ptUtils',\n        function (\n            $scope,\n            $mdDialog,\n            locals,\n            ptUtils\n        ) {\n            $scope.referralLink = locals.referralLink;\n\n            $scope.isMobile = ptUtils.isMobile.any();\n\n            $scope.cancel = () => {\n                $mdDialog.cancel();\n            }\n        }]);\n\nangular.module('paladinPopups')\n    .controller('idVerificationFailureHandlerPopup',\n        [\n            '$scope',\n            '$mdDialog',\n            '$translate',\n            'locals',\n        function (\n            $scope,\n            $mdDialog,\n            $translate,\n            locals\n        ) {\n            $scope.popupTitle = $translate.instant(\"ID_VERIFY_FAIL_POPUP_TITLE\");\n            $scope.isProcessing = false;\n            $scope.isSuccess = true;\n            $scope.message = locals.message; // already translated in userVerification controller\n\n            $scope.cancel = function() {\n                $mdDialog.cancel();\n            };\n\n            $scope.retry = function () {\n                // close popup and clear form data\n                locals.retryClb();\n                $scope.cancel();\n            };\n\n            $scope.sendToManualVerification = () => {\n                locals.sendToManualClb();\n                $scope.cancel();\n            };\n\n        }]);\nangular.module('paladinPopups')\n.controller('emailVerificationPopup',['$scope', '$rootScope', '$mdDialog', 'enums','apiService','$translate','ptLog','appStateManager','locals',\n    function ($scope,$rootScope,$mdDialog,enums,apiService,$translate,ptLog,appStateManager,locals) {\n            $scope.welcome_message_dialog = $translate.instant(\"WELCOME\");\n            $scope.isProcessing = true;\n            $scope.isSuccess = true;\n            $scope.message = $translate.instant('PLEASE_WAIT');\n\n            $scope.hide = function() {\n                $mdDialog.hide();\n            };\n\n            $scope.cancel = function() {\n                $mdDialog.cancel();\n            };\n\n            $scope.answer = function(answer) {\n                $mdDialog.hide(answer);\n            };\n\n            $scope.retry = function () {\n                $scope.verifyUser();\n            };\n\n            $scope.verifyUser = () => {\n                $scope.message = $translate.instant('PLEASE_WAIT');\n                $scope.isProcessing = true;\n                $scope.isSuccess = true;\n                apiService.users.emailVerification({userId:locals.userId})\n                    .then((response) => {\n                        $scope.isProcessing = false;\n                        $scope.isSuccess = true;\n                        $scope.message = $translate.instant('REGISTRATION_SUCCESS');\n                        $rootScope.$emit(enums.busEvents.userLogin,response.Data);\n                    })\n                    .catch((err) => {\n                        $scope.isProcessing = false;\n                        $scope.isSuccess = false;\n                        $scope.message = $translate.instant('REGISTRATION_ERROR');\n                    })\n            };\n\n            $scope.verifyUser();\n    }]);\nangular.module('paladinPopups')\n    .controller('changePasswordPopup', [\n        '$scope',\n        '$mdDialog',\n        'locals',\n        'appStateManager',\n        'apiService',\n        function (\n            $scope,\n            $mdDialog,\n            locals,\n            appStateManager,\n            apiService) {\n\n            $scope.isProcessing = false;\n            $scope.statusError = null;\n            $scope.changePassModel = {\n                oldPassword: '',\n                newPassword: '',\n                newPasswordConfirmation:''\n            };\n\n\n            $scope.cancel = () => {\n                $mdDialog.cancel();\n            };\n\n            $scope.validator = () => {\n                let isValid = true;\n                if ($scope.changePassModel.oldPassword &&\n                    $scope.changePassModel.newPassword &&\n                    $scope.changePassModel.newPasswordConfirmation) {\n\n                    if ($scope.changePassModel.newPassword != $scope.changePassModel.newPasswordConfirmation) {\n                        isValid = false;\n                        $scope.statusError = 'PASSES_DONT_MATCH';\n                    }\n                } else {\n                    $scope.statusError = 'FILL_ALL_FIELDS';\n                    isValid = false;\n                }\n                return isValid;\n            };\n            $scope.changePass = () => {\n                $scope.statusError = null;\n                if ($scope.validator()) {\n                    $scope.isProcessing = true;\n\n                    apiService.users.changePassword({\n                        newPassword: $scope.changePassModel.newPassword,\n                        oldPassword: $scope.changePassModel.oldPassword,\n                        userId: appStateManager.getUserId(),\n                    })\n                        .then((response) => {\n                            $mdDialog.hide()\n                        })\n                        .catch((err) => {\n                            $scope.statusError = err.data.Message || 'DEFAULT_ERROR';\n                            $scope.isProcessing = false;\n                        })\n                }\n            }\n        }]);\n'use strict';\nangular.module('paladinPopups')\n    .controller('transactionStatusChangePopup',[\n        '$scope',\n        '$mdDialog',\n        'locals',\n        function ($scope,$mdDialog,locals) {\n            $scope.title = locals.title;\n            $scope.apiMethod = locals.apiMethod;\n            $scope.isLoading = true;\n\n            $scope.runApiMethod = () => {\n                $scope.apiMethod()\n                    .then((res) => {\n                        $mdDialog.hide(res)\n                    })\n                    .catch((err) => {\n                        $mdDialog.cancel(err)\n                    })\n            };\n\n            $scope.runApiMethod();\n    }]);\n\n'use strict';\nangular.module('paladinPopups')\n    .controller('inputFieldPopup',[\n        '$scope',\n        '$mdDialog',\n        'locals',\n        function ($scope,$mdDialog,locals) {\n            $scope.isInvalid = false;\n            $scope.message = locals.message;\n            $scope.title = locals.title;\n            $scope.inputRegexValidation = locals.inputRegexValidation;\n            $scope.validationErrorMessage = locals.validationErrorMessage;\n            $scope.inputField = { value: locals.value };\n            $scope.closeDialog = (isConfirm) => {\n                if (isConfirm) {\n                    if ($scope.inputRegexValidation && $scope.inputRegexValidation.test($scope.inputField.value))\n                        $mdDialog.hide($scope.inputField);\n                    else\n                        $scope.isInvalid = true;\n                } else {\n                    $mdDialog.cancel()\n                }\n            }\n        }]);\n\n\n'use strict';\nangular.module('paladinPopups')\n    .controller('loaderPopup',[\n        '$rootScope',\n        '$scope',\n        function (\n            $rootScope,\n            $scope) {\n                $scope.loadingText = undefined\n        }\n    ]);\n'use strict';\nangular.module('paladinPopups')\n    .controller('bookingTrackerInfoMobilePopup',[\n        '$scope',\n        'enums',\n        'ptUtils',\n        'locals',\n        'appStateManager',\n        '$mdDialog',\n        '$mdColors',\n        function (\n            $scope,\n            enums,\n            ptUtils,\n            locals,\n            appStateManager,\n            $mdDialog,\n            $mdColors\n        ) {\n\n            $scope.userId = appStateManager.getUserId();\n            $scope.isLender = $scope.userId == locals.booking.Lender_Id;\n            $scope.isTryAndBuy = locals.booking.IsTryAndBuy;\n            $scope.currentStatusId = locals.booking.BookingStatus[locals.booking.BookingStatus.length - 1].Status_TrackId;\n            $scope.popupDescription = ptUtils.parseBookingStepTutorialHTMLTemplateForTranslationId(\n                ptUtils.getTranslationIdForBookingStatus($scope.currentStatusId,$scope.isLender, $scope.isTryAndBuy)\n            );\n\n            $scope.close = () => $mdDialog.hide();\n\n            const setTrackerDescriptionStyle = () => {\n                document.getElementById('bookingTrackerInfoMobilePopupId').parentNode.classList.add('md-dialog-booking-tracker-class');\n                let bookingTrackerWrapperDiv = document.querySelector('#bookingTrackerInfoMobilePopupId div>div');\n                bookingTrackerWrapperDiv.className = 'flex-100 layout-column layout-align-center-center';\n\n                let titleSpan = document.querySelector('#bookingTrackerInfoMobilePopupId div>div>span');\n                titleSpan.className = 'fontWeight450 font20pt md-padding';\n                $mdColors.applyThemeColors(angular.element(titleSpan),{color:'default-primary-A300'});\n\n                let ol = document.querySelector('#bookingTrackerInfoMobilePopupId div>div>ol');\n                ol.className = 'md-padding';\n\n                let listItems = document.querySelectorAll('#bookingTrackerInfoMobilePopupId div>div>ol>li');\n\n                listItems.forEach((item) => {\n                    item.className = 'font12pt';\n                    $mdColors.applyThemeColors(angular.element(item),{color:'default-primary-A400'});\n                })\n            };\n\n            $scope.$$postDigest(() => {\n                setTrackerDescriptionStyle()\n            })\n\n\n\n\n\n    }]);\n\nangular.module('paladinApp')\n.controller('homeController', [\n    '$scope',\n    '$http',\n    '$location',\n    '$cookies',\n    '$rootScope',\n    '$sce',\n    '$route',\n    'Filters',\n    '$translate',\n    'ZendeskWidget',\n    'ngMeta',\n    '$mdDialog',\n    'enums',\n    '$state',\n    '$stateParams',\n    'popupService',\n    '$timeout',\n    'appStateManager',\n    function ($scope,\n              $http,\n              $location,\n              $cookies,\n              $rootScope,\n              $sce,\n              $route,\n              Filters,\n              $translate,\n              ZendeskWidget,\n              ngMeta,\n              $mdDialog,\n              enums,\n              $state,\n              $stateParams,\n              popupService,\n              $timeout,\n              appStateManager) {\n\n\n        $scope.verificationMessage = \"Processing ...\";\n        let geocoder;\n        const cat = $stateParams.category;\n        let categoryParam =  cat && cat.toString().replace(/-/g, ' ')!=$translate.instant('ACTG') ? cat :$translate.instant('ACTG');\n        let subCategoryParam = $stateParams.subCategory ? $stateParams.subCategory :'';\n        let initialSortBy = $state.params.sortBy || undefined;\n        let pageIndex = $state.params.pageIndex || 1;\n\n        let city = $stateParams.city || ($rootScope.filter || {}).glCity || undefined;\n\n         const languageCode = $stateParams.languageCode;\n        $rootScope.lang = languageCode;\n        $translate.use(languageCode);\n\n        ZendeskWidget.setLocale(languageCode);\n\n        var scope = $scope;\n        if ($state.params.search != undefined) {\n            $rootScope.searchKey = $state.params.search;\n        } else if ($location.search().search != undefined) {\n            $rootScope.searchKey = $location.search().search;\n        }\n        if ($stateParams.isResetSearch) {\n            $rootScope.searchKey = '';\n        }\n\n        $rootScope.isTryAndBuy = $stateParams.isTryAndBuy;\n      \n\n        function initCategories() {\n            Filters.get('it', function(response){\n                $rootScope.categoriesMap.set('it', response.data.Data);\n                Filters.get('en', function(response){\n                    $rootScope.categoriesMap.set('en', response.data.Data);\n                    // Filters.get('de', function(response){\n                    //     $rootScope.categoriesMap.set('de', response.data.Data);\n                        scope.selectCategory();\n                        scope.findLatLong();\n                    // });\n\n                });\n\n            });\n        }\n\n        function updateHreflangTags() {\n            updateHreflang(\"it\");\n            // updateHreflang(\"de\");\n            updateHreflang(\"en\");\n\n        }\n\n        scope.filter = {\n            categories: [],\n            languageCode: languageCode,\n            priceRange: [0,1000],\n            search:{\n                lat: undefined,\n                lng: undefined,\n                searchStr: ''\n            },\n            currentPage:1,\n            distanceRange: city? 10 : null,\n            sortBy: enums.productsSortOptions.bestProduct,\n            sortByCode: enums.productsSortByTextCode.SortByBestProduct,\n            category : {\n                defaultCategoryName : $translate.instant('ACTG'),\n                defaultCategoryDesc : $translate.instant('ACTG'),\n                selectedCategoryName :$translate.instant('ACTG'),\n                isTryAndBuy: $rootScope.isTryAndBuy,\n                selectedCategoryBannerImage: window.globals.IS_PROMO ? enums.categoriesBannersPaths.promo : enums.categoriesBannersPaths.all[languageCode],\n                selectedSubCategoryName: null\n            },\n            gl: null, //google location object when location searched this will be accessible to all\n            glString: '',\n            glCity: ''\n        };\n\n        scope.prepareUrl = function(){\n            let url = $rootScope.isTryAndBuy ? `/${appStateManager.currentLang}/categorie` : `/${appStateManager.currentLang}/categorie/privato`;\n            if(scope.filter.category.selectedCategoryName && scope.filter.category.selectedCategoryName.toString()){\n                url +='/'+scope.filter.category.selectedCategoryName.toString();\n                if(scope.filter.category.selectedSubCategoryName && scope.filter.category.selectedSubCategoryName.toString()){\n                    url +='/'+scope.filter.category.selectedSubCategoryName.toString();\n                    if (city) {\n                        url+='/'+city;\n                    }\n                    //if(scope.filter.glCity){\n                    //\turl +='/'+scope.filter.glCity;\n                    //}\n                }\n            }\n            return url.split(' ').join('-');\n        };\n\n        scope.prepareQuery = () => {\n            let obj = {};\n            if (scope.filter.search.searchStr) {\n                obj.search = scope.filter.search.searchStr\n            }\n            if (scope.filter.sortBy) {\n                obj.sortBy = scope.filter.sortBy;\n            }\n            if (scope.filter.currentPage) {\n                obj.pageIndex = scope.filter.currentPage;\n            }\n        \n        return obj;\n        };\n\n        function updateHreflang(lang) {\n            const metaTag = enums.ngMetaValues.currentUrl(lang);\n            if (lang == languageCode) {\n                ngMeta.setTag(metaTag, $location.absUrl());\n                return;\n            }\n\n            var url = '/'+lang+'/categorie/';\n            if (scope.filter.category.selectedCategoryId == null) {\n                url += enums.allCategories[lang].replace(/ /g, '-')+ '/';\n            } else {\n                url += Filters.getCategoryById(scope.filter.category.selectedCategoryId, lang).Category_Name.replace(/ /g, '-');\n            }\n\n            if (scope.filter.category.selectedSubCategoryId && scope.filter.category.selectedSubCategoryId != null) {\n                url += '/' + Filters.getSubcategoryById(scope.filter.category.selectedSubCategoryId, lang).SubCategory_Name.replace(/ /g, '-');\n\n                if (city) {\n                    url += '/'+city;\n                }\n            }\n            ngMeta.setTag(metaTag, $location.absUrl().split('/' + languageCode+'/')[0] + url);\n        }\n\n        //method needed to init the app. We will determine the location based on either\n        //0. previous location stored (in rootscope)\n        //1. city in url\n        //2. GPS loc\n        //3. Default loc\n        function init() {\n\n            //dont need to reload if $rootscope has already filter stored\n            if (initialSortBy) {\n                scope.filter.sortBy = initialSortBy;\n                scope.filter.sortByCode = enums.productsSortByTextCode[initialSortBy];\n                // scope.filter.search.searchStr = '';\n                if ($stateParams.isResetSearch) {\n                    scope.filter.search.searchStr = $rootScope.searchKey;\n                    scope.filter.search.currentSearchStr = $rootScope.searchKey;\n                }\n            } else if ($rootScope.searchKey != undefined) {\n                scope.filter.search.searchStr = $rootScope.searchKey;\n                scope.filter.search.currentSearchStr = $rootScope.searchKey;\n            }\n\n            if (pageIndex) {\n                scope.filter.currentPage = pageIndex;\n            }\n\n            if ($rootScope.filter) {\n                //case where we press back button from product preview page or to breadcrumb\n                scope.filter = $rootScope.filter; //!important for not loading again all data\n                //dont need to reload if $rootscope has already filter stored\n                if (initialSortBy) {\n                    scope.filter.sortBy = initialSortBy;\n                    scope.filter.sortByCode = enums.productsSortByTextCode[initialSortBy];\n\n                    if ($stateParams.isResetSearch) {\n                        scope.filter.search.searchStr = '';\n                        scope.filter.search.currentSearchStr = '';\n                    }\n                    // scope.filter.search.searchStr = '';\n                } else if ($rootScope.searchKey != undefined) {\n                    scope.filter.search.searchStr = $rootScope.searchKey;\n                    scope.filter.search.currentSearchStr = $rootScope.searchKey;\n                }\n                registerUpdateUrlListener();\n                scope.selectCategory();\n                scope.findLatLong();\n            } else {\n                //case where we init/refresh website\n                if (!$rootScope.categoriesMap) {\n                    $rootScope.categoriesMap = new Map();\n                    initCategories(languageCode);\n                } else {\n\n                    scope.selectCategory();\n                    scope.findLatLong();\n                }\n            }\n\n            \n            scope.promoTimeout = $timeout( () => {\n                if (appStateManager.user == null && !angular.element(document.body).hasClass('md-dialog-is-showing')) {    \n                    popupService.showLoginSignupPopup(true);\n                }\n            },window.globals.PROMO_SIGNUP_TIMER);\n            \n        }\n\n        scope.findLatLong = function() {\n            //location already defined\n            if (scope.filter.glString) {\n                scope.geocodeNow(null,null,scope.filter.glString)\n            } else if(!city) {\n                //asking for location access\n                if (navigator.geolocation) {\n                    scope.geocodeNow(null,null,null);\n                    navigator.geolocation.getCurrentPosition(function(position) {\n                        scope.geocodeNow(position.coords.latitude,position.coords.longitude,null);\n                    }, function() {\n                        scope.geocodeNow(null,null,null);\n                    });\n                } else {\n                    // Browser doesn't support Geolocation\n                    scope.geocodeNow(null,null,null);\n                }\n            }else{\n                scope.geocodeNow(null,null,null);\n            }\n\n        };\n\n        scope.geocodeNow = function(lat,lng,address) {\n            var data= {};\n            if(lat && lng){\n                data.location = {};\n                data.location.lat = lat;\n                data.location.lng = lng;\n            }else if(address){\n                data.address = address;\n            }else{\n                if(languageCode == 'it' || languageCode == 'en'){\n                    data.address = 'milan italy';\n                }else if(languageCode == 'de'){\n                    data.address = 'berlin germany';\n                }else{\n                    data.address = 'berlin germany';\n                }\n            }\n\n            geocoder = new google.maps.Geocoder();\n            geocoder.geocode(data, function(results, status) {\n                if (results && results.length > 0) {\n                    saveLocationToScope(results[0]);\n                }\n\n                $rootScope.$broadcast('filtersUpdated',scope.filter);\n            });\n        }\n\n\n\n        function saveLocationToScope(place) {\n            scope.filter.gl = place;\n            scope.filter.search.lat = place.geometry.location.lat();\n            scope.filter.search.lng = place.geometry.location.lng();\n            scope.filter.glCity = getCity(place);\n            scope.filter.glString = place.formatted_address;\n        }\n\n        function getCity(result){\n            var country='',state='',city='';\n            for(var i=0 ;i<result.address_components.length;i++){\n                var types = result.address_components[i].types;\n                for(var j=0;j<types.length;j++){\n                    var type = types[j];\n                    if(type=='country' || type==\"political\"){\n                        country = result.address_components[i].long_name;\n                        break;\n                    }else if(type=='administrative_area_level_1'){\n                        state = result.address_components[i].long_name;\n                        break;\n                    }else if((type=='administrative_area_level_2' && !city) || type=='locality'){\n                        city = result.address_components[i].long_name;\n                        break;\n                    }\n\n                }\n            }\n            return city;\n\n            //var shortAddress = (city ? city+',':'' )+(state ? state+',':'' )+(country ? country:'' );\n            //return shortAddress;\n        }\n\n        scope.selectCategory = function(){\n\n            scope.filter.categories = $rootScope.categoriesMap.get(languageCode);\n\n            let category = Filters.getCategoryByName(categoryParam,languageCode, $rootScope.isTryAndBuy);\n\n            let tempCategory = scope.filter.category;\n            if (category) {\n                tempCategory.selectedCategoryId = category.Category_Id;\n                tempCategory.selectedCategoryDesc=$sce.trustAsHtml(category.Category_Description);\n                tempCategory.selectedCategoryName=category.Category_Name;\n                tempCategory.selectedCategoryImagePath=category.Category_ImagePath;\n                tempCategory.selectedCategoryBannerImage = category.Category_BannerPath;\n\n                if (category.Category_SubCatrgories && category.Category_SubCatrgories.length>0) {\n                    for (var i=0;i<category.Category_SubCatrgories.length;i++) {\n                        var subCategory = category.Category_SubCatrgories[i];\n\n                        tempCategory.selectedSubCategoryId = undefined;\n                        tempCategory.selectedSubCategoryDesc = undefined;\n                        tempCategory.selectedSubCategoryName = undefined;\n                        tempCategory.selectedSubCategoryImagePath = undefined;\n                        tempCategory.selectedSubCategoryBannerImage\t= undefined;\n\n                        if(subCategory.SubCategory_Name.toLowerCase().replace(/ /g,'-') == subCategoryParam.toLowerCase()) {\n                            tempCategory.selectedSubCategoryId = subCategory.SubCategory_Id;\n                            tempCategory.selectedSubCategoryDesc = $sce.trustAsHtml(subCategory.SubCategory_Description );\n                            tempCategory.selectedSubCategoryName = subCategory.SubCategory_Name ;\n                            tempCategory.selectedSubCategoryImagePath = subCategory.SubCategory_ImagePath ;\n                            tempCategory.selectedSubCategoryBannerImage\t= subCategory.SubCategory_BannerPath;\n                            break;\n                        }\n                    }\n                }\n            } else {\n                //all categories selected\n                tempCategory.selectedCategoryId = null;\n                tempCategory.selectedCategoryDesc = $sce.trustAsHtml(categoryParam);\n                tempCategory.selectedCategoryName = $translate.instant('ACTG');\n                tempCategory.selectedCategoryImagePath = null;\n                tempCategory.selectedCategoryBannerImage = window.globals.IS_PROMO ? enums.categoriesBannersPaths.promo : enums.categoriesBannersPaths.all[languageCode];\n                tempCategory.selectedSubCategoryId = undefined;\n                tempCategory.selectedSubCategoryDesc = undefined;\n                tempCategory.selectedSubCategoryName = undefined;\n                tempCategory.selectedSubCategoryImagePath = undefined;\n                tempCategory.selectedSubCategoryBannerImage\t= undefined;\n                tempCategory.isTryAndBuy = $rootScope.isTryAndBuy;\n            }\n            scope.filter.category = tempCategory ; // this is required because if we set only one param than immediately list directive will be loaded and fetch data ;\n\n\n            //$rootScope.$broadcast('filtersUpdated',scope.filter);\n\n\n            //when city is in url, we select distance \"In the City (10km)\"\n            if (city) {\n                let radius = {\n                    \"l_id\": 3,\n                    \"distance\":10,\n                    \"name\": \"IC\"\n                };\n                $rootScope.$broadcast('distanceChanged', radius);\n            }\n            //listen to any filter changes in order to update url\n            registerUpdateUrlListener();\n        };\n\n        let deregs = [];\n        //here is where we start everything\n        init();\n\n        // var off = $scope.$on('$stateChangeStart', function(e) {\n        //     e.preventDefault();\n        //     off();\n        // });\n\n        deregs.push($rootScope.$on(enums.busEvents.googlePlacesAutocompletePlaceChanged, function(events, args){\n            if(args && args.place && (args.elementId == 'search-location-bar-desktop' || args.elementId == 'search-location-bar-mobile')) {\n                saveLocationToScope(args.place);\n                city = null;\n                $rootScope.$broadcast('filtersUpdated',scope.filter);\n            }\n        }));\n\n        deregs.push(scope.$on('languageChanged', function(event,data){\n            scope.filter.languageCode = data;\n            ZendeskWidget.setLocale(data);\n        }));\n\n        function registerUpdateUrlListener() {\n            //listen to any filter changes in order to update url\n            deregs.push(scope.$watchGroup([\n                'filter.languageCode',\n                'filter.sortBy',\n                'filter.currentPage',\n                'filter.category.selectedCategoryName',\n                'filter.category.selectedSubCategoryName',\n                'search.lat',\n                'search.lng',\n            ],function(value) {\n                if(value) {\n                    $rootScope.filter = scope.filter;\n                    $location.search(scope.prepareQuery());\n                    $location.update_path(scope.prepareUrl(), false);\n                    // $scope\n                    updateHreflangTags();\n                }\n            }))\n        }\n\n\n\n        $scope.$on('$destroy', () => {\n            \n            while (deregs.length) {\n                deregs.pop()();\n            }\n\n            $timeout.cancel(scope.promoTimeout);\n            \n        })\n\n    }]);\n\nangular.module('paladinApp')\n    .directive('googleplaceAutocomplete', ['$rootScope','enums', function ($rootScope,enums) {\n    return {\n        restrict: 'A',\n        require: 'ngModel',\n        scope: {\n            googleplaceAutocompletePlace: '=?',\n            googleplaceAutocomplete: '=',\n        },\n        link: function postLink(scope, element, attrs, model) {\n            var options = scope.googleplaceAutocomplete || {};\n            options.placeholder = '';\n            options.componentRestrictions = {country: 'it'};\n            var autocomplete = new google.maps.places.Autocomplete(element[0], options);\n            delete element[0].placeholder;\n            google.maps.event.addListener(autocomplete, 'place_changed', function () {\n                delete element[0].placeholder;\n                scope.$apply(function () {\n                    scope.googleplaceAutocompletePlace = autocomplete.getPlace();\n                    model.$setViewValue(element.val());\n                    $rootScope.$emit(enums.busEvents.googlePlacesAutocompletePlaceChanged, {\n                        place: scope.googleplaceAutocompletePlace,\n                        elementId: element[0].attributes.id.nodeValue,\n                    });\n                });\n            });\n\n            scope.$on('$destroy', function () {\n                google.maps.event.clearInstanceListeners(element[0]);\n            });\n        }\n    };\n}]);\nangular.module('paladinApp')\n    .controller('homeV2Controller',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'apiService',\n        'appStateManager',\n        '$mdToast',\n        '$translate',\n        'popupService',\n        'ngMeta',\n        '$timeout',\n        'referralsService',\n        'validReferralCode',\n        function (\n            $rootScope,\n            $scope,\n            enums,\n            apiService,\n            appStateManager,\n            $mdToast,\n            $translate,\n            popupService,\n            ngMeta,\n            $timeout,\n            referralsService,\n            validReferralCode // from resolve\n        ) {\n            $scope.isLoading = true;\n\n            $scope.isPromo = window.globals.IS_PROMO;\n\n            $scope.lendTutorial = {\n                title: $translate.instant('MAKE_MONEY'),\n                description: 'ITEMS_ARE_INSURED',\n                // imgUrl: 'https://picsum.photos/400/250/?random',\n                imgUrl: '/assets/lend_tutorial_image.png',\n                steps: [\n                    'UPLOAD_AN_ITEM',\n                    'WAIT_FOR_REQUEST',\n                    'LEND_YOUR_ITEM'\n                ]\n            };\n\n            $scope.borrowTutorial = {\n                title: $translate.instant('SAVE_MONEY'),\n                description: 'ITEMS_ARE_INSURED',\n                // imgUrl: 'https://picsum.photos/400/250/?random',\n                imgUrl: '/assets/browse-banner-hp.jpg',\n                steps: [\n                    'FIND_THE_ITEM',\n                    'MAKE_A_REQUEST',\n                    'PICK_UP_OR_DELIVER',\n                ]\n            };\n\n            $scope.promoFixCoupon1 = {\n                title:  $translate.instant('PROMO_TITLE_1'),\n                description: $translate.instant('OFERTA_VALIDA', {couponValue: window.globals.COUPON_VALUE}),\n                // imgUrl: 'https://picsum.photos/400/250/?random',\n                imgUrl: '/assets/promo1.jpg',\n                steps: [\n                    'STEP1',\n                    $translate.instant('STEP2', {couponCode: window.globals.COUPON_CODE}),\n                    'STEP3',\n                ]\n            };\n            $scope.promoFixCoupon2 = {\n                title: $translate.instant('PROMO_TITLE_2'), \n                description: $translate.instant('OFERTA_VALIDA', {couponValue: window.globals.COUPON_VALUE}),\n                // imgUrl: 'https://picsum.photos/400/250/?random',\n                imgUrl: '/assets/promo2.jpg',\n                steps: [\n                    'STEP1',\n                    $translate.instant('STEP2', {couponCode: window.globals.COUPON_CODE}),\n                    'STEP3',\n                ]\n            };\n\n            $scope.productTeasers = {\n                tryAndBuy: {\n                    description: 'TRY_AND_BUY_INFO',\n                    link: `https://paladintrue.com/${appStateManager.currentLang}/${window.globals.SUPPORTED_LANGS.find((lang) => appStateManager.currentLang == lang.code).tryAndBuyWordPressPath}/`,\n                },\n                homeAppliance: {\n                    categoryId: enums.categoriesIds.homeAppliance,\n                },\n                smartMobility: {\n                    categoryId: enums.categoriesIds.smartMobility,\n                },\n                hiTech: {\n                    categoryId: enums.categoriesIds.hiTech,\n                },\n                outdoor: {\n                    categoryId: enums.categoriesIds.outdoor,\n                }\n            };\n\n            $scope.takingAboutUsImages = [\n                {\n                    img: \"assets/talkingAboutUs/nuvola_testata-black-white_squared.jpg\",\n                    link: 'http://nuvola.corriere.it/2017/04/26/paladin-lapp-di-noleggio-di-oggetti-tra-privati/',\n                },\n                {\n                    img: 'assets/talkingAboutUs/corriere-sera-square-1.jpg',\n                    link: 'http://www.corriere.it/tecnologia/app-software/17_aprile_27/paladin-l-app-mettere-noleggio-oggetti-che-non-usiamo-750154f0-2b76-11e7-9442-4fba01914cee.shtml',\n                },\n                {\n                    img: \"assets/talkingAboutUs/deejay_Logo-black-white.jpg\",\n                    link: 'https://www.deejay.it/audio/20170430-4/520066/',\n                },\n                {\n                    img: \"assets/talkingAboutUs/green-me-black-white.jpg\",\n                    link: 'https://www.greenme.it/tecno/cellulari/23899-paladin-app-affitto-oggetti',\n                },\n                {\n                    img: 'assets/talkingAboutUs/webnews-black-white.jpg',\n                    link: 'http://www.webnews.it/2017/05/05/paladin-sharing-applicazione-economia-startup/',\n                },\n                {\n                    img:'assets/talkingAboutUs/logo-lifegate-radio-black-white.jpeg',\n                    link:'https://www.lifegate.it/radio-sound'\n                },\n                {\n                    img:'assets/talkingAboutUs/logo-radio-popolare-black-white.jpeg',\n                    link:'http://www.radiopopolare.it/podcast/pionieri-di-lun-2310/'\n                },\n                {\n                    img:'assets/talkingAboutUs/green-planner-black-white.jpeg',\n                    link:'https://www.greenplanner.it/2017/10/10/paladin-noleggio-strumenti/'\n                },\n                {\n                    img:'assets/talkingAboutUs/logo-Rai3-black-white.jpeg',\n                    link:'http://www.rai.it/rai3/',\n                }\n\n            ];\n\n            $scope.getHomePageData = () => {\n                $scope.isLoading = true;\n                apiService.pages.getHomePageData([\n                    $scope.productTeasers.hiTech.categoryId,\n                    $scope.productTeasers.smartMobility.categoryId,\n                    $scope.productTeasers.homeAppliance.categoryId,\n                    $scope.productTeasers.outdoor.categoryId,\n                    ])\n                    .then((response) => {\n                        $scope.isLoading = false;\n                        $scope.data = response.Data;\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        $scope.data = {};\n                    })\n            };\n\n            $scope.getCategoryName = (categoryId) => {\n                const category = $scope.data.Categories.find((item) => item.CategoryId == categoryId);\n                if (category)\n                    return category.CategoryName;\n            }\n\n            $scope.getProductList = (categoryId, isTryAndBuy) => {\n                if (categoryId == 0) {\n                    return isTryAndBuy ? $scope.data.TryAndBuyProducts : $scope.data.P2PProducts;\n                }\n\n                const category = $scope.data.Categories.find((item) => item.CategoryId == categoryId);\n                if (category)\n                    return category.ProductList;\n            }\n\n            $scope.getPopularTryAndBuy = () => {\n                $scope.isLoading = true;\n                apiService.products.getPopularTryAndBuy()\n                    .then((response) => {\n                        $scope.isLoading = false;\n                        $scope.tryAndBuy = response.Data\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        $scope.tryAndBuy = [];\n                    })\n            } ;\n            $scope.getHomePageData();\n\n            // $scope.getPopularTryAndBuy();\n\n            ngMeta.setTitle($translate.instant('HOME_TITLE'));\n            ngMeta.setTag('description', $translate.instant('DEFAULT_META_DESC'));\n            ngMeta.setTag('imagePath', '../../assets/paladin-logo-300x300.png');\n\n            $scope.promoTimeout = $timeout( () => {\n                if(!$scope.isCrawler()){\n                    if (appStateManager.user == null && !angular.element(document.body).hasClass('md-dialog-is-showing')) {\n                        popupService.showLoginSignupPopup(true);\n                    }\n                }\n            }, referralsService.referralCode ? 0 : window.globals.PROMO_SIGNUP_TIMER);\n\n            $scope.isCrawler = () => {\n                \n                return /bot|prerender|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent);\n                \n            }\n            $scope.$on('$destroy', () => {\n\n                // while (deregs.length)\n                //     deregs.pop()();\n\n                $timeout.cancel($scope.promoTimeout);\n            });\n\n            $scope.showToast = (message,delay = 3000) => {\n                $mdToast.show(\n                    $mdToast.simple()\n                        .textContent(message)\n                        .hideDelay(delay)\n                );\n            };\n\n        }]);\n\n\n// angular.module('productPreview', ['resources.products', 'resources.filters','directives.header','directives.footer','resources.constants',\n//     'uiGmapgoogle-maps','ui.bootstrap','ngMeta','ngMap','pascalprecht.translate','angularReverseGeocode'])\n//\n//     .config(['$routeProvider', function ($routeProvider,GoogleMapApi) {\n//\n//         $routeProvider.when('/:languageCode/product/:productId', {\n//             templateUrl:'/script/productPreview/productPreview.tpl.html',\n//             reloadOnSearch: false,\n//             controller:'PreviewController'\n//         }).when('/product/:productId', {\n//             templateUrl:'/script/productPreview/productPreview.tpl.html',\n//             reloadOnSearch: false,\n//             controller:'PreviewController'\n//         });\n//\n//\n//     }])\n\nangular.module('paladinApp')\n    .controller('PreviewController', ['$scope','$sce','$window','$rootScope','$translate','$stateParams', '$location',\n        'Products','ngMeta','$filter','$anchorScroll','ZendeskWidget','Filters','enums',\n        function ($scope,$sce,$window,$rootScope,$translate,$stateParams, $location,Products,ngMeta,NgMap, $anchorScroll,ZendeskWidget,Filters,enums) {\n\n            var scope = $scope;\n\n            scope.getCurrentLanguageCode = function(){\n                return $translate.proposedLanguage()?$translate.proposedLanguage(): $translate.preferredLanguage();\n            };\n            //Lender rating\n            scope.rating = 0;\n            scope.ratingRounded = 0;\n            //Profile default image path\n            scope.profileDefaultImage=\"../../assets/profile.png\";\n\n\n            //console.log('ROOT SCOPE : ')\n            //console.log($routeParams);\n\n            var product_id = $stateParams.productId.split('-')[ $stateParams.productId.split('-').length-1 ];\n            var languageCode = $stateParams.languageCode ? $stateParams.languageCode : scope.getCurrentLanguageCode();\n            updateHreflang();\n            //updating language code globally if user comes directly to this page\n            $translate.use(languageCode);\n            $rootScope.lang = languageCode;\n            ZendeskWidget.setLocale(languageCode);\n            $rootScope.$broadcast('updateLanguage',languageCode);\n\n            var searchedLocation = $rootScope.searchedLocation;// $location.search().searchedLocation;\n\n            scope.allCategory = $translate.instant('ACTG');\n            if(scope.allCategory == scope.selectedCategoryName)scope.selectedCategoryName=null;\n\n            //console.log( scope.selectedCategoryName)\n            //console.log(scope.allCategory)\n            //console.log(scope.allCategory == scope.selectedCategoryName);\n\n            scope.selectedSubCategoryName =$rootScope.subcategory;//$location.search().subcategory?$location.search().subcategory.replace(/-/g, ' '):null;\n\n            scope.productDetail={};\n            scope.productImageBaseUrl = window.globals.PRODUCT_IMAGE_URL;\n            scope.userImageBaseUrl = window.globals.PROFILE_IMAGE_URL;\n            scope.rentNowUrl = window.globals.RENT_NOW_URL;\n            scope.h1 = '';\n            scope.h2 = '';\n            scope.productAddress='';\n            scope.sample =1;\n\n            function updateBreadcrumb(){\n                if (scope.productDetail.Product_CategoryId) {\n                    scope.selectedCategoryName = Filters.getCategoryById(scope.productDetail.Product_CategoryId, languageCode).Category_Name;\n                }\n\n                if (scope.productDetail.Product_SubCategoryId) {\n                    scope.selectedSubCategoryName = Filters.getSubcategoryById(scope.productDetail.Product_SubCategoryId, languageCode).SubCategory_Name;\n                }\n            }\n\n\n            scope.fetchProductAddress = function(){\n                var data = {};\n\n                data.location = {};\n                //console.log(scope.productDetail.Product_Latitude);\n                data.location.lat = Number(scope.productDetail.Product_Latitude);\n                data.location.lng = Number(scope.productDetail.Product_Longitude);\n\n                geocoder = new google.maps.Geocoder();\n                var _scope = scope;\n                geocoder.geocode(data, function(results, status) {\n                    if(results && results.length > 0){\n                        scope.productLocation = results[0];\n                        scope.setProductAddress(results[0]);\n                    }\n                });\n            }\n\n            scope.setProductAddress= function(loc){\n                $scope.productDetail.productAddress= loc.formatted_address;\n                scope.sample = 2;\n                scope.productLocation = loc;\n                //console.log('SETTING ADD : '+$scope.productDetail.productAddress);\n                scope.updateMetaTags();\n                $scope.$apply();\n            }\n\n            scope.getCity = function(result){\n                var country='',state='',city='';\n                for(var i=0 ;i<result.address_components.length;i++){\n                    var types = result.address_components[i].types;\n                    for(var j=0;j<types.length;j++){\n                        var type = types[j];\n                        if(type=='country' || type==\"political\"){\n                            country = result.address_components[i].long_name;\n                            break;\n                        }else if(type=='administrative_area_level_1'){\n                            state = result.address_components[i].long_name;\n                            break;\n                        }else if((type=='administrative_area_level_2' && !city) || type=='locality'){\n                            city = result.address_components[i].long_name;\n                            break;\n                        }\n\n                    }\n                }\n                return city;\n\n                //var shortAddress = (city ? city+',':'' )+(state ? state+',':'' )+(country ? country:'' );\n                //return shortAddress;\n            }\n\n            scope.$on('languageChanged', function(event,data){\n                $location.update_path($location.path().replace('/' + languageCode+'/','/'+data+'/'), true);\n                languageCode = data;\n                scope.refreshProductDetail();\n                ZendeskWidget.setLocale(languageCode);\n                updateBreadcrumb();\n            });\n            scope.getPageTitle= function(){\n                var title = $translate.instant('RENT')+' ';\n\n                //console.log('meta tag :')\n                //console.log(scope.selectedCategoryName);\n\n                if(scope.selectedCategoryName && !scope.selectedSubCategoryName){\n                    title +=scope.selectedCategoryName+ ' ';\n                }else if(scope.selectedSubCategoryName){\n                    title += scope.selectedSubCategoryName + ' ';\n                }\n\n                if(scope.productDetail && scope.productDetail.Product_Title){\n                    title += scope.productDetail.Product_Title +'  ';\n                }\n\n                if(scope.productLocation){\n                    title += $translate.instant('IN')+' '+scope.getCity(scope.productLocation);\n                }\n\n                return title;\n            }\n\n            scope.getMetaTags= function(){\n                var tag = $translate.instant('RENT')+' ';\n\n                if(scope.selectedCategoryName){\n                    tag += scope.selectedCategoryName+ ' ';\n                }\n                if(scope.selectedSubCategoryName){\n                    tag += scope.selectedSubCategoryName + ' ';\n                }\n\n                if(scope.productDetail && scope.productDetail.Product_Title){\n                    tag += scope.productDetail.Product_Title +'  ';\n                }\n\n\n                if(scope.productLocation){\n                    tag += $translate.instant('IN')+' '+scope.getCity(scope.productLocation);\n                }\n                return tag;\n            }\n\n            scope.updateH1 = function(){\n                scope.h1 = $translate.instant('RENT')+' ';\n\n                /*\n                if(scope.selectedCategoryName && !scope.selectedSubCategoryName){\n                  scope.h1 += capitalizeFilter(scope.selectedCategoryName)+ ' ';\n                }else if(scope.selectedSubCategoryName){\n                  scope.h1 += capitalizeFilter(scope.selectedSubCategoryName) + ' ';\n                }\n                */\n\n                if(scope.productDetail && scope.productDetail.Product_Title){\n                    scope.h1 +='<span class=\"greenText\">'+scope.productDetail.Product_Title +'</span> ';\n                }\n\n\n                if(scope.productLocation){\n                    scope.h1 += $translate.instant('IN')+' '+scope.getCity(scope.productLocation);\n                }\n\n                //console.log('setting h1 = '+scope.h1)\n                scope.h1 =$sce.trustAsHtml(scope.h1);\n            }\n\n            scope.updateH2 = function(){\n                scope.h2 = scope.getPageTitle();\n            }\n\n            scope.updateMetaTags= function(){\n                if(scope.productDetail){\n\n                    ngMeta.setTitle(scope.getPageTitle());\n                    ngMeta.setTag('description',scope.getMetaTags());\n                    ngMeta.setTag('imagePath', window.globals.PRODUCT_IMAGE_URL + scope.productDetail.ProductImage_Image1);\n\n                    scope.updateH1();\n\n                    scrollToH1();\n                    //scope.updateH2();\n                }\n            }\n            scope.refreshProductDetail = function(){\n                //console.log('PRODUCT ID IS : '+product_id);\n\n                if(product_id){\n                    Products.getDetail(product_id,languageCode,function(response){\n                        scope.productDetail = response.data.Data;\n                        scope.rating=scope.productDetail.User_ReviewAsLender>0\n                            ? parseFloat(scope.productDetail.User_ReviewAsLender/2).toFixed(1)\n                            : 0;\n                        scope.ratingRounded = Math.round(scope.rating);\n                        scope.fetchProductAddress();\n\n                        if (!$rootScope.categoriesMap) {\n                            $rootScope.categoriesMap = new Map();\n                            Filters.get('it', function(response){\n                                $rootScope.categoriesMap.set('it', response.data.Data);\n                                Filters.get('en', function(response){\n                                    $rootScope.categoriesMap.set('en', response.data.Data);\n                                    Filters.get('de', function(response){\n                                        $rootScope.categoriesMap.set('de', response.data.Data);\n                                        updateBreadcrumb();\n                                        scope.updateMetaTags();\n                                    });\n\n                                });\n\n                            });\n                        } else {\n                            updateBreadcrumb();\n                        }\n                    })\n                }\n            }\n\n            scope.goToAllCategory = function(){\n                if ($rootScope.filter) {\n                    $rootScope.filter.category.selectedCategoryId = null;\n                    $rootScope.filter.category.selectedCategoryDesc =null;\n                    $rootScope.filter.category.selectedCategoryName =$translate.instant('ACTG');\n                    $rootScope.filter.category.selectedCategoryImagePath=null;\n                    $rootScope.filter.category.selectedCategoryBannerImage = enums.categoriesBannersPaths.all;\n\n                    $rootScope.filter.category.selectedSubCategoryId = null;\n                    $rootScope.filter.category.selectedSubCategoryDesc =null;\n                    $rootScope.filter.category.selectedSubCategoryName =null;\n                    $rootScope.filter.category.selectedSubCategoryImagePath = null;\n                    $rootScope.filter.category.selectedSubCategoryBannerImage = null;\n\n                    $rootScope.filter.currentPage = 1;\n                }\n\n                $location.search('key', null)\n                $location.url('/'+languageCode+'/'+$translate.instant('ACTG').replace(/ /g,'-'));\n            }\n\n\n            scope.goToCategory = function(){\n\n                if ($rootScope.filter) {\n                    var category = Filters.getCategoryById(scope.productDetail.Product_CategoryId,languageCode);\n                    $rootScope.filter.category.selectedCategoryId = scope.productDetail.Product_CategoryId;\n                    $rootScope.filter.category.selectedCategoryDesc =$sce.trustAsHtml(category.Category_Description);\n                    $rootScope.filter.category.selectedCategoryName =category.Category_Name;\n                    $rootScope.filter.category.selectedCategoryImagePath=category.Category_ImagePath;\n                    $rootScope.filter.category.selectedCategoryBannerImage = category.Category_BannerPath;\n\n                    $rootScope.filter.category.selectedSubCategoryId = null;\n                    $rootScope.filter.category.selectedSubCategoryDesc =null;\n                    $rootScope.filter.category.selectedSubCategoryName =null;\n                    $rootScope.filter.category.selectedSubCategoryImagePath = null;\n                    $rootScope.filter.category.selectedSubCategoryBannerImage = null;\n\n                    $rootScope.filter.currentPage = 1;\n                }\n\n                $location.search('key', null);\n                //$location.url('/'+languageCode+'/'+scope.selectedCategoryName);\n                $location.url('/'+languageCode+'/'+scope.selectedCategoryName.replace(/ /g, '-'));\n\n            }\n\n            scope.goToSubCategory = function(){\n                if ($rootScope.filter) {\n                    var category = Filters.getCategoryById(scope.productDetail.Product_CategoryId,languageCode);\n                    $rootScope.filter.category.selectedCategoryId = scope.productDetail.Product_CategoryId;\n                    $rootScope.filter.category.selectedCategoryDesc =$sce.trustAsHtml(category.Category_Description);\n                    $rootScope.filter.category.selectedCategoryName =category.Category_Name;\n                    $rootScope.filter.category.selectedCategoryImagePath=category.Category_ImagePath;\n                    $rootScope.filter.category.selectedCategoryBannerImage = category.Category_BannerPath;\n\n                    var subCategory = Filters.getSubcategoryById(scope.productDetail.Product_SubCategoryId, languageCode);\n                    $rootScope.filter.category.selectedSubCategoryId = scope.productDetail.Product_SubCategoryId;\n                    $rootScope.filter.category.selectedSubCategoryDesc =$sce.trustAsHtml(subCategory.SubCategory_Description);\n                    $rootScope.filter.category.selectedSubCategoryName =subCategory.SubCategory_Name;\n                    $rootScope.filter.category.selectedSubCategoryImagePath = subCategory.SubCategory_ImagePath;\n                    $rootScope.filter.category.selectedSubCategoryBannerImage = subCategory.SubCategory_BannerPath;\n\n                    $rootScope.filter.currentPage = 1;\n                }\n                $location.search('key', null);\n                $location.url('/'+languageCode+'/'+scope.selectedCategoryName.replace(/ /g, '-')+'/'+scope.selectedSubCategoryName.replace(/ /g, '-'));\n                //$window.history.back();\n            };\n\n            function updateHreflang() {\n                ngMeta.setTag('currentUrl_en', $location.absUrl().replace('/' + languageCode+'/','/en/'));\n                ngMeta.setTag('currentUrl_it', $location.absUrl().replace('/' + languageCode+'/','/it/'));\n                ngMeta.setTag('currentUrl_de', $location.absUrl().replace('/' + languageCode+'/','/de/'));\n            }\n\n            scope.go = function ( path ) {\n                $location.$$search = {};\n                $location.path( path );\n            };\n\n            scope.rentNow = function(){\n                var url  = scope.rentNowUrl.replace('{0}',languageCode).replace('{1}',scope.productDetail.Product_Id);\n\n                $window.location.href =  url ;\n            };\n\n            scope.rentNowDesktop = function(){\n                $window.location.href = $translate.instant('URL_DOWNLOAD');\n            };\n\n            var scrollToH1 = function() {\n                //scroll preview page up at startup\n                var oldAnchor = $location.hash();\n                $location.hash(\"breadcrumb-pr-detail\");\n                $anchorScroll();\n                $location.hash(oldAnchor);\n            };\n\n            scope.refreshProductDetail();\n            /*\n               $scope.$on('$routeChangeSuccess', function () {\n                scrollToH1();\n              });\n              */\n        }]);\n\n\nangular.module('paladinApp')\n    .controller('productDetailedController',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'apiService',\n        '$stateParams',\n        'toastService',\n        'appStateManager',\n        'dataService',\n        '$sce',\n        'NgMap',\n        'popupService',\n        '$timeout',\n        'moment',\n        'ngMeta',\n        '$translate',\n        'ptUtils',\n        '$anchorScroll',\n        '$location',\n        'referralsService',\n        function ($rootScope,\n                  $scope,\n                  enums,\n                  apiService,\n                  $stateParams,\n                  toastService,\n                  appStateManager,\n                  dataService,\n                  $sce,\n                  NgMap,\n                  popupService,\n                  $timeout,\n                  moment,\n                  ngMeta,\n                  $translate,\n                  ptUtils,\n                  $anchorScroll,\n                  $location,\n                  referralsService) {\n            $scope.isLoading = false;\n            if ($stateParams.productNameAndId) {\n                $scope.productId = $stateParams.productNameAndId.split('-') [$stateParams.productNameAndId.split('-').length - 1];\n            }\n            $scope.category = null;\n            $scope.subCategory = null;\n            $scope.rentPickersIds = {\n                mobile: 'rental-request-picker-mobile',\n                desktop: 'rental-request-picker-desktop',\n            };\n            $scope.productAddress = {\n                address: undefined,\n                lat: undefined,\n                lng: undefined,\n\n            };\n            $scope.productBookingDetails = null;\n\n            $scope.isLoggedInUser = () => {\n                return appStateManager.getUserId();\n            }\n            $scope.updateMetaTags = () => {\n                if($scope.product){\n\n                    ngMeta.setTitle($scope.getPageTitle());\n                    ngMeta.setTag('description',$scope.getPageTitle());\n                    ngMeta.setTag('imagePath', window.globals.PRODUCT_IMAGE_URL + $scope.product.ProductImage_Image1);\n\n                }\n            }\n\n            $scope.getPageTitle= () => {\n                var title = $translate.instant('RENT')+' ';\n\n                // if($scope.category && !$scope.subCategory) {\n                //     title +=$scope.category.Category_Name + ' ';\n                // }else if($scope.subCategory){\n                //     title += $scope.subCategory.SubCategory_Name + ' ';\n                // }\n\n                if($scope.product && $scope.product.Product_Title){\n                    title += $scope.product.Product_Title +'  ';\n                }\n\n                // if(scope.productLocation){\n                //     title += $translate.instant('IN')+' '+scope.getCity(scope.productLocation);\n                // }\n\n                return title + \"| Paladintrue\";\n            }\n\n            $scope.fetchDetailedProduct = () => {\n                $scope.isLoading = true;\n                apiService.products.getDetailedProduct($scope.productId)\n                    .then((response) => {\n                        $scope.product = response.Data;\n                        $scope.isMyProduct = $scope.product.Lender_UserId == appStateManager.getUserId();\n                        $scope.product.Product_Description = $sce.trustAsHtml($scope.product.Product_Description);\n\n\n                        ptUtils.extractAndGeoLocateAddressFromObjectForFieldNames({\n                            object: $scope.product,\n                            addressFieldName: 'Product_Address',\n                            latFieldName: 'Product_Latitude',\n                            lngFieldName: 'Product_Longitude'\n                        })\n                            .then((location) => {\n                                $scope.productAddress = location;\n                            });\n\n                        if (appStateManager.getUserId()) {\n                            $scope.fetchBookingDetails();\n                        }    \n                        \n                        $scope.getCategory();\n                        $scope.updateMetaTags();\n                        $scope.isLoading = false;\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        toastService.simpleToast(JSON.stringify(err));\n                        console.error(err)\n                    })\n            };\n            $scope.fetchBookingDetails = () => {\n                apiService.products.getProductBookingDetails({\n                    productId: $scope.product.Product_Id,\n                    userId: appStateManager.getUserId()\n                })\n                    .then((response) => {\n                        $scope.productBookingDetails = response.Data;\n                        $scope.isLoading = false;\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        console.error(err)\n                    })\n            };\n\n            $scope.getCategory = () => {\n                if (!appStateManager.categoriesDict) {\n                    return dataService.getCategories()\n                }\n                if ($scope.product) {\n                    $scope.category = appStateManager.categoriesDict[$scope.product.Product_CategoryId];\n                    if ($scope.category && $scope.product.Product_SubCategoryId > 0) {\n                        const subCat = $scope.category.Category_SubCatrgories.find((subCat) => subCat.SubCategory_Id == $scope.product.Product_SubCategoryId);\n                        if (subCat)\n                            $scope.subCategory = subCat;\n                    }\n                }\n            };\n\n            $scope.requestRentalDates = () => {\n                popupService.showDateRangePicker($scope.productBookingDetails,$scope.product)\n                    .then((data) => {\n                        const startDate = moment(data.dateStart);\n                        const endDate = moment(data.dateEnd);\n                        const days = ptUtils.getRentalPeriodInDays({\n                            startRentDate: data.dateStart,\n                            endRentDate: data.dateEnd\n                        });\n                        if ($scope.product.MinRentalPeriod > 0 && days < $scope.product.MinRentalPeriod) {\n                             return popupService.showAlert('OOPS',$translate.instant('INVALID_MIN_RENTAL_PERIOD', {days: $scope.product.MinRentalPeriod}))\n                                .finally(() => {\n                                    $scope.requestRentalDates();\n                                \n                            })\n                        }\n                               \n                        $scope.onRequestRent({\n                            startDate,\n                            endDate\n                        });\n                    })\n            };\n\n            $scope.onRequestRent = function ({startDate,endDate,componentId}) {\n                if (startDate && endDate) {\n                    $rootScope.$emit(enums.busNavigation.paymentDetailed,{\n                        startDate,\n                        endDate,\n                        productId: $scope.productId,\n                    })\n                }\n                // toastService.simpleToast(`Rental request not implemented yet, startDate: ${moment(startDate).format('DD/MM/YY')} endDate ${moment(endDate).format('DD/MM/YY')}`);\n            };\n\n            $scope.onDatesUpdated = ({startDate,endDate,componentId}) => {\n                const compToUpdate = componentId == $scope.rentPickersIds.desktop ? $scope.rentPickersIds.mobile : $scope.rentPickersIds.desktop\n                $rootScope.$emit(enums.busEvents.rentalRequestPickerUpdateDates,\n                    {startDate,endDate, componentId : compToUpdate })\n            };\n\n            $scope.browseCategory = (cat, subCat) => {\n                $rootScope.$emit(enums.busNavigation.browseCategory,{categoryName: cat,subCategoryName: subCat});\n            } ;\n\n            $scope.getCategoriesUrl = (cat, subCat) => {\n\n                return ptUtils.getCategoriesUrl(cat, subCat, $scope.product.Product_TryAndBuy, $translate.use());\n            }\n\n            $scope.onStartEndDateSelected = ({startDate, endDate}) => {};\n\n\n            let deregs = [];\n            deregs.push($rootScope.$on(enums.busEvents.categoriesUpdate,(event,data) => {\n                $scope.getCategory();\n            }));\n\n            // deregs.push($scope.$on('$viewContentLoaded', function() {\n            // }));\n   \n            $scope.fetchDetailedProduct();\n            \n            $scope.promoTimeout = $timeout( () => {\n                if(!ptUtils.isCrawler()){\n                    if (appStateManager.user == null && !angular.element(document.body).hasClass('md-dialog-is-showing')) {\n                        popupService.showLoginSignupPopup(true);\n                    }\n                }\n            }, referralsService.referralCode ? 0 : window.globals.PROMO_SIGNUP_TIMER);\n            \n            $scope.$on('$destroy',() => {\n                while (deregs.length) {\n                    deregs.pop()()\n                }\n                $timeout.cancel($scope.promoTimeout);\n            });\n            \n            //scroll to top (workaround)\n            var oldAnchor = $location.hash();\n            $location.hash(\"main-product-image\");\n            $anchorScroll();\n            $location.hash(oldAnchor);\n        }]);\nangular.module('paladinApp')\n    .controller('appController', [\n        '$scope',\n        '$rootScope',\n        'ZendeskWidget',\n        'enums',\n        'ptLog',\n        'appStateManager',\n        'dataService',\n        '$state',\n        '$location',\n        '$mdToast',\n        '$mdMedia',\n        function(\n            $scope,\n            $rootScope,\n            ZendeskWidget,\n            enums,\n            ptLog,\n            appStateManager,\n            dataService,\n            $state,\n            $location,\n            $mdToast,\n            $mdMedia) {\n            // $rootScope.lang =  localStorage.getItem(enums.localStorageKeys.preferredLanguage) || 'it';\n            $rootScope.isAppOnline = true;\n            //if any error this will log\n            $scope.$on(enums.busEvents.$routeChangeError, function(event, current, previous, rejection){\n                ptLog.log('route change error');\n                ptLog.log(rejection);\n            });\n\n            if ($state.includes('app.emailVerification') && Object.keys($location.search())[0] != undefined) {\n                $rootScope.$emit(enums.busEvents.triggerEmailValidation,{userId: Object.keys($location.search())[0]});\n            }\n\n            let deregs = [];\n            deregs.push($rootScope.$on(enums.busEvents.locationUpdate,(event,data) => {\n                // $mdToast.show(\n                //     $mdToast.simple()\n                //         .textContent('Location update')\n                //         .hideDelay(3000)\n                // );\n            }));\n\n            deregs.push($rootScope.$on(enums.busEvents.scrollMainScrollerToTop,(event,data) => {\n                // let isAnimated = false;\n                //\n                // if (data && data.isAnimated)\n                //     isAnimated = data.isAnimated;\n                document.getElementById('main-ui-view').scrollTo(0,0)\n            }));\n\n            if ($mdMedia('gt-sm'))\n                ZendeskWidget.show();\n            else\n                ZendeskWidget.hide();\n\n            deregs.push(\n                $scope.$watch(function () {return $mdMedia('gt-sm') },function (mgMd) {\n                    if (mgMd) {\n                        ZendeskWidget.show()\n                    } else {\n                        ZendeskWidget.hide()\n                    }\n                })\n            );\n\n\n\n            $scope.$on('$destroy',function () {\n                while (deregs.length)\n                    deregs.pop()();\n            })\n        }]);\nangular.module('paladinApp')\n    .controller('userProfileController',[\n        '$rootScope',\n        '$scope',\n        'appStateManager',\n        'apiService',\n        '$stateParams',\n        '$state',\n        'toastService',\n        'enums',\n        'popupService',\n        '$translate',\n        'ptLog',\n        'ptUtils',\n        function ($rootScope,\n            $scope,\n            appStateManager,\n            apiService,\n            $stateParams,\n            $state,\n            toastService,\n            enums,\n            popupService,\n            $translate,\n            ptLog,\n            ptUtils) {\n\n            console.log('userProfileController $scope ', $scope);\n\n            $scope.isLoading = false;\n            $scope.isMyProfile = false;\n            $scope.isEditing = false;\n            $scope.isUpdating = false;\n            $scope.userId = $stateParams.userId;\n            $scope.editableProfile = null;\n            $scope.tempBas64Image = null;\n\n            if ($state.includes('app.profiles.myProfile')) {\n                $scope.isMyProfile = true;\n                if (!$scope.userId) {\n                    if (appStateManager.getUserId())\n                        $scope.userId = appStateManager.getUserId();\n                    else\n                        $state.go('app.home');\n                }\n            } else if ($scope.userId == appStateManager.getUserId())\n            $state.go('app.profiles.myProfile',{userId: $scope.userId});\n\n            $scope.fetchUserProfile = () => {\n                $scope.profile = null;\n                $scope.isLoading = true;\n                let {\n                    userId\n                } = $scope;\n                apiService.users.getUserProfile({userId})\n                    .then((response) => {\n                        $scope.profile = response.Data;\n\n                        getUserCredit();\n\n                        ptUtils.extractAndGeoLocateAddressFromObjectForFieldNames({\n                            object: $scope.profile,\n                            addressFieldName: 'User_Address',\n                            latFieldName: 'User_Latitude',\n                            lngFieldName: 'User_Longitude'\n                        })\n                            .then((location) => {\n                                $scope.profile.User_Address = location.address;\n                            });\n                        $scope.isLoading = false;\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        toastService.simpleToast(err.data.Message || $translate.instant('DEFAULT_ERROR'));\n                    })\n            };\n\n            $scope.editProfile = () => {\n                let {\n                    User_Address,\n                    User_FullName\n                } = $scope.profile;\n                $scope.editableProfile = angular.copy($scope.profile);\n                const fullName = User_FullName.split(' ');\n                $scope.editableProfile.userFirstName = fullName[0];\n                $scope.editableProfile.userLastName = fullName.length > 1 ? fullName[1] : '';\n                $scope.isEditing = true;\n            };\n\n            $scope.submitProfileEdit = () => {\n                $scope.editableProfile.User_FullName = $scope.editableProfile.userFirstName + ' ' + ($scope.editableProfile.userLastName || '');\n                const objToSend = angular.copy($scope.editableProfile);\n                delete objToSend.userFirstName;\n                delete objToSend.userLastName;\n                $scope.isUpdating = true;\n                apiService.users.editProfile(objToSend)\n                    .then(() => {\n                        apiService.users.updateNotificaton({\n                            userId: $scope.userId,\n                            emailNotif: objToSend.Notification_Email || false,\n                            chatNotif: objToSend.Notification_Chat || false,\n                        })\n                            .then((res) => {\n                                location.reload();\n                            })\n                            .catch((err) => {\n                                $scope.isUpdating = false;\n                                toastService.simpleToast(err.data.Message);\n                                console.error(err);\n                            })\n                    })\n                    .catch((err) => {\n                        $scope.isUpdating = false;\n                        toastService.simpleToast(err.data.Message);\n                    })\n            };\n\n\n            $scope.uploadImage = () => {\n                angular.element(document.getElementById('uploadImageBtn'))[0].click();\n            };\n\n            $scope.onUploaded = (inputElement) => {\n                toastService.simpleToast($translate.instant('UPLOADING_IMAGE'));\n                if (inputElement && inputElement.files && inputElement.files.length > 0) {\n                    canvasResize(inputElement.files[0], {\n                        quality: 75,\n                        isPreprocessing: true,\n                        cardType: '',\n                        maxW: 2048,\n                        maxH: 2008,\n                        isiOS: ptUtils.isMobile.iOS(),\n                        callback: function (data, width, height) {\n                            $scope.$evalAsync(() => {\n                                $scope.editableProfile.User_DisplayPicture = data.split(',')[1];\n                                $scope.tempBas64Image = data;\n                                toastService.simpleToast($translate.instant('IMAGE_UPLOADED'));\n                            })\n                        }\n                    });\n                } else {\n                    // No file uploaded\n                }\n            };\n\n\n            $scope.changePassword = () =>  {\n                popupService.showChangePassword()\n                    .then(() => toastService.simpleToast($translate.instant('PASSWORD_SUCCESSFULLY_CHANGED')))\n                    .catch(() => ptLog.log('pass change Canceled'))\n            };\n\n            $scope.logout = () => {\n                $rootScope.$emit(enums.busEvents.userLogout);\n            };\n\n\n            $scope.deleteAccount = () => {\n                popupService.showConfirm(\n                    $translate.instant('WARN'),\n                    $translate.instant('DEL_ACCOUNT_CONFIRM_MESSAGE'))\n                    .then(() => {\n                        //TODO: - delete account\n                        $scope.isLoading = true;\n                        apiService.users.deleteAccount($scope.userId)\n                            .then(() => {\n                                $scope.isLoading = false;\n                                popupService.showAlert($translate.instant('DEL_ACCOUNT'),\n                                    $translate.instant('DEL_ACCOUNT_SUCCESS'))\n                                    .finally(() => {\n                                        $rootScope.$emit(enums.busEvents.userLogout);\n                                    })\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                                popupService.showAlert(\n                                    $translate.instant('DEL_ACCOUNT'),\n                                    err.data.Message || $translate.instant('DEFAULT_ERROR'))\n                                    .finally(() => {\n                                    })\n                            })\n                    })\n                    .catch(() => {\n                        // Delete account canceled\n                    })\n            };\n\n            let copyReferralLink = (containerid) => {\n                // TODO: make this a directive or utility\n\n                if (document.selection) {\n                    var range = document.body.createTextRange();\n                    range.moveToElementText(document.getElementById(containerid));\n                    range.select().createTextRange();\n                    document.execCommand(\"copy\");\n\n                } else if (window.getSelection) {\n                    var range = document.createRange();\n                    range.selectNode(document.getElementById(containerid));\n                    window.getSelection().addRange(range);\n                    document.execCommand(\"copy\");\n                    console.info(\"text copied\")\n                }\n            }\n\n\n            let shareReferralLink = () => {\n                // open popup with social media buttons\n                console.log('open share referral link popup ', popupService, ' .. ', $scope.referralLink);\n\n                popupService.showShareReferralLink($scope.credit.ReferralCode);\n\n            };\n\n            let getUserCredit = () => {\n                let {\n                    userId\n                } = $scope;\n\n                apiService.users.getUserCredit({userId})\n                    .then(\n                        (result) => {\n                            console.log('user.credit ', result)\n\n                            $scope.credit = result.Data;\n\n                            $scope.credit.shareReferralLink = shareReferralLink;\n                        },\n                        (reason) => {\n                            console.log('getUserCredit failed because: ', reason);\n\n                        });\n\n            };\n\n           $scope.fetchUserProfile();\n\n\n            let deregs = [];\n\n            deregs.push($rootScope.$on(enums.busEvents.googlePlacesAutocompletePlaceChanged,(event,data) => {\n                if (data.elementId == 'editProfileAddressField') {\n                    let { place } = data, { geometry } = place;\n\n                    $scope.editableProfile.User_Latitude = geometry.location.lat();\n                    $scope.editableProfile.User_Longitude = geometry.location.lng();\n                    $scope.editableProfile.User_LocationId = place.id;\n                }\n            }));\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()()\n            });\n        }\n    ]);\n\nangular.module('paladinApp')\n    .controller('newProductController',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        'uploadHandler',\n        'toastService',\n        '$translate',\n        'gtmService',\n        'ptUtils',\n        function ($rootScope,\n                  $scope,\n                  enums,\n                  appStateManager,\n                  apiService,\n                  uploadHandler,\n                  toastService,\n                  $translate,\n                  gtmService,\n                  ptUtils) {\n            $scope.isLoading = true;\n            $scope.emptyProductImage = enums.categoriesBannersPaths.addProduct;\n            $scope.subCategories = [];\n\n            $scope.userAddress =  undefined;\n            $scope.isUseUserAddress = { value: false };\n\n\n            $scope.newProductModel = {\n                Product_Title:'',\n                Product_Description:'',\n\n                Product_ItemCategory_Id: 0,\n                Product_SubCategoryId: 0,\n                Product_LenduserId: appStateManager.getUserId(),\n                Product_TryAndBuy: false,\n                Product_IsShop: false,\n                Product_ShopURL: '',\n                Product_Price_Perday: null,\n                Product_City: '',\n                Price7Day: null,\n                Price15Day: null,\n            };\n\n\n            $scope.onUploadClicked = () => {\n                $scope.$$postDigest(() => {\n                    angular.element(document.getElementById('uploadImageBtn'))[0].click();\n                })\n            };\n\n            $scope.onUploaded = (inputElement) => {\n                toastService.simpleToast($translate.instant('UPLOADING_IMAGE'));\n                // Resize\n                canvasResize(inputElement.files[0], {\n                    quality: 75,\n                    isPreprocessing: true,\n                    cardType: '',\n                    maxW: 2048,\n                    maxH: 2008,\n                    isiOS: ptUtils.isMobile.iOS(),\n                    callback: function (data, width, height) {\n                        $scope.$evalAsync(() => {\n                            $scope.tmpUlpoadedImg = data;\n                            $scope.newProductModel.ProductImage_Image1 = data.split(',')[1];\n                            toastService.simpleToast($translate.instant('IMAGE_UPLOADED'));\n                        })\n                    }\n                });\n            };\n\n            $scope.validator = () => {\n                let valid = true;\n                let errMsg = '';\n                if (!$scope.newProductModel.Product_Title) {\n                    valid = false;\n                    // Please select title\n                    if (!errMsg) errMsg = $translate.instant('PRODUCT_INVALID_TITLE');\n                }\n\n                if (!$scope.newProductModel.Product_Description) {\n                    valid = false;\n                    // Please select description\n                    if (!errMsg)\n                        errMsg = $translate.instant('PRODUCT_INVALID_DESCRIPTION');\n                }\n\n                if ($scope.newProductModel.Product_Latitude &&\n                    $scope.newProductModel.Product_Longitude ||\n                    ($scope.isUseUserAddress.value && $scope.userAddress && $scope.userAddress.lat && $scope.userAddress.lng)) {\n\n                } else {\n                    valid = false;\n                    // Please select address\n                    if (!errMsg)\n                        errMsg = $translate.instant('PRODUCT_INVALID_ADDRESS');\n                }\n\n                if (!$scope.newProductModel.ProductImage_Image1) {\n                    valid = false;\n                    // Please upload image\n                    if (!errMsg)\n                        errMsg = $translate.instant('PRODUCT_INVALID_IMAGE');\n                }\n\n                if (!$scope.newProductModel.Product_ItemCategory_Id) {\n                    valid = false;\n                    // Please select category\n                    if (!errMsg)\n                        errMsg = $translate.instant('PRODUCT_INVALID_CATEGORY');\n                }\n\n                if (!$scope.newProductModel.Product_Price_Perday) {\n                    valid = false;\n                    // Please select price per day\n                    if (!errMsg)\n                        errMsg = $translate.instant('PRODUCT_INVALID_PRICE_PER_DAY');\n                }\n\n                if ($scope.newProductModel.Product_TryAndBuy && !$scope.newProductModel.Product_ShopURL) {\n                    valid = false;\n                    // Try and buy must have url\n                    if (!errMsg)\n                       errMsg = $translate.instant('PRODUCT_INVALID_TRY_AND_BUY_URL');\n                }\n                if (!valid)\n                    toastService.simpleToast(errMsg);\n                return valid\n            };\n\n            $scope.onCategorySelected = (categoryId) => {\n                $scope.subCategories = [];\n                $scope.newProductModel.Product_SubCategoryId = 0;\n                if ($scope.categories) {\n                    const selectedCategory = $scope.categories.find((cat) => cat.Category_Id == categoryId);\n                    if (selectedCategory && selectedCategory.Category_SubCatrgories && selectedCategory.Category_SubCatrgories.length > 0) {\n                        $scope.subCategories = selectedCategory.Category_SubCatrgories;\n                    } else {\n                        $scope.subCategories = [];\n                    }\n                }\n            };\n\n            $scope.addProduct = () => {\n                if (!$scope.validator())\n                    return;\n                $scope.isLoading = true;\n                let newProduct = angular.copy($scope.newProductModel);\n                if ($scope.isUseUserAddress.value) {\n                    delete newProduct.Product_LocationId;\n                    newProduct.Product_Latitude = $scope.userAddress.lat;\n                    newProduct.Product_Longitude = $scope.userAddress.lng;\n                }\n                $rootScope.$emit(enums.busEvents.scrollMainScrollerToTop);\n                apiService.products.addProduct(newProduct)\n                    .then((response) => {\n                        gtmService.trackEvent('add-product', 'new-product-added');\n                        apiService.products.getUserProducts({\n                            userId: appStateManager.getUserId(),\n                            productsFilter: enums.userProductsFilter.myProductsToBorrow\n                        })\n                            .then((res) => {\n                                $scope.isLoading = false;\n                                if (res && res.Data && res.Data.User_AllProducts && res.Data.User_AllProducts.length > 0) {\n                                    const newProduct = res.Data.User_AllProducts[res.Data.User_AllProducts.length-1];\n                                    $rootScope.$emit(enums.busNavigation.productDetailed,{product: newProduct});\n                                }\n                                console.log(res)\n                            })\n                            .catch((err) => {\n                                $scope.isLoading = false;\n                                console.error(err)\n                            })\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        // toastService.simpleToast(JSON.stringify(err));\n                    })\n            };\n\n            const formValuesInit = () => {\n                if (appStateManager.user && appStateManager.user.User_Address && appStateManager.user.User_Latitude && appStateManager.user.User_Longitude && !$scope.userAddress) {\n                    $scope.userAddress = {\n                        address: appStateManager.user.User_Address,\n                        lat: appStateManager.user.User_Latitude,\n                        lng: appStateManager.user.User_Longitude,\n                    }\n                }\n                if (appStateManager.categoriesDict && !$scope.categories) {\n                    let tnBCategories = [];\n                    let i = 0;\n                    Object.values(appStateManager.categoriesDict)\n                        .forEach((category) => {\n                            if (!category.IsTryAndBuy) \n                                 tnBCategories[i++] = category;\n                        });\n                    $scope.categories = tnBCategories;\n                    }\n            };\n\n\n            formValuesInit();\n            $scope.isLoading = false;\n\n            let deregs = [];\n            deregs.push($rootScope.$on(enums.busEvents.categoriesUpdate,() => {\n                formValuesInit();\n            }));\n\n            deregs.push($rootScope.$on(enums.busEvents.updatedUser,() => {\n                formValuesInit();\n            }));\n\n            deregs.push($rootScope.$on(enums.busEvents.googlePlacesAutocompletePlaceChanged,(event,data) => {\n                if (data.elementId == 'newProductAddress') {\n                    let { place } = data, { geometry } = place;\n\n                    $scope.newProductModel.Product_Latitude = geometry.location.lat();\n                    $scope.newProductModel.Product_Longitude = geometry.location.lng();\n                    $scope.newProductModel.Product_LocationId = place.id;\n                }\n            }));\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()();\n            })\n\n        }]);\nangular.module('paladinApp')\n    .controller('myListingsController',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        '$mdMedia',\n        function (\n            $rootScope,\n            $scope,\n            enums,\n            appStateManager,\n            apiService,\n            $mdMedia) {\n            $scope.isLoading = false;\n            $scope.userId = appStateManager.getUserId();\n            $scope.addNewItem = () => {\n                $rootScope.$emit(enums.busNavigation.newProduct);\n            };\n\n\n            $scope.isGtMd = $mdMedia('gt-md');\n\n            let deregs = [];\n\n            deregs.push(\n                $scope.$watch(function () {return $mdMedia('gt-md') },function (mgMd) {\n                    $scope.isGtMd = mgMd;\n                })\n            );\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()()\n            })\n\n        }\n    ]);\nangular.module('paladinApp')\n    .controller('productReviewController', [\n        '$scope',\n        '$state',\n        '$location',\n        '$rootScope',\n        'appStateManager',\n        'apiService',\n        'productReviewService',\n        'toastService',\n        '$translate',\n        function (\n            $scope,\n            $state,\n            $location,\n            $rootScope,\n            appStateManager,\n            apiService,\n            productReviewService,\n            toastService,\n            $translate\n        ) {\n            let self = this;\n            // normally done through \"controllerAs: 'vm'\" property but didn't want to\n            // break the code style outside this file;\n            // there's a lot to gain from proper namespacing...\n            let vm = {};\n\n            vm.review = {\n                text: null,\n                rating: null\n            };\n\n            vm.booking = productReviewService.getBookingToReview();\n\n            vm.isLoading = false;\n            vm.onRating = (rating) => {\n                vm.review.rating = rating;\n            }\n            vm.submitReview = (transactionId = null) => {\n                // validate\n                if (!vm.booking) {\n                    \n                    console.error('Invalid booking: ', vm.booking)\n                    return;\n                } else if (vm.review.stars === undefined) {\n                    toastService.simpleToast($translate.instant('REVIEW_VALIDATION_NO_STARS')); \n                    return;\n                } else if (vm.review.text === null ) {\n                    toastService.simpleToast($translate.instant('REVIEW_VALIDATION_NO_COMMENT'));\n                    return;\n                }\n\n                // keep transactionId out of prereqData in case this controller\n                // needs to be reused in other context\n                let params = {\n                    Review_Precnt: vm.review.stars * 2,\n                    Review_ProductId: vm.booking.Product_Id,\n                    Review_UserId: vm.booking.Borrower_Id,\n                    LanguageCode: appStateManager.getCurrentLang(),\n                    ReviewDetail_Comment: vm.review.text || '',\n                    Review_BookingId: vm.booking.Booking_Id\n                };\n\n                apiService.reviews.submitTransactionReview(params)\n                    .then((result) => {\n                            console.log('submit review result ', result)\n                            // show a toast message\n                            toastService.simpleToast($translate.instant('REVIEW_ADDED_SUCCESS'));\n                        \n                        },\n                        (err) => {\n                            toastService.simpleToast($translate.instant('REVIEW_ADDED_FAILED'));\n                        \n                            console.error(err);\n                        });\n\n\n                $scope.vm.closeProductReview();\n            };\n\n            vm.closeProductReview = () => {\n                // done through service to make it easily accessible\n                productReviewService.leaveProductReviewPage();\n            };\n\n            // booking already has a rating\n            // only the borrower ca review the product\n/*\n            if (vm.booking.Booking_ReviewStatus\n                || vm.booking.Borrower_Id !== appStateManager.getUserId()) {\n                // maybe display a toast message or some other error handling here\n                vm.closeProductReview();\n            }\n\n*/\n            /** it's always a good idea to namespace properties in $scope */\n            $scope.vm = vm;\n        }\n    ]);\n\n'use strict';\n\nconst mockDummyData = {\n    \"Status\": \"success\",\n    \"Data\": {\n        \"User_Booking_Borrower\": [\n            {\n                \"Product_Id\": 11425,\n                \"Booking_Id\": 736,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11608,\n                \"Lender_Name\": \"Marc Ferrer\",\n                \"Lender_StripeAccount\": \"acct_1AJTHYAN9BUpHCOJ\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/26/2018\",\n                \"EndDate\": \"4/27/2018\",\n                \"FullStartDate\": \"2018-04-26T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-27T00:00:00Z\",\n                \"Lender_Image\": \"qSzR0g6M0HFiwOZaTm42D5a4stKjQj\",\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 2,\n                \"Product_Title\": \"retina screen\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"lFYnTHaa7yI4kboCpsrT5a4stKjQj\",\n                \"Product_PricePerDay\": \"5\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 10,\n                \"Discount\": 0,\n                \"AmountCharge\": 10,\n                \"Status\": \"timeout\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"05:46\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"05:46\"\n                    },\n                    {\n                        \"StatusName\": \"timeout\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 4,\n                        \"CreatedTime\": \"06:00\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11510,\n                \"Booking_Id\": 730,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11624,\n                \"Lender_Name\": \"Muhammad Ali\",\n                \"Lender_StripeAccount\": \"acct_1CCQcZLXqrrI6AjN\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/21/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-21T00:00:00Z\",\n                \"Lender_Image\": \"yTj58mdeStrfU5QoJBmtD5a4stKjQj\",\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 3,\n                \"Product_Title\": \"Plastic bottle\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"Iti4Fsg9gJl2db5XWKAseD5a4stKjQj\",\n                \"Product_PricePerDay\": \"14\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 7,\n                \"Discount\": 0,\n                \"AmountCharge\": 7,\n                \"Status\": \"timeout\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"20:16\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"20:16\"\n                    },\n                    {\n                        \"StatusName\": \"timeout\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 4,\n                        \"CreatedTime\": \"20:30\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11535,\n                \"Booking_Id\": 689,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11735,\n                \"Lender_Name\": \"milalou4\",\n                \"Lender_StripeAccount\": \"\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/20/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-20T00:00:00Z\",\n                \"Lender_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 2,\n                \"Product_Title\": \"tennis sport\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"3rQf5vmj3KTZmJ2y5Notj5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 6,\n                \"Discount\": 0,\n                \"AmountCharge\": 6,\n                \"Status\": \"timeout\",\n                \"Booking_ReadId\": 3,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"14:25\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"14:25\"\n                    },\n                    {\n                        \"StatusName\": \"timeout\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 4,\n                        \"CreatedTime\": \"14:40\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11545,\n                \"Booking_Id\": 688,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11746,\n                \"Lender_Name\": \"milalou3\",\n                \"Lender_StripeAccount\": \"acct_1CDbR1BB9Tg1dJD4\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/20/2018\",\n                \"EndDate\": \"4/20/2018\",\n                \"FullStartDate\": \"2018-04-20T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-20T00:00:00Z\",\n                \"Lender_Image\": null,\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 1,\n                \"Product_Title\": \"little mu\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"dQgiMmnnpqeikt2ASslLj5a4stKjQj\",\n                \"Product_PricePerDay\": \"5\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 5,\n                \"Discount\": 0,\n                \"AmountCharge\": 5,\n                \"Status\": \"card_not_verified_timeout\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"14:18\"\n                    },\n                    {\n                        \"StatusName\": \"notverified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 2,\n                        \"CreatedTime\": \"14:18\"\n                    },\n                    {\n                        \"StatusName\": \"card_not_verified_timeout\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 13,\n                        \"CreatedTime\": \"18:35\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11535,\n                \"Booking_Id\": 556,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11735,\n                \"Lender_Name\": \"milalou4\",\n                \"Lender_StripeAccount\": \"\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/26/2018\",\n                \"EndDate\": \"4/28/2018\",\n                \"FullStartDate\": \"2018-04-26T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-28T00:00:00Z\",\n                \"Lender_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 3,\n                \"Product_Title\": \"tennis sport\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"3rQf5vmj3KTZmJ2y5Notj5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 9,\n                \"Discount\": 0,\n                \"AmountCharge\": 9,\n                \"Status\": \"started\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"20:15\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"20:15\"\n                    },\n                    {\n                        \"StatusName\": \"accepted\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 7,\n                        \"CreatedTime\": \"20:16\"\n                    },\n                    {\n                        \"StatusName\": \"started\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 8,\n                        \"CreatedTime\": \"21:13\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11537,\n                \"Booking_Id\": 526,\n                \"Borrower_Id\": 11736,\n                \"Borrower_Name\": \"milalou2 milalou2-last\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11737,\n                \"Lender_Name\": \"milalou5\",\n                \"Lender_StripeAccount\": \"acct_1CClL3HkZgZyGSpV\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": true,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/21/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-21T00:00:00Z\",\n                \"Lender_Image\": null,\n                \"Borrower_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 3,\n                \"Product_Title\": \"sock\",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"GCdCsbMYjJAIQ3CnJQ93Mj5a4stKjQj\",\n                \"Product_PricePerDay\": \"7\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 21,\n                \"Discount\": 0,\n                \"AmountCharge\": 21,\n                \"Status\": \"ended\",\n                \"Booking_ReadId\": 3,\n                \"Delivery_Latitude\": \"\",\n                \"Delivery_Longitude\": \"\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"08:38\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"08:38\"\n                    },\n                    {\n                        \"StatusName\": \"accepted\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 7,\n                        \"CreatedTime\": \"08:46\"\n                    },\n                    {\n                        \"StatusName\": \"started\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 8,\n                        \"CreatedTime\": \"08:47\"\n                    },\n                    {\n                        \"StatusName\": \"ended\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 9,\n                        \"CreatedTime\": \"08:48\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            }\n        ],\n        \"User_Booking_Lender\": [\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 756,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/20/2018\",\n                \"EndDate\": \"4/20/2018\",\n                \"FullStartDate\": \"2018-04-20T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-20T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 1,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 3,\n                \"Discount\": 0,\n                \"AmountCharge\": 3,\n                \"Status\": \"timeout\",\n                \"Booking_ReadId\": 3,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"10:28\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"10:28\"\n                    },\n                    {\n                        \"StatusName\": \"timeout\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 4,\n                        \"CreatedTime\": \"10:40\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 755,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/22/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-22T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 4,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 12,\n                \"Discount\": 0,\n                \"AmountCharge\": 12,\n                \"Status\": \"cancelled\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"10:26\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"10:26\"\n                    },\n                    {\n                        \"StatusName\": \"cancelled\",\n                        \"CreatedDate\": \"10/04/2018\",\n                        \"Status_TrackId\": 6,\n                        \"CreatedTime\": \"10:26\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 735,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/26/2018\",\n                \"EndDate\": \"4/26/2018\",\n                \"FullStartDate\": \"2018-04-26T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-26T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 1,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 3,\n                \"Discount\": 0,\n                \"AmountCharge\": 3,\n                \"Status\": \"accepted\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"21:44\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"21:44\"\n                    },\n                    {\n                        \"StatusName\": \"accepted\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 7,\n                        \"CreatedTime\": \"21:44\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 734,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/21/2018\",\n                \"EndDate\": \"4/22/2018\",\n                \"FullStartDate\": \"2018-04-21T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-22T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 2,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 6,\n                \"Discount\": 0,\n                \"AmountCharge\": 6,\n                \"Status\": \"cancelled\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"20:58\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"20:58\"\n                    },\n                    {\n                        \"StatusName\": \"cancelled\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 6,\n                        \"CreatedTime\": \"20:59\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 733,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/21/2018\",\n                \"EndDate\": \"4/22/2018\",\n                \"FullStartDate\": \"2018-04-21T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-22T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 2,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 6,\n                \"Discount\": 0,\n                \"AmountCharge\": 6,\n                \"Status\": \"cancelled\",\n                \"Booking_ReadId\": 3,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"20:56\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"20:56\"\n                    },\n                    {\n                        \"StatusName\": \"cancelled\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 6,\n                        \"CreatedTime\": \"20:58\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 732,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": true,\n                \"StartDate\": \"4/11/2018\",\n                \"EndDate\": \"4/11/2018\",\n                \"FullStartDate\": \"2018-04-11T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-11T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 1,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 3,\n                \"Discount\": 0,\n                \"AmountCharge\": 3,\n                \"Status\": \"ended\",\n                \"Booking_ReadId\": 1,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"20:47\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"20:47\"\n                    },\n                    {\n                        \"StatusName\": \"accepted\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 7,\n                        \"CreatedTime\": \"20:47\"\n                    },\n                    {\n                        \"StatusName\": \"started\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 8,\n                        \"CreatedTime\": \"20:55\"\n                    },\n                    {\n                        \"StatusName\": \"ended\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 9,\n                        \"CreatedTime\": \"20:55\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11532,\n                \"Booking_Id\": 668,\n                \"Borrower_Id\": 11737,\n                \"Borrower_Name\": \"milalou5\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/21/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-21T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": null,\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 3,\n                \"Product_Title\": \"napkins \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"o8R3Gnu6yT2mVGdKix4Iz5a4stKjQj\",\n                \"Product_PricePerDay\": \"6\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 3,\n                \"Discount\": 0,\n                \"AmountCharge\": 3,\n                \"Status\": \"card_not_verified_timeout\",\n                \"Booking_ReadId\": 1,\n                \"Delivery_Latitude\": \"52.4746643\",\n                \"Delivery_Longitude\": \"13.4244634\",\n                \"Delivery_Address\": \"Weisestrae 26\",\n                \"Booking_PickupProduct\": false,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"08:09\"\n                    },\n                    {\n                        \"StatusName\": \"notverified\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 2,\n                        \"CreatedTime\": \"08:09\"\n                    },\n                    {\n                        \"StatusName\": \"card_not_verified_timeout\",\n                        \"CreatedDate\": \"09/04/2018\",\n                        \"Status_TrackId\": 13,\n                        \"CreatedTime\": \"18:35\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 555,\n                \"Borrower_Id\": 11737,\n                \"Borrower_Name\": \"milalou5\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": true,\n                \"StartDate\": \"4/19/2018\",\n                \"EndDate\": \"4/21/2018\",\n                \"FullStartDate\": \"2018-04-19T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-21T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": null,\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 3,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 9,\n                \"Discount\": 0,\n                \"AmountCharge\": 9,\n                \"Status\": \"ended\",\n                \"Booking_ReadId\": 2,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"18:25\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"18:25\"\n                    },\n                    {\n                        \"StatusName\": \"accepted\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 7,\n                        \"CreatedTime\": \"18:26\"\n                    },\n                    {\n                        \"StatusName\": \"started\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 8,\n                        \"CreatedTime\": \"18:28\"\n                    },\n                    {\n                        \"StatusName\": \"ended\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 9,\n                        \"CreatedTime\": \"18:29\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            },\n            {\n                \"Product_Id\": 11533,\n                \"Booking_Id\": 525,\n                \"Borrower_Id\": 11735,\n                \"Borrower_Name\": \"milalou4\",\n                \"Borrower_ReviewScore\": 0,\n                \"Borrower_ReviewCount\": 0,\n                \"Borrower_QBId\": null,\n                \"Lender_Id\": 11736,\n                \"Lender_Name\": \"milalou2 milalou2-last\",\n                \"Lender_StripeAccount\": \"acct_1CCujsKRD1g5AQ99\",\n                \"Lender_ReviewScore\": 0,\n                \"Lender_ReviewCount\": 0,\n                \"Lender_QBId\": null,\n                \"Booking_PaidToLender\": false,\n                \"StartDate\": \"4/3/2018\",\n                \"EndDate\": \"4/3/2018\",\n                \"FullStartDate\": \"2018-04-03T00:00:00Z\",\n                \"FullEndDate\": \"2018-04-03T00:00:00Z\",\n                \"Lender_Image\": \"JoyyjhIuu7zFjvau4s6HT5a4stKjQj\",\n                \"Borrower_Image\": \"NXxMyDfZn2ZHu0dUvLJeT5a4stKjQj\",\n                \"Chat_Id\": 0,\n                \"NoOfdays\": 1,\n                \"Product_Title\": \"pen blue \",\n                \"Lender_BillingAddress\": null,\n                \"Product_Image\": \"ezPAZU9e8Z3LaNECKB8FQT5a4stKjQj\",\n                \"Product_PricePerDay\": \"3\",\n                \"BorrowerCusotmerId\": \"\",\n                \"RentAmount\": 3,\n                \"Discount\": 0,\n                \"AmountCharge\": 3,\n                \"Status\": \"timeout\",\n                \"Booking_ReadId\": 3,\n                \"Delivery_Latitude\": \"0\",\n                \"Delivery_Longitude\": \"0\",\n                \"Delivery_Address\": \"\",\n                \"Booking_PickupProduct\": true,\n                \"BookingStatus\": [\n                    {\n                        \"StatusName\": \"requested\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 1,\n                        \"CreatedTime\": \"08:09\"\n                    },\n                    {\n                        \"StatusName\": \"verified\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 3,\n                        \"CreatedTime\": \"08:09\"\n                    },\n                    {\n                        \"StatusName\": \"timeout\",\n                        \"CreatedDate\": \"03/04/2018\",\n                        \"Status_TrackId\": 4,\n                        \"CreatedTime\": \"08:15\"\n                    }\n                ],\n                \"Booking_ReviewStatus\": null,\n                \"DeliveryAndPickupDetail\": null\n            }\n        ],\n        \"User_ReviewScore\": [\n            {\n                \"User_ReviewScore\": 8,\n                \"User_TotalReviews\": 1,\n                \"User_ReviewAsLender\": 8,\n                \"User_ReviewAsBorrower\": 7,\n                \"User_ReviewCountAsLender\": 1,\n                \"User_ReviewCountAsBorrower\": 1\n            }\n        ]\n    },\n    \"Message\": \"User Bookings\"\n};\n\nangular.module('paladinApp')\n    .controller('userBookingsController',[\n        '$rootScope',\n        '$scope',\n        'apiService',\n        'enums',\n        'appStateManager',\n        'ptLog',\n        '$mdMedia',\n        'ptUtils',\n        'moment',\n        function ($rootScope,\n                  $scope,\n                  apiService,\n                  enums,\n                  appStateManager,\n                  ptLog,\n                  $mdMedia,\n                  ptUtils,\n                  moment) {\n            $scope.isLoading = false;\n\n            $scope.tabs = [\n                {\n                    title: 'BORROWED',\n                    content: 'I am tab borrowed content',\n                    bookings: []\n                },\n                {\n                    title: 'LENT',\n                    content: 'I am tab lent content',\n                    bookings: []\n                }\n            ];\n\n            $scope.fetchUserBookings = () => {\n                $scope.isLoading = true;\n                apiService.bookings.getUserBookings(appStateManager.getUserId())\n                    .then((res) => {\n                        $scope.tabs[0].bookings = res.Data.User_Booking_Borrower\n                            .map((item) => {\n                                item.lastModified = new Date(item.Last_Modified * 1000);\n                                return item\n                            })\n                            .sort(ptUtils.sorters.bookingLastModifiedEpoch);\n\n                        $scope.tabs[1].bookings = res.Data.User_Booking_Lender\n                            .map((item) => {\n                                item.lastModified = new Date(item.Last_Modified * 1000);\n                                return item\n                            })\n                            .sort(ptUtils.sorters.bookingLastModifiedEpoch);\n                            $scope.isLoading = false;\n\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        ptLog.error(err);\n                    })\n            };\n\n            $scope.fetchUserBookings();\n\n            $scope.bookingListItemClick = (booking) => {\n                $rootScope.$emit(enums.busNavigation.transactionDetailed,{bookingId: booking.Booking_Id})\n            };\n\n            $scope.addNewItem = () => {\n                $rootScope.$emit(enums.busNavigation.newProduct);\n            };\n\n            $scope.isGtMd = $mdMedia('gt-md');\n\n            let deregs = [];\n\n            deregs.push(\n                $scope.$watch(function () {return $mdMedia('gt-md') },function (mgMd) {\n                    $scope.isGtMd = mgMd;\n                })\n            );\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()()\n            })\n        }\n    ]);\n'use strict';\nangular.module('paladinApp')\n    .controller('bookingDetailedController',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'appStateManager',\n        'apiService',\n        '$stateParams',\n        'ptLog',\n        'popupService',\n        'ptUtils',\n        '$sce',\n        function ($rootScope,\n                  $scope,\n                  enums,\n                  appStateManager,\n                  apiService,\n                  $stateParams,\n                  ptLog,\n                  popupService,\n                  ptUtils,\n                  $sce) {\n            $scope.isLoading = false;\n            $scope.bookingId = $stateParams.bookingId;\n            $scope.booking = null;\n            $scope.address = {\n                title: undefined,\n                address: undefined,\n                lat: undefined,\n                lng: undefined\n            };\n            $scope.fetchDetailedBooking = () => {\n                $scope.isLoading = true;\n                apiService.bookings.getBookingDetailed({\n                    bookingId: $scope.bookingId,\n                    userId: appStateManager.getUserId(),\n                })\n                    .then((res) => {\n                        $scope.booking = res.Data;\n                        $scope.booking.Product_Description = $sce.trustAsHtml($scope.booking.Product_Description);\n                        $scope.fetchProduct();\n                    })\n                    .catch((err) => {\n                        ptLog.error(JSON.stringify(err))\n                    })\n            };\n\n\n            $scope.fetchProduct = () => {\n                apiService.products.getDetailedProduct($scope.booking.Product_Id)\n                    .then((res) => {\n                        $scope.product = res.Data;\n                        $scope.fetchProductBookingDetails();\n                    })\n                    .catch((err) => {\n                        ptLog.error(JSON.stringify(err))\n                    })\n            };\n\n            $scope.fetchProductBookingDetails = () => {\n                apiService.products.getProductBookingDetails({\n                    productId: $scope.product.Product_Id,\n                    userId: appStateManager.getUserId()\n                })\n                    .then((response) => {\n                        $scope.productBookingDetails = response.Data;\n\n                        ptUtils.getAddressToDisplayForBooking({\n                            product: $scope.product,\n                            productBookingDetails: $scope.productBookingDetails,\n                            booking: $scope.booking,\n\n                        })\n                            .then((address) => {\n                                $scope.$evalAsync(() => {\n                                    $scope.address = address;\n                                    $scope.isLoading = false;\n                                    if (ptUtils.isMobile.any()) {\n                                        popupService.showBookingTrackerInfoMobilePopup($scope.booking)\n                                    }\n                                })\n                            })\n                            .catch((err) => {\n                                $scope.$evalAsync(() => {\n                                    $scope.isLoading = false;\n                                })\n                            });\n                    })\n                    .catch((err) => {\n                        ptLog.error(err);\n                    })\n            };\n\n            $scope.goToProduct = () => {\n                  $rootScope.$emit(enums.busNavigation.productDetailed,{product:$scope.booking})\n            };\n\n            $scope.fetchDetailedBooking();\n\n            let deregs = [];\n\n            deregs.push($rootScope.$on(enums.busEvents.reloadDetailedBooking,(event,{ bookingId }) => {\n                    if (bookingId == $scope.bookingId) {\n                        $scope.fetchDetailedBooking();\n                    }\n            }));\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()();\n            })\n\n        }]);\n'use strict';\nangular.module('paladinApp')\n    .controller('paymentDetailedController', [\n        '$rootScope',\n        '$scope',\n        'apiService',\n        'appStateManager',\n        'enums',\n        '$stateParams',\n        'popupService',\n        'toastService',\n        '$sce',\n        'stripeService',\n        'creditcards',\n        'menusService',\n        'ptUtils',\n        'moment',\n        'geoLocationService',\n        'ptLog',\n        '$translate',\n        'gtmService',\n        function ($rootScope,\n                  $scope,\n                  apiService,\n                  appStateManager,\n                  enums,\n                  $stateParams,\n                  popupService,\n                  toastService,\n                  $sce,\n                  stripeService,\n                  creditcards,\n                  menusService,\n                  ptUtils,\n                  moment,\n                  geoLocationService,\n                  ptLog,\n                  $translate,\n                  gtmService) {\n            $scope.isLoading = true;\n            $scope.isHaveSavedCC = false;\n            $scope.isTryAndBuy = false;\n            $scope.isNewCardLayoutOpen = false;\n            $scope.isBuy = false;\n            \n            if ($stateParams.startDate && $stateParams.startDate && $stateParams.productId) {\n                $scope.rentStartDate = $stateParams.startDate;\n                $scope.rentEndDate = $stateParams.endDate;        \n                $scope.productId = $stateParams.productId;        \n            } else if ($stateParams.productId && ($stateParams.purchase || $stateParams.bookingId)) {\n                $scope.isBuy = $stateParams.purchase;\n                $scope.bookingId = $stateParams.bookingId;\n                $scope.productId = $stateParams.productId;        \n            } else {\n                popupService.showAlert('Ops', $translate.instant('INVALID_PAGE'))\n                    .finally(() => {\n                        $rootScope.$emit(enums.busNavigation.homePage)\n                    });\n                return\n            }\n\n            $scope.prices = [];\n            $scope.userSavedCard = null;\n            $scope.coupon = null;\n            $scope.statusError = null;\n\n            // New Card model\n            $scope.ccModel = {\n                number: '',\n                type: '',\n                expiration: '',\n                exp_month: '',\n                exp_year: '',\n                cvc: '',\n                name: '',\n                isTermsAndConditionsAccepted: false,\n                isSaveCardForFutureTransactions: true,\n                isDelivery: true,\n                deliveryAddress: '',\n                deliveryName: '',\n                deliveryPhone: '',\n                deliveryBell: '',\n            };\n            // New CC submit form\n            $scope.forms = {};\n\n\n            $scope.ccIcon = {\n                'MasterCard': 'fa-cc-mastercard',\n                'Visa': 'fa-cc-visa',\n                'American Express': 'fa-cc-amex',\n                'Discover': 'fa-cc-discover',\n                undefined: 'fa-credit-card',\n                'Unknown': 'fa-credit-card',\n                'Maestro': 'fa-credit-card',\n                'JCB': 'fa-cc-jcb',\n                'Diners': 'fa-cc-diners',\n                'Diners Club': 'fa-cc-diners-club',\n            };\n\n            $scope.fetchProduct = () => {\n                $scope.isLoading = true;\n                apiService.products.getDetailedProduct($scope.productId)\n                    .then((response) => {\n                        $scope.product = response.Data;\n                        $scope.product.Product_Description = $sce.trustAsHtml($scope.product.Product_Description);\n\n                        ptUtils.extractAndGeoLocateAddressFromObjectForFieldNames({\n                            object: $scope.product,\n                            addressFieldName: 'Lender_User_Address',\n                            latFieldName: 'Product_Latitude',\n                            lngFieldName: 'Product_Longitude'\n                        })\n                            .then((address) => {\n                                $scope.product.Lender_User_Address = address;\n                            });\n\n                        $scope.isTryAndBuy = ptUtils.isProductTryAndBuy($scope.product);\n\n                        $scope.fetchBookingDetails();\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        toastService.simpleToast(JSON.stringify(err));\n                        ptLog.error(JSON.stringify(err))\n                    })\n            };\n\n            $scope.fetchBookingDetails = () => {\n                apiService.products.getProductBookingDetails({\n                    productId: $scope.product.Product_Id,\n                    userId: appStateManager.getUserId(),\n                })\n                    .then((response) => {\n                        $scope.productBookingDetails = response.Data;\n                        $scope.calculatePrices();\n                        const {\n                            UserCustomerDetail\n                        } = $scope.productBookingDetails;\n\n                        let {\n                            User_CustomerId\n                        } = UserCustomerDetail;\n\n                        // User Has saved credit card, fetch and fill info\n                        if (User_CustomerId) {\n                            $scope.fetchStripeUserCard(User_CustomerId)\n                        } else {\n                            $scope.isLoading = false;\n                        }\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        console.error(err)\n                    })\n            };\n\n            $scope.fetchProduct();\n\n\n            $scope.toggleNewCardLayout = () => {\n                $scope.isNewCardLayoutOpen = !$scope.isNewCardLayoutOpen;\n                $scope.userSavedCard = null;\n                $scope.isHaveSavedCC = false;\n            };\n\n            $scope.gotoTermsAndConditions = () => {\n                const url = menusService.commonMenus.linksMenu.list[1].link;\n                const win = window.open(url, '_blank');\n                win.focus();\n            };\n\n            $scope.fetchStripeUserCard = (customerId) => {\n                stripeService.getCustomerSources(customerId)\n                    .then((response) => {\n                        if (response.status === 200 && response.data != null) {\n                            const {data, object} = response.data;\n                            if (object == 'list' && data && data.length > 0) {\n                                const card = data.find((sourceItem) => sourceItem.object == 'card');\n\n                                if (card) {\n                                    $scope.userSavedCard = card;\n                                    $scope.isHaveSavedCC = true;\n                                }\n                            }\n                        }\n                        $scope.isLoading = false;\n                    })\n                    .catch((err) => {\n                        $scope.isLoading = false;\n                        console.error(err)\n                    })\n            };\n\n            $scope.calculatePrices = () => {\n\n                $scope.prices = [];\n                $scope.statusError = undefined;\n                $scope.userCredit = null;\n\n                let calculateTransactionPrice = () => {\n\n                    const {\n                        product,\n                        productBookingDetails,\n                        rentStartDate,\n                        rentEndDate,\n                        userCredit,\n                        coupon,\n                        ccModel\n                    } = $scope;\n\n                    ptUtils.calculatePricingListForProduct(\n                        rentStartDate,\n                        rentEndDate,\n                        product,\n                        productBookingDetails,\n                        ccModel.isDelivery,\n                        userCredit,\n                        coupon,\n                        $scope.isBuy\n                    )\n                        .then((prices) => {\n                            $scope.$evalAsync(() => {\n                                $scope.prices = prices\n                            })\n                        })\n                        .catch((err) => {\n                            $scope.$evalAsync(() => {\n                                if (err && err.message)\n                                    $scope.statusError = err.message\n                            })\n                        })\n                };\n\n                let userId = appStateManager.getUserId();\n\n                apiService.users.getUserCredit({userId})\n                    .then((result) => {\n                        $scope.userCredit = result.Data;\n                        calculateTransactionPrice();\n                    })\n                    .catch((err) => {\n                        console.error('getuserCredit failed ', err)\n                    });\n            };\n\n            $scope.onDatesSelected = ({startDate, endDate}) => {\n                $scope.rentStartDate = startDate;\n                $scope.rentEndDate = endDate;\n                $scope.calculatePrices();\n            };\n\n            $scope.couponValidated = (coupon) => {\n                $scope.coupon = coupon;\n                $scope.calculatePrices();\n            };\n            $scope.deleteCoupon = () => {\n                $scope.coupon = null;\n                $scope.calculatePrices();\n            };\n\n            $scope.isDeliveryStatusChange = () => {\n                $scope.calculatePrices();\n            };\n\n            $scope.bookingValidator = () => {\n                $scope.statusError = undefined;\n                const {ccModel, forms} = $scope;\n                const {ccForm} = forms;\n\n\n                const {isHaveSavedCC, userSavedCard, isNewCardLayoutOpen} = $scope;\n\n                let isValid = true;\n                let msg = '';\n\n                if (!ccModel.isTermsAndConditionsAccepted) {\n                    isValid = false;\n                    msg = 'NEED_TO_ACCEPT_TERMS_AND_CONDITIONS';\n                } else if (isHaveSavedCC && userSavedCard != undefined && !isNewCardLayoutOpen) {\n                    isValid = true;\n                } else if (ccForm.$invalid || !ccForm.$valid || !ccForm.$dirty) {\n                    isValid = false;\n                    msg = 'INVALID_CC_FORM'\n                }\n\n                if ($scope.isTryAndBuy && ccModel.isDelivery) {\n                    if (!ccModel.deliveryAddress || !ccModel.productLat || !ccModel.productLng) {\n                        isValid = false;\n                        msg = 'INVALID_DELIVERY_ADDRESS';\n                    } else if (!ccModel.deliveryName){\n                        isValid = false;\n                        msg = 'ADD_BILLING_NAME_MISSING';\n                    }else if (!ccModel.deliveryPhone){\n                        isValid = false;\n                        msg = 'ADD_PHONE_NUMBER_MISSING';\n                    }else if (!ccModel.deliveryBell){\n                        isValid = false;\n                        msg = 'ADD_RING_BELL_NAME_MISSING';\n                    }\n                }\n\n\n                if (!isValid && msg) {\n                    toastService.simpleToast($translate.instant(msg));\n                    $scope.statusError = msg;\n                }\n                return isValid;\n            };\n\n            $scope.bookNow = async () => {\n                let ccModel = angular.copy($scope.ccModel);\n                const {product, isHaveSavedCC, userSavedCard, productBookingDetails, isNewCardLayoutOpen} = $scope;\n                const {UserCustomerDetail} = productBookingDetails;\n                let {User_CustomerId} = UserCustomerDetail;\n                if ($scope.bookingValidator()) {\n\n                    popupService.showLoader();\n\n                    try {\n\n                        const {\n                            User_IsVerfied,\n                            User_Email\n                        } = appStateManager.user;\n                        //Check if its a new credit card or we already have it\n                        let customerData = null;\n                        if (!(User_CustomerId && isHaveSavedCC && userSavedCard && !isNewCardLayoutOpen)) {\n                            const cardData = await $scope.createNewCardToken();\n                            customerData = await $scope.createStripeCustomer(cardData.id, User_Email);\n                            console.log(customerData);\n                        } else {\n                            customerData = User_CustomerId;\n                        } \n\n                            // Charge Card!\n                        const chargeCardRes = await $scope.chargeCard(customerData, User_Email);\n\n                        if (chargeCardRes && chargeCardRes.Data) {\n                            //charge card successfull\n                            popupService.hideLoader();\n\n                            if (!$scope.isBuy) \n                                gtmService.trackEvent('booking', 'booking-request-submitted', chargeCardRes.Data.Booking_Id, chargeCardRes.Data.AmountCharge*0.78);\n                            else    \n                                gtmService.trackEvent('purchase', 'purchase-submitted');\n\n                            console.log(chargeCardRes);\n                            const bookingId = chargeCardRes.Data.Booking_Id;\n                            if ($scope.isBuy) {\n\n                                if ($scope.bookingId) {\n                                    $rootScope.$emit(enums.busNavigation.transactionDetailed, {\n                                        bookingId,\n                                        replace: true\n                                    });\n                                } else {\n                                    $rootScope.$emit(enums.busNavigation.productDetailed, {\n                                        product\n                                    \n                                    });\n                                }\n                                popupService.showAlert('PURCHASE_SUCCESSFUL_TITLE','PURCHASE_SUCCESSFUL')\n                                    .finally(() => {\n                                        if ($scope.bookingId)\n                                            $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true  });\n                                        else\n                                            $rootScope.$emit(enums.busNavigation.productDetailed,{ product: product });\n                                })\n\n                            } else if (User_IsVerfied || $scope.productBookingDetails.UserCustomerDetail.User_VerifyingStatus === 1)\n                                $rootScope.$emit(enums.busNavigation.transactionDetailed, {\n                                    bookingId,\n                                    replace: true\n                                });\n                            else {\n                                $rootScope.$emit(enums.busNavigation.idVerification, {bookingId, replace: true});\n                            }\n                        \n                        } else {\n                                popupService.hideLoader();\n                        }\n                        \n                    } catch (err) {\n                        let errMsg = null;\n                        if (err.data && err.data.error && err.data.error.code) {\n                            //stripe error code from token creation\n                            errMsg = $translate.instant(err.data.error.code);\n                        } else {\n                            errMsg = (err.data || {}).Message || err.message || 'DEFAULT_ERROR';\n                        }\n                        console.error(err);\n                        popupService.hideLoader();\n                        $scope.statusError = errMsg;\n                        toastService.simpleToast($translate.instant(errMsg));\n\n                    }\n                }\n            };\n\n            $scope.createNewCardToken = async () => {\n                const {number, exp_month, exp_year, cvc, name} = $scope.ccModel;\n                // create new token and customer for new card\n                const tokenRes = await stripeService.createToken({number, exp_month, exp_year, cvc, name});\n\n                if (tokenRes.data) {\n                    const {data} = tokenRes;\n                    const {id, card} = data;\n                    if (!$scope.isBuy && card && card.funding == 'credit' || $scope.isBuy && card) {\n                        return data;\n                    } else {\n                        // debit not supported\n                        throw new Error('DEBIT_CARD_NOT_SUPPORTED');\n                    }\n                } else {\n                    // response is empty\n                    throw new Error('CANT_CHARGE_CC');\n                }\n            };\n\n            $scope.createStripeCustomer = async (tokenId, email) => {\n                // create stripe customer\n                const stripeCustomer = await apiService.payments.createStripeCustomer({\n                    cardToken: tokenId,\n                    email: email,\n                });\n\n                if (stripeCustomer && stripeCustomer.Data) {\n                    console.log(JSON.stringify(stripeCustomer.Data));\n                    return stripeCustomer.Data;\n                } else {\n                    throw new Error('COULD_CREATE_STRIPE_CUSTOMER')\n                }\n\n            };\n\n\n            $scope.chargeCard = async (customerId, stripeEmail) => {\n                const {product, rentStartDate, rentEndDate, ccModel, coupon} = $scope;\n\n                if (!$scope.isBuy) {\n                    const rentalDays = ptUtils.getRentalPeriodInDays({\n                        startRentDate: rentStartDate,\n                        endRentDate: rentEndDate\n                    });\n\n                \n                    return await apiService.bookings.bookProduct({\n                    stripeEmail: stripeEmail,\n                    borrowerId: Number(appStateManager.getUserId()),\n                    lenderId: product.Lender_UserId,\n                    productId: product.Product_Id,\n                    startDate: moment(rentStartDate).format('MM/DD/YYYY'),\n                    endDate: moment(rentEndDate).format('MM/DD/YYYY'),\n                    stripeCustomerId: customerId,\n                    noOfDays: rentalDays,\n                    isSaveCard: ccModel.isSaveCardForFutureTransactions,\n                    isPickUp: !ccModel.isDelivery,\n                    deliveryAddress: ccModel.isDelivery ? ccModel.deliveryAddress : undefined,\n                    deliveryLat: ccModel.isDelivery ? ccModel.productLat : undefined,\n                    deliveryLng: ccModel.isDelivery ? ccModel.productLng : undefined,\n                    deliveryName: ccModel.isDelivery ? ccModel.deliveryName : undefined,\n                    deliveryPhone: ccModel.isDelivery ? ccModel.deliveryPhone : undefined,\n                    deliveryBell: ccModel.isDelivery ? ccModel.deliveryBell : undefined,\n                    coupon: coupon != undefined ? coupon.Coupon : undefined,\n                    idVerified: appStateManager.user.User_IsVerfied,\n                    isTryAndBuy: product.Product_TryAndBuy,\n                    });\n                }\n\n                else return await apiService.purchase.buyProduct({\n                    stripeEmail: stripeEmail,\n                    bookingId: $scope.bookingId || undefined,\n                    borrowerId: Number(appStateManager.getUserId()),\n                    purchaseAmount: product.Product_PurchasePrice + product.Product_Process_Fee,\n                    lenderId: product.Lender_UserId,\n                    productId: product.Product_Id,\n                    stripeCustomerId: customerId,\n                    isSaveCard: ccModel.isSaveCardForFutureTransactions,\n                    isPickUp: !ccModel.isDelivery,\n                    deliveryAddress: ccModel.isDelivery ? ccModel.deliveryAddress : undefined,\n                    deliveryLat: ccModel.isDelivery ? ccModel.productLat : undefined,\n                    deliveryLng: ccModel.isDelivery ? ccModel.productLng : undefined,\n                    deliveryName: ccModel.isDelivery ? ccModel.deliveryName : undefined,\n                    deliveryPhone: ccModel.isDelivery ? ccModel.deliveryPhone : undefined,\n                    deliveryBell: ccModel.isDelivery ? ccModel.deliveryBell : undefined,\n                });\n\n            };\n\n\n            let deregs = [];\n\n            deregs.push($rootScope.$on(enums.busEvents.googlePlacesAutocompletePlaceChanged, (event, data) => {\n                if (data.elementId == 'productDeliveryAddress') {\n                    let {place} = data, {geometry} = place;\n                    $scope.ccModel.productLat = geometry.location.lat();\n                    $scope.ccModel.productLng = geometry.location.lng();\n                    $scope.ccModel.productLocationId = place.id;\n                }\n            }));\n\n            const unsavedChanges = (e) => {\n                event.returnValue = 'are you sure?'\n            };\n\n\n            window.addEventListener('beforeunload', unsavedChanges);\n\n            $scope.$on('$destroy', () => {\n                while (deregs.length)\n                    deregs.pop()();\n                window.removeEventListener('beforeunload', unsavedChanges);\n            })\n\n        }]);\n\n\n'use strict';\nangular.module('paladinApp')\n    .controller('userVerificationController',[\n        '$rootScope',\n        '$scope',\n        'enums',\n        'apiService',\n        'appStateManager',\n        'toastService',\n        'uploadHandler',\n        '$timeout',\n        'ptUtils',\n        'acuantService',\n        'dataService',\n        '$stateParams',\n        'popupService',\n        '$base64',\n        '$translate',\n        'gtmService',\n        function (\n            $rootScope,\n            $scope,\n            enums,\n            apiService,\n            appStateManager,\n            toastService,\n            uploadHandler,\n            $timeout,\n            ptUtils,\n            acuantService,\n            dataService,\n            $stateParams,\n            popupService,\n            $base64,\n            $translate,\n            gtmService) {\n\n            if ($stateParams.bookingId) {\n                $scope.bookingId = $stateParams.bookingId\n            }\n            $scope.isLoading = false;\n            $scope.statusError = null;\n            $scope.selectedUploadMethod = enums.idVerificationMethod.passport;\n\n            $scope.uploadMethods = [\n                {\n                    title: 'UPLOAD_METHOD_PASS',\n                    value: enums.idVerificationMethod.passport,\n                },\n                {\n                    title: 'UPLOAD_METHOD_DL',\n                    value: enums.idVerificationMethod.driverLicense,\n                },\n                {\n                    title: 'UPLOAD_METHOD_NATIONAL_ID',\n                    value: enums.idVerificationMethod.id,\n                }\n            ];\n\n            $scope.uploadData = {};\n\n            let idVerificationMethodPassportTmpl =  [\n                {\n                    elementId: 'passportUpload',\n                    title: 'TAP_TO_UPLOAD_PASS',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:'Passport',\n                },\n                {\n                    elementId: 'idSelfie',\n                    title: 'TAKE_SELFIE',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:''\n                }\n            ];\n\n            let idVerificationMethodDriverLicenceTmpl = [\n                {\n                    elementId: 'driverLicenseFront',\n                    title: 'DL_FRONT',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:'DriversLicenseDuplex'\n                },\n                {\n                    elementId: 'driverLicenseBack',\n                    title: 'DL_BACK',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:'DriversLicenseDuplex'\n                },\n                {\n                    elementId: 'driverLicenseSelfie',\n                    title: 'TAKE_SELFIE',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:''\n                }\n            ];\n\n            let idVerificationMethodIdTmpl =  [\n                {\n                    elementId: 'idFront',\n                    title: 'NATIONAL_ID_FRONT',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:'DriversLicenseDuplex'\n                },\n                {\n                    elementId: 'idBack',\n                    title: 'NATIONAL_ID_BACK',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:'DriversLicenseDuplex'\n                },\n                {\n                    elementId: 'idSelfie',\n                    title: 'TAKE_SELFIE',\n                    imgData: null,\n                    isProcessingImg: false,\n                    cardType:''\n                }\n            ];\n\n            $scope.selectUploadMethod = (method) => {\n                $scope.selectedUploadMethod  = method;\n            };\n\n            $scope.clickToUpload = (elementId) => {\n                $scope.$$postDigest(() => {\n                    angular.element(document.getElementById(elementId))[0].click();\n                })\n            };\n\n            const setFreshForm = () => {\n                // remove selected images\n                $scope.uploadData[enums.idVerificationMethod.passport] = angular.copy(idVerificationMethodPassportTmpl);\n                $scope.uploadData[enums.idVerificationMethod.driverLicense] = angular.copy(idVerificationMethodDriverLicenceTmpl);\n                $scope.uploadData[enums.idVerificationMethod.id] = angular.copy(idVerificationMethodIdTmpl);\n            };\n            setFreshForm();\n\n            $scope.verifyId = async () => {\n                const {\n                    uploadData,\n                    selectedUploadMethod,\n                } = $scope;\n\n                let isValid = true;\n                uploadData[selectedUploadMethod].forEach((item) => {\n                    isValid = isValid && (item.imgData != undefined && item.imgBlob != undefined)\n                });\n\n                if (!isValid) {\n                    toastService.simpleToast($translate.instant('UPLOAD_MISSING_DOCS'));\n                    return\n                }\n                $scope.isLoading = true;\n                $scope.statusError = null;\n                try {\n                    if (selectedUploadMethod === enums.idVerificationMethod.passport) {\n                        const selfie = uploadData[selectedUploadMethod][1].imgBlob;\n                        const acuantPassUploadRes = await acuantService.processPassportImage({\n                            imageToProcess: uploadData[selectedUploadMethod][0].imgBlob,\n                            imageSource: enums.acuantImageSource.Other,\n                            usePreprocessing: true\n                        });\n\n                        if (acuantPassUploadRes && acuantPassUploadRes.data) {\n                            const { WebResponseCode , WebResponseDescription,FaceImage} = acuantPassUploadRes.data;\n                            if (WebResponseCode == 1) {\n                                if (FaceImage == null || FaceImage == '') {\n                                    throw new Error('COULD_NOT_EXTRACT_IMAGE_FROM_DATA');\n                                } else {\n                                    const base64FaceImage = goog.crypt.base64.encodeByteArray(FaceImage);\n                                    const faceImgBlob = ptUtils.dataUrlToBlob(`data:image/jpg;base64,${base64FaceImage}`);\n                                    const facialMatchRes = await acuantService.processFacialMatch({\n                                        idFaceImage: faceImgBlob,\n                                        selfie,\n                                    });\n\n                                    const {\n                                        ResponseCodeAuthorization,\n                                        ResponseMessageAuthorization,\n                                        WebResponseCode,\n                                        WebResponseDescription\n                                    } = facialMatchRes.data;\n\n                                    if (ResponseCodeAuthorization < 0)\n                                        throw new Error(ResponseMessageAuthorization);\n                                    else if (WebResponseCode < 0)\n                                        throw new Error(WebResponseDescription);\n                                    else {\n                                        $scope.uploadVerifiedImageToPaladinServers();\n                                    }\n                                }\n                            } else {\n                                throw new Error(WebResponseDescription);\n                            }\n                        } else {\n                            throw new Error('DEFAULT_ERROR')\n                        }\n\n                    } else if (selectedUploadMethod === enums.idVerificationMethod.driverLicense ||\n                        selectedUploadMethod === enums.idVerificationMethod.id) {\n\n                        const frontImage = uploadData[selectedUploadMethod][0].imgBlob;\n                        const backImage = uploadData[selectedUploadMethod][1].imgBlob;\n                        const selfie = uploadData[selectedUploadMethod][2].imgBlob;\n\n                        const acuantDuplexUpload = await acuantService.processNICDLDuplexImage({\n                            frontImage,\n                            backImage,\n                            selectedRegion: enums.acuantRegions.Europe,\n                            imageSource: enums.acuantImageSource.Other,\n                            usePreprocessing: true,\n                        });\n\n                        // const acuantDuplexUpload = await acuantService.processDriversLicense({\n                        //     imageToProcess: frontImage,\n                        //     selectedRegion: enums.acuantRegions.Europe,\n                        //     imageSource: enums.acuantImageSource.Other,\n                        //     usePreprocessing: true,\n                        // });\n\n                        const {\n                            ResponseCodeAuthorization,\n                            ResponseMessageAuthorization,\n                            ResponseCodeAutoDetectState,\n                            ResponseCodeAutoDetectStateDesc,\n                            ResponseCodeProcState,\n                            ResponseCodeProcessStateDesc,\n                            WebResponseCode,\n                            WebResponseDescription,\n                            FaceImage\n                        } = acuantDuplexUpload.data;\n\n                        if (ResponseCodeAuthorization < 0)\n                            throw new Error(ResponseMessageAuthorization);\n                        else if (ResponseCodeAutoDetectState < 0)\n                            throw new Error(ResponseCodeAutoDetectStateDesc);\n                        else if (ResponseCodeProcState < 0)\n                            throw new Error(ResponseCodeProcessStateDesc);\n                        else if (WebResponseCode < 0)\n                            throw new Error(WebResponseDescription);\n                        else if (FaceImage == null || FaceImage == '') {\n                            throw new Error('COULD_NOT_EXTRACT_IMAGE_FROM_DATA');\n                        } else {\n                            const base64FaceImage = goog.crypt.base64.encodeByteArray(FaceImage);\n                            const faceImgBlob = ptUtils.dataUrlToBlob(`data:image/jpg;base64,${base64FaceImage}`);\n                            const facialMatchRes = await acuantService.processFacialMatch({\n                                idFaceImage: faceImgBlob,\n                                selfie,\n                            });\n\n                            const {\n                                ResponseCodeAuthorization,\n                                ResponseMessageAuthorization,\n                                WebResponseCode,\n                                WebResponseDescription\n                            } = facialMatchRes.data;\n\n                            if (ResponseCodeAuthorization < 0)\n                                throw new Error(ResponseMessageAuthorization);\n                            else if (WebResponseCode < 0)\n                                throw new Error(WebResponseDescription);\n                            else {\n                                $scope.uploadVerifiedImageToPaladinServers();\n                                gtmService.trackEvent('id-verification', 'id-verification-successful');\n                            }\n                        }\n\n                    } else {\n                        // toastService.simpleToast('upload shit');\n                        new Error('Operation not supported') // will never happen\n                    }\n                } catch (err) {\n                    $scope.isLoading = false;\n                    gtmService.trackEvent('id-verification', 'id-verification-failed');\n\n                    // let requestManualVerification = () => {\n                        // make api call with same documents\n                        console.log('requestManualVerification ', $scope)\n                        if (selectedUploadMethod === enums.idVerificationMethod.passport) {\n                            apiService.verification.sendToManualVerification({\n                                passportImage: uploadData[selectedUploadMethod][0].imgData.split(',')[1],\n                                selfie: uploadData[selectedUploadMethod][1].imgData.split(',')[1],\n                                userId: appStateManager.getUserId(),\n                                bookingId: $scope.bookingId\n                            }).then((result)=>{\n                                    // redirect to rental status page\n                                    $scope.finishVerificationManual();\n                                    toastService.simpleToast($translate.instant('ID_VERIFY_FAIL_POPUP_ON_SUCCESS'))\n                                },\n                                (err)=>{\n                                    console.log('sendToManualVerification error', err)\n                                    setFreshForm();\n                                    toastService.simpleToast($translate.instant('ID_VERIFY_FAIL_POPUP_ON_FAIL'))\n                                });\n                        } else if (selectedUploadMethod === enums.idVerificationMethod.driverLicense ||\n                            selectedUploadMethod === enums.idVerificationMethod.id){\n\n                            apiService.verification.sendToManualVerification({\n                                NICDLFront: uploadData[selectedUploadMethod][0].imgData.split(',')[1],\n                                NICDLBack: uploadData[selectedUploadMethod][1].imgData.split(',')[1],\n                                selfie: uploadData[selectedUploadMethod][2].imgData.split(',')[1],\n                                userId: appStateManager.getUserId(),\n                                bookingId: $scope.bookingId\n                            }).then((result)=>{\n                                    // redirect to rental status page\n                                    $scope.finishVerificationManual();\n                                    toastService.simpleToast($translate.instant('ID_VERIFY_FAIL_POPUP_ON_SUCCESS'))\n                                },\n                                (err)=>{\n                                    console.log('sendToManualVerification err', err)\n                                    setFreshForm();\n                                    toastService.simpleToast($translate.instant('ID_VERIFY_FAIL_POPUP_ON_FAIL'))\n                                });\n                        }\n                    // };\n\n                    // console.log('??????????? ', err.data, ' ... ', err.message, ' ... ', 'DEFAULT_ERROR')\n                    // $scope.statusError = (err.data || {}).Message || err.message || $translate.instant('DEFAULT_ERROR');\n                    // popupService.showIdVerificationFailureHandler({\n                    //     message: $scope.statusError,\n                    //     retryClb: () => {\n                    //         setFreshForm();\n                    //     },\n                    //     sendToManualClb: requestManualVerification\n                    // });\n                    // $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true  });\n                    $scope.$apply();\n                }\n            };\n\n            $scope.uploadVerifiedImageToPaladinServers = async () => {\n                const {\n                    uploadData,\n                    selectedUploadMethod\n                } = $scope;\n\n                if (selectedUploadMethod === enums.idVerificationMethod.passport) {\n\n                    const passportImage = uploadData[selectedUploadMethod][0].imgData.split(',')[1];\n                    const selfie = uploadData[selectedUploadMethod][1].imgData.split(',')[1];\n                    const passUploadRes = await apiService.verification.uploadPassport({\n                        passportImage,\n                        selfie,\n                        userId: appStateManager.getUserId()\n                    });\n\n                    if (passUploadRes && passUploadRes.Status === 'success') {\n                        $scope.finishVerification()\n                    } else {\n                        throw new Error(passUploadRes.Message || 'DEFAULT_ERROR');\n                    }\n                } else if (selectedUploadMethod === enums.idVerificationMethod.driverLicense ||\n                    selectedUploadMethod === enums.idVerificationMethod.id) {\n\n                    const NICDLFront = uploadData[selectedUploadMethod][0].imgData.split(',')[1];\n                    const NICDLBack = uploadData[selectedUploadMethod][1].imgData.split(',')[1];\n                    const selfie = uploadData[selectedUploadMethod][2].imgData.split(',')[1];\n\n                    const NICDLUploadRes = await  apiService.verification.uploadNICDL({\n                        NICDLFront,\n                        NICDLBack,\n                        selfie,\n                        userId: appStateManager.getUserId()\n                    });\n\n                    if (NICDLUploadRes && NICDLUploadRes.Status === 'success') {\n                        $scope.finishVerification()\n                    } else {\n                        throw new Error(NICDLUploadRes.Message || 'DEFAULT_ERROR');\n                    }\n                }\n            };\n\n            $scope.finishVerification = () => {\n                $scope.isLoading = false;\n                $scope.statusError = null;\n\n                popupService.showAlert('SUCCESS','ID_SUCCESSFULLY_VERIFIED')\n                    .finally(() => {\n                        if ($scope.bookingId)\n                            $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true  });\n                        else\n                            $rootScope.$emit(enums.busNavigation.userProfile,{ userId: appStateManager.getUserId() });\n                    })\n            };\n\n            $scope.finishVerificationManual = () => {\n                $scope.isLoading = false;\n                $scope.statusError = null;\n                //show popup only for Desktop\n                if (ptUtils.isMobile.any()) {\n                    if ($scope.bookingId)\n                        $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true  });\n                    else\n                        $rootScope.$emit(enums.busNavigation.userProfile,{ userId: appStateManager.getUserId() });\n                } else {\n                popupService.showAlert('ID_VER_MANUAL_POPUP','ID_VER_MANUAL_POPUP_TEXT')\n                    .finally(() => {\n                        if ($scope.bookingId)\n                            $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true  });\n                        else\n                            $rootScope.$emit(enums.busNavigation.userProfile,{ userId: appStateManager.getUserId() });\n                    })\n                }\n                \n            };\n\n            $scope.skipVerification = () => {\n                $rootScope.$emit(enums.busNavigation.transactionDetailed,{ bookingId: $scope.bookingId, replace: true });\n            };\n\n            $scope.onUploaded = (inputElement) => {\n                if (inputElement.files && inputElement.files.length > 0) {\n                    const {\n                        uploadData,\n                        selectedUploadMethod\n                    } = $scope;\n                    const photoIndex = uploadData[selectedUploadMethod].findIndex((item) => item.elementId === inputElement.id);\n                    if (photoIndex != undefined) {\n                        $scope.$evalAsync(() => {\n                            uploadData[selectedUploadMethod][photoIndex].isProcessingImg = true;\n                            // Resize\n                            canvasResize(inputElement.files[0], {\n                                quality: 75,\n                                isPreprocessing: true,\n                                cardType: uploadData[selectedUploadMethod][photoIndex].cardType,\n                                maxW: 2048,\n                                maxH: 2008,\n                                isiOS: ptUtils.isMobile.iOS(),\n                                callback: function (data, width, height) {\n                                    $scope.$evalAsync(() => {\n                                        uploadData[selectedUploadMethod][photoIndex].imgData = data;\n                                        uploadData[selectedUploadMethod][photoIndex].imgBlob = ptUtils.dataUrlToBlob(data);\n                                        uploadData[selectedUploadMethod][photoIndex].isProcessingImg = false;\n                                    })\n                                }\n                            });\n                            // uploadHandler.convertInputElementToBas64(inputElement)\n                            //     .then((data) => {\n                            //         $scope.$evalAsync(() => {\n                            //             uploadData[selectedUploadMethod][photoIndex].imgData = data.original64;\n                            //             uploadData[selectedUploadMethod][photoIndex].imgBlob = ptUtils.dataUrlToBlob(data.original64);\n                            //             uploadData[selectedUploadMethod][photoIndex].isProcessingImg = false;\n                            //         })\n                            //     })\n                            //     .catch((err) => {\n                            //         toastService.simpleToast(JSON.stringify(err));\n                            //         console.error(err);\n                            //     })\n                        })\n                    }\n                }\n            }\n\n            $scope.showToast = (message, delay = 3000) => {\n                $mdToast.show(\n                    $mdToast.simple()\n                        .textContent(message)\n                        .hideDelay(delay)\n                );\n            };\n\n\n        }\n    ]);\n'use strict';\nangular.module('paladinApp')\n    .controller('chatController',[\n        '$rootScope',\n        '$scope',\n        '$mdMedia',\n        '$mdSidenav',\n        'appStateManager',\n        'enums',\n        '$stateParams',\n        'chatService',\n        '$mdMedia',\n        function (\n            $rootScope,\n            $scope,\n            $mdMedia,\n            $mdSidenav,\n            appStateManager,\n            enums,\n            $stateParams,\n            chatService) {\n\n            $scope.isLoading = false;\n            $scope.isChatCollapsed = false;\n            $scope.preSelectedchat = { value: undefined };\n            $scope.isGtMd = $mdMedia('gt-md');\n            $scope.isGtSM = $mdMedia('gt-sm');\n            if ($stateParams.chatId)\n                chatService.activateChatWhenReady($stateParams.chatId);\n\n\n            $scope.toggleNav = () => {\n                $mdSidenav('chat-list-side-nav').toggle();\n            };\n\n\n            let deregs = [];\n\n            deregs.push(\n                $scope.$watch(function () {return $mdMedia('gt-md') },function (mgMd) {\n                    $scope.isGtMd = mgMd;\n                    $scope.isChatCollapsed = mgMd;\n                })\n            );\n            deregs.push(\n                $scope.$watch(function () {return $mdMedia('gt-sm') },function (mgSm) {\n                    $scope.isGtSM = mgSm;\n                })\n            );\n\n            $scope.$on('$destroy',() => {\n                while (deregs.length)\n                    deregs.pop()();\n            })\n\n    }]);"]}